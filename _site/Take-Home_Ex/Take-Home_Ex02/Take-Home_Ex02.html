<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dabbie Neo">
<meta name="dcterms.date" content="2023-06-04">

<title>ISSS608-VAA - Take Home_Ex02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html" rel="next">
<link href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Take Home_Ex02</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/icon VA.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/dneoo/ISSS608-VAA" title="Github" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://public.tableau.com/app/profile/dabbie.neo" title="Tableau" class="sidebar-tool px-1"><i class="bi bi-bar-chart-fill"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">About this website</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Hands-on Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 6</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 7</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">In-Class Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" class="sidebar-item-text sidebar-link">In-class Ex 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" class="sidebar-item-text sidebar-link">In-class Ex 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex05/In_class_Ex05_MC1.html" class="sidebar-item-text sidebar-link">In-class Ex 5</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Take-home Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html" class="sidebar-item-text sidebar-link">Take-Home Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html" class="sidebar-item-text sidebar-link active">Take-Home Exercise 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html" class="sidebar-item-text sidebar-link">Take-Home Exercise 3</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">1. Background</a></li>
  <li><a href="#data-source" id="toc-data-source" class="nav-link" data-scroll-target="#data-source">2. Data Source</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#install-and-launching-r-packages" id="toc-install-and-launching-r-packages" class="nav-link" data-scroll-target="#install-and-launching-r-packages">3.1 Install and launching R packages</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data">3.2 Loading the Data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.3 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#extracting-the-nodes" id="toc-extracting-the-nodes" class="nav-link" data-scroll-target="#extracting-the-nodes">3.3.1 Extracting the nodes</a></li>
  <li><a href="#extracting-the-edges" id="toc-extracting-the-edges" class="nav-link" data-scroll-target="#extracting-the-edges">3.3.2 Extracting the edges</a></li>
  <li><a href="#reviewing-the-imported-data" id="toc-reviewing-the-imported-data" class="nav-link" data-scroll-target="#reviewing-the-imported-data">3.3.3 Reviewing the imported data</a></li>
  <li><a href="#wrangling-time" id="toc-wrangling-time" class="nav-link" data-scroll-target="#wrangling-time">3.3.4 Wrangling Time</a></li>
  <li><a href="#checking-if-there-is-any-missing-values-in-the-edge-data-table" id="toc-checking-if-there-is-any-missing-values-in-the-edge-data-table" class="nav-link" data-scroll-target="#checking-if-there-is-any-missing-values-in-the-edge-data-table">3.3.5 Checking if there is any missing values in the edge data table</a></li>
  <li><a href="#preparing-the-edges-data-table" id="toc-preparing-the-edges-data-table" class="nav-link" data-scroll-target="#preparing-the-edges-data-table">3.3.6 Preparing the edges data table</a></li>
  <li><a href="#preparing-the-nodes-data-table" id="toc-preparing-the-nodes-data-table" class="nav-link" data-scroll-target="#preparing-the-nodes-data-table">3.3.7 Preparing the nodes data table</a></li>
  <li><a href="#building-the-tidygraph-model" id="toc-building-the-tidygraph-model" class="nav-link" data-scroll-target="#building-the-tidygraph-model">3.3.8 Building the tidygraph model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#network-metrics-analysis" id="toc-network-metrics-analysis" class="nav-link" data-scroll-target="#network-metrics-analysis">4. Network Metrics Analysis</a>
  <ul class="collapse">
  <li><a href="#calculating-the-in-out-and-total-degree-centrality-of-the-nodes" id="toc-calculating-the-in-out-and-total-degree-centrality-of-the-nodes" class="nav-link" data-scroll-target="#calculating-the-in-out-and-total-degree-centrality-of-the-nodes">4.1 Calculating the in, out and total degree centrality of the nodes</a></li>
  <li><a href="#determining-the-type-of-entity-the-id-belongs-to" id="toc-determining-the-type-of-entity-the-id-belongs-to" class="nav-link" data-scroll-target="#determining-the-type-of-entity-the-id-belongs-to">4.2 Determining the type of entity the id belongs to</a>
  <ul class="collapse">
  <li><a href="#counting-number-of-entities-for-each-business-type" id="toc-counting-number-of-entities-for-each-business-type" class="nav-link" data-scroll-target="#counting-number-of-entities-for-each-business-type">4.2.1 Counting number of entities for each business type</a></li>
  </ul></li>
  <li><a href="#visualising-the-network-graph-with-ggraph" id="toc-visualising-the-network-graph-with-ggraph" class="nav-link" data-scroll-target="#visualising-the-network-graph-with-ggraph">4.3 Visualising the network graph with ggraph</a></li>
  <li><a href="#flag-based-network" id="toc-flag-based-network" class="nav-link" data-scroll-target="#flag-based-network">4.4 Flag Based Network</a></li>
  <li><a href="#top-20-transshipment-companies-trading-frequencies" id="toc-top-20-transshipment-companies-trading-frequencies" class="nav-link" data-scroll-target="#top-20-transshipment-companies-trading-frequencies">4.5 Top 20 transshipment companies trading frequencies</a></li>
  <li><a href="#community-detection-analysis" id="toc-community-detection-analysis" class="nav-link" data-scroll-target="#community-detection-analysis">4.6 Community Detection Analysis</a></li>
  <li><a href="#plotting-the-visnetwork-graph-of-transshipment-leader" id="toc-plotting-the-visnetwork-graph-of-transshipment-leader" class="nav-link" data-scroll-target="#plotting-the-visnetwork-graph-of-transshipment-leader">4.7 Plotting the visNetwork graph of transshipment leader</a>
  <ul class="collapse">
  <li><a href="#summary-of-the-changes-of-transshipment-leader-over-the-years" id="toc-summary-of-the-changes-of-transshipment-leader-over-the-years" class="nav-link" data-scroll-target="#summary-of-the-changes-of-transshipment-leader-over-the-years">4.7.1 Summary of the changes of transshipment leader over the years</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">5. References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Take Home_Ex02</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dabbie Neo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 4, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 4, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="background" class="level1">
<h1>1. Background</h1>
<p>The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. As part of the collaboration, FishEye’s analysts received import/export data for Oceanus’ marine and fishing industries.</p>
<p>With reference to <a href="https://vast-challenge.github.io/2023/MC2.html">Mini-Challenge 2</a> of <a href="https://vast-challenge.github.io/2023/">VAST Challenge 2023</a> and by using appropriate static and interactive statistical graphics methods, we will be helping FishEye to identify companies that may be engaged in illegal fishing.</p>
</section>
<section id="data-source" class="level1">
<h1>2. Data Source</h1>
<p>The data is taken from the <a href="https://vast-challenge.github.io/2023/MC2.html">Mini-Challenge 2</a> of <a href="https://vast-challenge.github.io/2023/">VAST Challenge 2023</a>. mc2_challenge_graph.json file will be used for the purpose of this exercise.</p>
</section>
<section id="data-preparation" class="level1">
<h1>3. Data Preparation</h1>
<section id="install-and-launching-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-and-launching-r-packages">3.1 Install and launching R packages</h2>
<p>The code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite,tidygraph,ggraph,visNetwork,tidyverse,lubridate,igraph,plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-data">3.2 Loading the Data</h2>
<p><code>fromJSON()</code> of jsonlite package is used to import mc2_challenge_graph.json into R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">3.3 Data Wrangling</h2>
<section id="extracting-the-nodes" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-nodes">3.3.1 Extracting the nodes</h3>
<p>The code chunk is used to extract nodes data table from mc2_data list object and save the output in a tibble data frame object called mc2_nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract id, shpcountry and rcvcountry and make it as a tibble database. use select to choose the fields you want and reorganise the fields as you want</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>MC2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, shpcountry, rcvcountry)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  id                                shpcountry rcvcountry
  &lt;chr&gt;                             &lt;chr&gt;      &lt;chr&gt;     
1 AquaDelight Inc and Son's         Polarinda  Oceanus   
2 BaringoAmerica Marine Ges.m.b.H.  &lt;NA&gt;       &lt;NA&gt;      
3 Yu gan  Sea spray GmbH Industrial Oceanus    Oceanus   
4 FlounderLeska Marine BV           &lt;NA&gt;       &lt;NA&gt;      
5 Olas del Mar Worldwide            Oceanus    Oceanus   
6 French Crab S.p.A. Worldwide      Kondanovia Utoporiana</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>select()</code> is used not only to select the field needed but also to re-organise the sequence of the fields.</p>
</div>
</div>
</section>
<section id="extracting-the-edges" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-edges">3.3.2 Extracting the edges</h3>
<p>The code chunk is used to extract edges data table from mc2_data list object and save the output in a tibble data frame object called mc2_edges.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MC2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, arrivaldate, hscode, valueofgoods_omu, valueofgoodsusd, volumeteu, weightkg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reviewing-the-imported-data" class="level3">
<h3 class="anchored" data-anchor-id="reviewing-the-imported-data">3.3.3 Reviewing the imported data</h3>
<p>Next, we will examine the structure of the data frame using <code>glimpse()</code> of dplyr.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 34,576
Columns: 3
$ id         &lt;chr&gt; "AquaDelight Inc and Son's", "BaringoAmerica Marine Ges.m.b…
$ shpcountry &lt;chr&gt; "Polarinda", NA, "Oceanus", NA, "Oceanus", "Kondanovia", NA…
$ rcvcountry &lt;chr&gt; "Oceanus", NA, "Oceanus", NA, "Oceanus", "Utoporiana", NA, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,464,378
Columns: 8
$ source           &lt;chr&gt; "AquaDelight Inc and Son's", "AquaDelight Inc and Son…
$ target           &lt;chr&gt; "BaringoAmerica Marine Ges.m.b.H.", "BaringoAmerica M…
$ arrivaldate      &lt;chr&gt; "2034-02-12", "2034-03-13", "2028-02-07", "2028-02-23…
$ hscode           &lt;chr&gt; "630630", "630630", "470710", "470710", "470710", "47…
$ valueofgoods_omu &lt;dbl&gt; 141015, 141015, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ valueofgoodsusd  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 87110, 188140, NA, 221110, 58…
$ volumeteu        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ weightkg         &lt;int&gt; 4780, 6125, 10855, 11250, 11165, 11290, 9000, 19490, …</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The output report of MC2_edges above reveals that the arrivaldate is treated as <chr> data type instead of date data type. This is an error! Before we continue, it is important for us to change the data type of arrivaldate field to “Date”” data type.</chr></p>
</div>
</div>
</section>
<section id="wrangling-time" class="level3">
<h3 class="anchored" data-anchor-id="wrangling-time">3.3.4 Wrangling Time</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MC2_edges <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ArrivalDate =</span> <span class="fu">ymd</span>(arrivaldate)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(ArrivalDate)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(ArrivalDate)) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Monthyear =</span> <span class="fu">paste</span>(Year, Month, <span class="at">sep =</span> <span class="st">"-"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, ArrivalDate, Month, Year, hscode, valueofgoods_omu, volumeteu, weightkg, valueofgoodsusd) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  source        target ArrivalDate Month  Year hscode valueofgoods_omu volumeteu
  &lt;chr&gt;         &lt;chr&gt;  &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;
1 AquaDelight … Barin… 2034-02-12      2  2034 630630           141015         0
2 AquaDelight … Barin… 2034-03-13      3  2034 630630           141015         0
3 AquaDelight … -15045 2028-02-07      2  2028 470710               NA         0
4 AquaDelight … -15045 2028-02-23      2  2028 470710               NA         0
5 AquaDelight … -15045 2028-09-11      9  2028 470710               NA         0
6 AquaDelight … -15045 2028-10-09     10  2028 470710               NA         0
# ℹ 2 more variables: weightkg &lt;int&gt;, valueofgoodsusd &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><code>mutate()</code> is used 4 times to create 4 derive fields.</p>
<ul>
<li><p><code>ymd()</code> of <strong>lubridate</strong> package is used to covert <em>arrivaldate</em> field from character data type into date data type.</p></li>
<li><p><code>year()</code> of <strong>lubridate</strong> package is used to convert the values in ArrivalDate field into year values.</p></li>
<li><p>month() of l<strong>ubridate</strong> package is used to convert the values in ArrivalDate field into month values.</p></li>
</ul></li>
<li><p><code>select()</code> is used not only to select the field needed but also to re-organise the sequent of the fields.</p></li>
</ul>
</div>
</div>
</section>
<section id="checking-if-there-is-any-missing-values-in-the-edge-data-table" class="level3">
<h3 class="anchored" data-anchor-id="checking-if-there-is-any-missing-values-in-the-edge-data-table">3.3.5 Checking if there is any missing values in the edge data table</h3>
<p>The below chunck is used to calculate the percentage of NAs and 0s in the each column in the edge data table to see if we should use it for our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns in your dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"valueofgoods_omu"</span>, <span class="st">"volumeteu"</span>, <span class="st">"weightkg"</span>, <span class="st">"valueofgoodsusd"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the percentage of NA values and zeros for the selected columns</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MC2_edges)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>na_percentage <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(MC2_edges[, selected_columns])) <span class="sc">/</span> total_rows <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>zero_percentage <span class="ot">&lt;-</span> <span class="fu">colSums</span>(MC2_edges[, selected_columns] <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_rows <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the results into a data frame</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NA_Percentage =</span> na_percentage, <span class="at">Zero_Percentage =</span> zero_percentage)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 NA_Percentage Zero_Percentage
valueofgoods_omu      99.99471      0.00000000
volumeteu              9.38167     75.91084870
weightkg               0.00000      0.90128491
valueofgoodsusd       54.36443      0.08169013</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is a high percentage of NA value in valueofgoods_omu and valueofgoodusd and a high percentage of zero in volumeteu, thus we will leave them out in our analysis, since we are unable to derive any useful insights.</p>
</div>
</div>
</section>
<section id="preparing-the-edges-data-table" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-edges-data-table">3.3.6 Preparing the edges data table</h3>
<p>Harmonized System (HS) codes are the identification codes given to goods for use in international trade. The HS codes are administered by the World Customs Organization (WCO) and are internationally accepted for use by customs authorities and companies to identify goods.</p>
<p>Since we are doing an analysis on the fishing industry, we have to first filter those hscodes that are fishing industry related products.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^30[1-8]|^2301|^160[4-5]|^1212|^1302|^1504|^151610|^151790"</span>, hscode)) <span class="sc">%&gt;%</span> <span class="co"># filter out only those hscode that are fishing industry related products </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">median_weight =</span> <span class="fu">median</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weights<span class="sc">&gt;</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,408 × 6
   source                              target hscode  Year weights median_weight
   &lt;chr&gt;                               &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;         &lt;dbl&gt;
 1 " Direct Herring Company Transit"   Estre… 306170  2031      12        21078.
 2 "1 Limited Liability Company"       Olas … 303630  2034      28        19830 
 3 "1 Limited Liability Company Trans… Selou… 160414  2030      12         9985 
 4 "1 Limited Liability Company Trans… Selou… 160414  2031      21         8815 
 5 "1 Limited Liability Company Trans… Selou… 160414  2032      16         6908.
 6 "1 Limited Liability Company Trans… Selou… 160414  2033      54         6922.
 7 "1 Limited Liability Company Trans… Selou… 160414  2034      28         6545 
 8 "1 Ltd. Liability Co Cargo"         Himac… 306170  2028      68        10095 
 9 "1 Ltd. Liability Co Cargo"         Himac… 306170  2029      59        19205 
10 "1 Ltd. Liability Co Cargo"         Himac… 306170  2030      26        17708.
# ℹ 12,398 more rows</code></pre>
</div>
</div>
<p>Next, we take a look at what are the top fishing related products that has most transactions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>top_3_hscode <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hscode) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_weights =</span> <span class="fu">sum</span>(weights)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_weights)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>top_3_hscode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  hscode total_weights
  &lt;chr&gt;          &lt;int&gt;
1 306170        122910
2 304620         81075
3 160414         63745</code></pre>
</div>
</div>
<p>The top 3 hscodes that has most number of transactions are ‘306170’,‘304620’ and ‘160414’. Thus, we will focus our analysis based on these 3 hscodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter the mc2_edges_aggregated based on the top 3 hscode</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated_top <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"306170"</span><span class="sc">|</span> hscode <span class="sc">==</span> <span class="st">"304620"</span><span class="sc">|</span> hscode <span class="sc">==</span> <span class="st">"160414"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mc2_edges_aggregated_top</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><code>filter()</code> is used to select records whereby hscode that fishing industry related products. The selection of hscode is referenced from the link <a href="https://www.cybex.in/hs-codes/fish-crustaceans-molluscs-aquatic-invertebrates-chapter-03.aspx">here</a></p></li>
<li><p><code>group_by()</code> is used to aggregate values by source, target, hscode, Year.</p></li>
<li><p><code>summarise()</code> and <code>n()</code> are used to count the aggregated records.</p></li>
<li><p>filter() is then used to perform the below selection,</p>
<ul>
<li>to select all records whereby source are not equal to target</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="preparing-the-nodes-data-table" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-nodes-data-table">3.3.7 Preparing the nodes data table</h3>
<p>Instead of using the nodes data table extracted from mc2_data, we will prepare a new nodes data table by using the source and target fields of mc2_edges_aggregated data table. This is necessary to ensure that the nodes in nodes data tables include all the source and target values. Then we will reference to the MC2_nodes table to get the corresponding shpcountry and rcvcountry values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>id1_aggregated <span class="ot">&lt;-</span> mc2_edges_aggregated_top <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>id2_aggregated <span class="ot">&lt;-</span> mc2_edges_aggregated_top <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>mc2_nodes_extracted_aggregated <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_aggregated, id2_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with MC2_nodes by 'id to get the 'shpcountry', and 'rcvcountry'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>mc2_nodes_extracted_aggregated <span class="ot">&lt;-</span> mc2_nodes_extracted_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_nodes, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mc2_nodes_extracted_aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  id                                                shpcountry rcvcountry 
  &lt;chr&gt;                                             &lt;chr&gt;      &lt;chr&gt;      
1 " Direct Herring Company Transit"                 Mawazam    Coralmarica
2 "1 Limited Liability Company Transport"           Kondanovia Oceanus    
3 "1 Ltd. Liability Co Cargo"                       Mawandia   &lt;NA&gt;       
4 "6 Ltd. Liability Co Transportation"              Marebak    Oceanus    
5 "8 Aquamarine Limited Liability Company Holdings" Marebak    Oceanus    
6 "9 Marine biology Ltd Family"                     Mawazam    &lt;NA&gt;       </code></pre>
</div>
</div>
</section>
<section id="building-the-tidygraph-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-tidygraph-model">3.3.8 Building the tidygraph model</h3>
<p>The code chunk below is then used to build the tidy graph data model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_extracted_aggregated,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc2_edges_aggregated_top,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>mc2_graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 930 nodes and 4670 edges
#
# A directed acyclic multigraph with 27 components
#
# A tibble: 930 × 3
  id                                                shpcountry rcvcountry 
  &lt;chr&gt;                                             &lt;chr&gt;      &lt;chr&gt;      
1 " Direct Herring Company Transit"                 Mawazam    Coralmarica
2 "1 Limited Liability Company Transport"           Kondanovia Oceanus    
3 "1 Ltd. Liability Co Cargo"                       Mawandia   &lt;NA&gt;       
4 "6 Ltd. Liability Co Transportation"              Marebak    Oceanus    
5 "8 Aquamarine Limited Liability Company Holdings" Marebak    Oceanus    
6 "9 Marine biology Ltd Family"                     Mawazam    &lt;NA&gt;       
# ℹ 924 more rows
#
# A tibble: 4,670 × 6
   from    to hscode  Year weights median_weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;         &lt;dbl&gt;
1     1   543 306170  2031      12        21078.
2     2   544 160414  2030      12         9985 
3     2   544 160414  2031      21         8815 
# ℹ 4,667 more rows</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="network-metrics-analysis" class="level1">
<h1>4. Network Metrics Analysis</h1>
<section id="calculating-the-in-out-and-total-degree-centrality-of-the-nodes" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-in-out-and-total-degree-centrality-of-the-nodes">4.1 Calculating the in, out and total degree centrality of the nodes</h2>
<p><code>Degree centrality</code> is a measure of immediate connection in a network. It could be interpreted as immediate reach in a social network.<code>Eigenvector centrality</code> is a measure that takes into account both the number of connections that a node or an actor has, and the degree of influence that the node’s immediate connections have in the entire network.</p>
<p>We will calculate the in, out and total degree centrality of the nodes, and use <code>mutate()</code> to create new columns to store these values.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calulate the in, out and total degree centrality and add 3 new columns via mutate() to store the values </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_degree_centrality =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">out_degree_centrality =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">"out"</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_centrality =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">"all"</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigen_centrality =</span> <span class="fu">centrality_eigen</span>()</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_centrality =</span> degree_centrality <span class="sc">*</span> eigen_centrality) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(combined_centrality)) </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>mc2_graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 930 nodes and 4670 edges
#
# A directed acyclic multigraph with 27 components
#
# A tibble: 930 × 8
  id            shpcountry rcvcountry in_degree_centrality out_degree_centrality
  &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;                     &lt;dbl&gt;                 &lt;dbl&gt;
1 "Mar del Est… Merigrad   Oceanus                     400                     0
2 "Caracola de… Puerto Sol Oceanus                     363                     0
3 "hǎi dǎn Cor… Marebak    Oceanus                     337                     0
4 "Costa de la… Alverossia Oceanus                     181                     0
5 "Blue Horizo… Osterivar… &lt;NA&gt;                          0                   108
6 "Sea Breezes… Isliandor  Coralmari…                    0                   117
# ℹ 924 more rows
# ℹ 3 more variables: degree_centrality &lt;dbl&gt;, eigen_centrality &lt;dbl&gt;,
#   combined_centrality &lt;dbl&gt;
#
# A tibble: 4,670 × 6
   from    to hscode  Year weights median_weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;         &lt;dbl&gt;
1   788   158 306170  2031      12        21078.
2   279     7 160414  2030      12         9985 
3   279     7 160414  2031      21         8815 
# ℹ 4,667 more rows</code></pre>
</div>
</div>
<p>Below code chunk to find out the top 20 id that has a high combined degree and eigenvector centrality score.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Select the top 20 IDs based on centrality value</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>top_20_ids <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>top_20_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Mar del Este CJSC"                   "Caracola del Sol Services"          
 [3] "hǎi dǎn Corporation Wharf"           "Costa de la Felicidad Shipping"     
 [5] "Blue Horizon Family &amp;"               "Sea Breezes S.A. de C.V. Freight "  
 [7] "Selous Game Reserve  S.A. de C.V."   "Playa de Arena OJSC Express"        
 [9] "Pao gan SE Seal"                     "Pao gan LC Freight "                
[11] "AquaDelight N.V. Coral Reef"         "Balkan Cat ОАО Transport"           
[13] "Madagascar Coast  AG Freight "       "Shou gan  Oyj Overseas"             
[15] "Lake Tana  &amp; Son's"                  "Daniel Ferry N.V. Transit"          
[17] "Caracola del Este Ltd. Liability Co" "Viento Azul N.V. Distribution"      
[19] "Tripura  Market S.A. de C.V."        "The Sea Turtle GmbH &amp; Co. KG"       </code></pre>
</div>
</div>
<p>Bsed on the table above, we can see that the top 20 actors with high combined degree and eigen centrality value, include Mar del Este CJSC, Caracola del Sol Services and hǎi dǎn Corporation Wharf.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>activate()</code> is used to make the nodes of mc2_graph active to calculate the degree centrality.</p>
<p><code>mutate()</code> function from the dplyr package is used to add two new columns, in_degree_centrality and out_degree_centrality, to the nodes of the mc2_graph object</p>
</div>
</div>
</section>
<section id="determining-the-type-of-entity-the-id-belongs-to" class="level2">
<h2 class="anchored" data-anchor-id="determining-the-type-of-entity-the-id-belongs-to">4.2 Determining the type of entity the id belongs to</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify what entity the id could be </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      in_degree_centrality <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> out_degree_centrality <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"vessels"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      in_degree_centrality <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> out_degree_centrality <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"transshipment"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      in_degree_centrality <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> out_degree_centrality <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"vessels/transshipment"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="counting-number-of-entities-for-each-business-type" class="level3">
<h3 class="anchored" data-anchor-id="counting-number-of-entities-for-each-business-type">4.2.1 Counting number of entities for each business type</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Count the how many id belong to each entity</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>vessels_count <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(node_type <span class="sc">==</span> <span class="st">"vessels"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>transhipment_count <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(node_type <span class="sc">==</span> <span class="st">"transshipment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>both_count <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(node_type <span class="sc">==</span> <span class="st">"vessels/transshipment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Number of vessels:", vessels_count, "\n")</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Number of transshipment:", transhipment_count, "\n")</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Number of vessels/transshipment:", both_count, "\n")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After cleaning up the data, we have a total of 529 vessels, 388 transshipment and 13 companies that may be either a vessel or transshipment to work with for our analysis.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>If in_degree_centrality == 0, it means that the company is most likely a pure exporter and highly likely a vessel.</p></li>
<li><p>If out_degree_centrality == 0, it means that the company is most likely a pure importer and highly likely involved in transshipment.</p></li>
<li><p>If in_degree_centrality &gt; 0 &amp; out_degree_centrality &gt; 0, the company is most likely both a vessel or transshipment.</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="visualising-the-network-graph-with-ggraph" class="level2">
<h2 class="anchored" data-anchor-id="visualising-the-network-graph-with-ggraph">4.3 Visualising the network graph with ggraph</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc2_graph,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weights), </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> node_type)) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network graph of global transhipment activities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="flag-based-network" class="level2">
<h2 class="anchored" data-anchor-id="flag-based-network">4.4 Flag Based Network</h2>
<p>To gain a better understanding of the prevalence of the types of flags in the transshipment events, we can find out which country the vessels tends to be most often associated with when shipping.</p>
<p>And we can see that vessels tend to ship to Merigrad and Marebak.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>country_id_counts_shp <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(in_degree_centrality <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># filter out for the vessels </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(shpcountry) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">id_count =</span> <span class="fu">n_distinct</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(id_count))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_id_counts_shp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  shpcountry   id_count
  &lt;chr&gt;           &lt;int&gt;
1 Merigrad           97
2 Marebak            78
3 Vesperanda         54
4 Mawazam            52
5 Osterivaria        49
6 Arreciviento       31</code></pre>
</div>
</div>
<p>Also, we can see that for transshipment, companies are most often associated with Oceanus when receiving their products.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>country_id_counts_rcv <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(out_degree_centrality <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># filter out for the vessels </span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rcvcountry) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">id_count =</span> <span class="fu">n_distinct</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(id_count))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_id_counts_rcv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  rcvcountry   id_count
  &lt;chr&gt;           &lt;int&gt;
1 Oceanus           362
2 Coralmarica        13
3 Sol y Oceana        5
4 Utoporiana          2
5 Icarnia             1
6 Kethilim            1</code></pre>
</div>
</div>
</section>
<section id="top-20-transshipment-companies-trading-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="top-20-transshipment-companies-trading-frequencies">4.5 Top 20 transshipment companies trading frequencies</h2>
<p>Check out the trading frequencies of the top 20 transshipment companies trading frequencies over the years. These top 20 companies are those who has high in-degree centrality.</p>
<p>We can see that the total transactions fluctuates more for Caracola del Sol Services, Mar del Este CJSC and Pao gan SE Seal.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Select the top 20 IDs based on centrality value</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>top_20_ids <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(in_degree_centrality)) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the mc2_edges_aggregated_top dataframe</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>filtered_edges_entities <span class="ot">&lt;-</span> mc2_edges_aggregated_top <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">%in%</span> top_20_ids) <span class="sc">%&gt;%</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, target) <span class="sc">%&gt;%</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_weight =</span> <span class="fu">sum</span>(weights))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the aggregated weights</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_edges_entities, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> total_weight, <span class="at">color =</span> target)) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total transactions"</span>, <span class="at">title =</span> <span class="st">"Number of Transactions by Year"</span>) <span class="sc">+</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Target Entity"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f289bd748a85f39c5737" style="width:100%;height:406px;"></div>
<script type="application/json" data-for="htmlwidget-f289bd748a85f39c5737">{"x":{"data":[{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[1041,1022,412,108,1085,1463,1498],"text":["Year: 2028<br />total_weight: 1041<br />target: AquaDelight N.V. Coral Reef","Year: 2029<br />total_weight: 1022<br />target: AquaDelight N.V. Coral Reef","Year: 2030<br />total_weight:  412<br />target: AquaDelight N.V. Coral Reef","Year: 2031<br />total_weight:  108<br />target: AquaDelight N.V. Coral Reef","Year: 2032<br />total_weight: 1085<br />target: AquaDelight N.V. Coral Reef","Year: 2033<br />total_weight: 1463<br />target: AquaDelight N.V. Coral Reef","Year: 2034<br />total_weight: 1498<br />target: AquaDelight N.V. Coral Reef"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"AquaDelight N.V. Coral Reef","legendgroup":"AquaDelight N.V. Coral Reef","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[43,62,137,294,288,282,325],"text":["Year: 2028<br />total_weight:   43<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2029<br />total_weight:   62<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2030<br />total_weight:  137<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2031<br />total_weight:  294<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2032<br />total_weight:  288<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2033<br />total_weight:  282<br />target: Assam  Market Cargo ship Company Marine conservation","Year: 2034<br />total_weight:  325<br />target: Assam  Market Cargo ship Company Marine conservation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(234,131,49,1)","dash":"solid"},"hoveron":"points","name":"Assam  Market Cargo ship Company Marine conservation","legendgroup":"Assam  Market Cargo ship Company Marine conservation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(234,131,49,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(234,131,49,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[373,373,383,483,675,663,463],"text":["Year: 2028<br />total_weight:  373<br />target: Caracola del Este Ltd. Liability Co","Year: 2029<br />total_weight:  373<br />target: Caracola del Este Ltd. Liability Co","Year: 2030<br />total_weight:  383<br />target: Caracola del Este Ltd. Liability Co","Year: 2031<br />total_weight:  483<br />target: Caracola del Este Ltd. Liability Co","Year: 2032<br />total_weight:  675<br />target: Caracola del Este Ltd. Liability Co","Year: 2033<br />total_weight:  663<br />target: Caracola del Este Ltd. Liability Co","Year: 2034<br />total_weight:  463<br />target: Caracola del Este Ltd. Liability Co"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Caracola del Este Ltd. Liability Co","legendgroup":"Caracola del Este Ltd. Liability Co","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[2676,4261,3650,6204,4287,5137,3995],"text":["Year: 2028<br />total_weight: 2676<br />target: Caracola del Sol Services","Year: 2029<br />total_weight: 4261<br />target: Caracola del Sol Services","Year: 2030<br />total_weight: 3650<br />target: Caracola del Sol Services","Year: 2031<br />total_weight: 6204<br />target: Caracola del Sol Services","Year: 2032<br />total_weight: 4287<br />target: Caracola del Sol Services","Year: 2033<br />total_weight: 5137<br />target: Caracola del Sol Services","Year: 2034<br />total_weight: 3995<br />target: Caracola del Sol Services"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(192,155,0,1)","dash":"solid"},"hoveron":"points","name":"Caracola del Sol Services","legendgroup":"Caracola del Sol Services","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(192,155,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(192,155,0,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[2746,4020,1623,1129,1422,961,1080],"text":["Year: 2028<br />total_weight: 2746<br />target: Costa de la Felicidad Shipping","Year: 2029<br />total_weight: 4020<br />target: Costa de la Felicidad Shipping","Year: 2030<br />total_weight: 1623<br />target: Costa de la Felicidad Shipping","Year: 2031<br />total_weight: 1129<br />target: Costa de la Felicidad Shipping","Year: 2032<br />total_weight: 1422<br />target: Costa de la Felicidad Shipping","Year: 2033<br />total_weight:  961<br />target: Costa de la Felicidad Shipping","Year: 2034<br />total_weight: 1080<br />target: Costa de la Felicidad Shipping"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Costa de la Felicidad Shipping","legendgroup":"Costa de la Felicidad Shipping","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[1952,1481,2505,2056,1803,2268,1947],"text":["Year: 2028<br />total_weight: 1952<br />target: hǎi dǎn Corporation Wharf","Year: 2029<br />total_weight: 1481<br />target: hǎi dǎn Corporation Wharf","Year: 2030<br />total_weight: 2505<br />target: hǎi dǎn Corporation Wharf","Year: 2031<br />total_weight: 2056<br />target: hǎi dǎn Corporation Wharf","Year: 2032<br />total_weight: 1803<br />target: hǎi dǎn Corporation Wharf","Year: 2033<br />total_weight: 2268<br />target: hǎi dǎn Corporation Wharf","Year: 2034<br />total_weight: 1947<br />target: hǎi dǎn Corporation Wharf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"hǎi dǎn Corporation Wharf","legendgroup":"hǎi dǎn Corporation Wharf","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[200,170,1369,730,461,711,591],"text":["Year: 2028<br />total_weight:  200<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2029<br />total_weight:  170<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2030<br />total_weight: 1369<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2031<br />total_weight:  730<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2032<br />total_weight:  461<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2033<br />total_weight:  711<br />target: Kong zhong diao yu  Ges.m.b.H.","Year: 2034<br />total_weight:  591<br />target: Kong zhong diao yu  Ges.m.b.H."],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Kong zhong diao yu  Ges.m.b.H.","legendgroup":"Kong zhong diao yu  Ges.m.b.H.","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[465,308,457,834,941,1308,1346],"text":["Year: 2028<br />total_weight:  465<br />target: Madagascar Coast  AG Freight ","Year: 2029<br />total_weight:  308<br />target: Madagascar Coast  AG Freight ","Year: 2030<br />total_weight:  457<br />target: Madagascar Coast  AG Freight ","Year: 2031<br />total_weight:  834<br />target: Madagascar Coast  AG Freight ","Year: 2032<br />total_weight:  941<br />target: Madagascar Coast  AG Freight ","Year: 2033<br />total_weight: 1308<br />target: Madagascar Coast  AG Freight ","Year: 2034<br />total_weight: 1346<br />target: Madagascar Coast  AG Freight "],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,187,78,1)","dash":"solid"},"hoveron":"points","name":"Madagascar Coast  AG Freight ","legendgroup":"Madagascar Coast  AG Freight ","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,187,78,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,187,78,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[2199,2111,2500,2998,4108,4963,3252],"text":["Year: 2028<br />total_weight: 2199<br />target: Mar del Este CJSC","Year: 2029<br />total_weight: 2111<br />target: Mar del Este CJSC","Year: 2030<br />total_weight: 2500<br />target: Mar del Este CJSC","Year: 2031<br />total_weight: 2998<br />target: Mar del Este CJSC","Year: 2032<br />total_weight: 4108<br />target: Mar del Este CJSC","Year: 2033<br />total_weight: 4963<br />target: Mar del Este CJSC","Year: 2034<br />total_weight: 3252<br />target: Mar del Este CJSC"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Mar del Este CJSC","legendgroup":"Mar del Este CJSC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[167,222,270,369,298,310,483],"text":["Year: 2028<br />total_weight:  167<br />target: Mar del Paraíso Corporation Logistics","Year: 2029<br />total_weight:  222<br />target: Mar del Paraíso Corporation Logistics","Year: 2030<br />total_weight:  270<br />target: Mar del Paraíso Corporation Logistics","Year: 2031<br />total_weight:  369<br />target: Mar del Paraíso Corporation Logistics","Year: 2032<br />total_weight:  298<br />target: Mar del Paraíso Corporation Logistics","Year: 2033<br />total_weight:  310<br />target: Mar del Paraíso Corporation Logistics","Year: 2034<br />total_weight:  483<br />target: Mar del Paraíso Corporation Logistics"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,193,163,1)","dash":"solid"},"hoveron":"points","name":"Mar del Paraíso Corporation Logistics","legendgroup":"Mar del Paraíso Corporation Logistics","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,193,163,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,193,163,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[185,263,455,452,905,631,401],"text":["Year: 2028<br />total_weight:  185<br />target: Mar del Placer Manatee","Year: 2029<br />total_weight:  263<br />target: Mar del Placer Manatee","Year: 2030<br />total_weight:  455<br />target: Mar del Placer Manatee","Year: 2031<br />total_weight:  452<br />target: Mar del Placer Manatee","Year: 2032<br />total_weight:  905<br />target: Mar del Placer Manatee","Year: 2033<br />total_weight:  631<br />target: Mar del Placer Manatee","Year: 2034<br />total_weight:  401<br />target: Mar del Placer Manatee"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Mar del Placer Manatee","legendgroup":"Mar del Placer Manatee","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[315,124,67,378,416,761,340],"text":["Year: 2028<br />total_weight:  315<br />target: Orange River   Incorporated Shipping","Year: 2029<br />total_weight:  124<br />target: Orange River   Incorporated Shipping","Year: 2030<br />total_weight:   67<br />target: Orange River   Incorporated Shipping","Year: 2031<br />total_weight:  378<br />target: Orange River   Incorporated Shipping","Year: 2032<br />total_weight:  416<br />target: Orange River   Incorporated Shipping","Year: 2033<br />total_weight:  761<br />target: Orange River   Incorporated Shipping","Year: 2034<br />total_weight:  340<br />target: Orange River   Incorporated Shipping"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,186,224,1)","dash":"solid"},"hoveron":"points","name":"Orange River   Incorporated Shipping","legendgroup":"Orange River   Incorporated Shipping","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,186,224,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,224,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[304,406,528,559,932,859,534],"text":["Year: 2028<br />total_weight:  304<br />target: Pao gan LC Freight ","Year: 2029<br />total_weight:  406<br />target: Pao gan LC Freight ","Year: 2030<br />total_weight:  528<br />target: Pao gan LC Freight ","Year: 2031<br />total_weight:  559<br />target: Pao gan LC Freight ","Year: 2032<br />total_weight:  932<br />target: Pao gan LC Freight ","Year: 2033<br />total_weight:  859<br />target: Pao gan LC Freight ","Year: 2034<br />total_weight:  534<br />target: Pao gan LC Freight "],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Pao gan LC Freight ","legendgroup":"Pao gan LC Freight ","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[1302,1984,1232,2242,4245,4156,2756],"text":["Year: 2028<br />total_weight: 1302<br />target: Pao gan SE Seal","Year: 2029<br />total_weight: 1984<br />target: Pao gan SE Seal","Year: 2030<br />total_weight: 1232<br />target: Pao gan SE Seal","Year: 2031<br />total_weight: 2242<br />target: Pao gan SE Seal","Year: 2032<br />total_weight: 4245<br />target: Pao gan SE Seal","Year: 2033<br />total_weight: 4156<br />target: Pao gan SE Seal","Year: 2034<br />total_weight: 2756<br />target: Pao gan SE Seal"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(53,162,255,1)","dash":"solid"},"hoveron":"points","name":"Pao gan SE Seal","legendgroup":"Pao gan SE Seal","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(53,162,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(53,162,255,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[164,162,185,97,237,195,299],"text":["Year: 2028<br />total_weight:  164<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2029<br />total_weight:  162<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2030<br />total_weight:  185<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2031<br />total_weight:   97<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2032<br />total_weight:  237<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2033<br />total_weight:  195<br />target: Sailors and Surfers Incorporated Enterprises","Year: 2034<br />total_weight:  299<br />target: Sailors and Surfers Incorporated Enterprises"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Sailors and Surfers Incorporated Enterprises","legendgroup":"Sailors and Surfers Incorporated Enterprises","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[237,227,314,909,104,194,194],"text":["Year: 2028<br />total_weight:  237<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2029<br />total_weight:  227<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2030<br />total_weight:  314<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2031<br />total_weight:  909<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2032<br />total_weight:  104<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2033<br />total_weight:  194<br />target: Saltwater Supreme Pelican Ltd Enterprises","Year: 2034<br />total_weight:  194<br />target: Saltwater Supreme Pelican Ltd Enterprises"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"Saltwater Supreme Pelican Ltd Enterprises","legendgroup":"Saltwater Supreme Pelican Ltd Enterprises","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[335,507,753,986,1068,990,1066],"text":["Year: 2028<br />total_weight:  335<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2029<br />total_weight:  507<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2030<br />total_weight:  753<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2031<br />total_weight:  986<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2032<br />total_weight: 1068<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2033<br />total_weight:  990<br />target: Sea Breeze Corporation Marine sanctuary","Year: 2034<br />total_weight: 1066<br />target: Sea Breeze Corporation Marine sanctuary"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Sea Breeze Corporation Marine sanctuary","legendgroup":"Sea Breeze Corporation Marine sanctuary","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2034],"y":[62,506,968,709,879,69],"text":["Year: 2028<br />total_weight:   62<br />target: SeaBass &  SE Tanker","Year: 2029<br />total_weight:  506<br />target: SeaBass &  SE Tanker","Year: 2030<br />total_weight:  968<br />target: SeaBass &  SE Tanker","Year: 2031<br />total_weight:  709<br />target: SeaBass &  SE Tanker","Year: 2032<br />total_weight:  879<br />target: SeaBass &  SE Tanker","Year: 2034<br />total_weight:   69<br />target: SeaBass &  SE Tanker"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(250,98,219,1)","dash":"solid"},"hoveron":"points","name":"SeaBass &  SE Tanker","legendgroup":"SeaBass &  SE Tanker","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(250,98,219,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(250,98,219,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[778,1235,728,633,712,1020,295],"text":["Year: 2028<br />total_weight:  778<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2029<br />total_weight: 1235<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2030<br />total_weight:  728<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2031<br />total_weight:  633<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2032<br />total_weight:  712<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2033<br />total_weight: 1020<br />target: Selous Game Reserve  S.A. de C.V.","Year: 2034<br />total_weight:  295<br />target: Selous Game Reserve  S.A. de C.V."],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Selous Game Reserve  S.A. de C.V.","legendgroup":"Selous Game Reserve  S.A. de C.V.","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)"}},"frame":null},{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[340,564,582,406,204,297,1186],"text":["Year: 2028<br />total_weight:  340<br />target: The Sea Turtle GmbH & Co. KG","Year: 2029<br />total_weight:  564<br />target: The Sea Turtle GmbH & Co. KG","Year: 2030<br />total_weight:  582<br />target: The Sea Turtle GmbH & Co. KG","Year: 2031<br />total_weight:  406<br />target: The Sea Turtle GmbH & Co. KG","Year: 2032<br />total_weight:  204<br />target: The Sea Turtle GmbH & Co. KG","Year: 2033<br />total_weight:  297<br />target: The Sea Turtle GmbH & Co. KG","Year: 2034<br />total_weight: 1186<br />target: The Sea Turtle GmbH & Co. KG"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(255,106,152,1)","dash":"solid"},"hoveron":"points","name":"The Sea Turtle GmbH & Co. KG","legendgroup":"The Sea Turtle GmbH & Co. KG","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(255,106,152,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,106,152,1)"}},"frame":null}],"layout":{"margin":{"t":45.2237442922374,"r":7.30593607305936,"b":41.6438356164384,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Number of Transactions by Year","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2027.7,2034.3],"tickmode":"array","ticktext":["2028","2030","2032","2034"],"tickvals":[2028,2030,2032,2034],"categoryorder":"array","categoryarray":["2028","2030","2032","2034"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-265.05,6512.05],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,2000,4000,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Total transactions","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Target Entity","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"76fc5e684a67":{"x":{},"y":{},"colour":{},"type":"scatter"},"76fc218769a9":{"x":{},"y":{},"colour":{}}},"cur_data":"76fc5e684a67","visdat":{"76fc5e684a67":["function (y) ","x"],"76fc218769a9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="community-detection-analysis" class="level2">
<h2 class="anchored" data-anchor-id="community-detection-analysis">4.6 Community Detection Analysis</h2>
<p>Next, we will do a community detection analysis using the <code>group_edge_betweenness</code> function. It works by iteratively removing the edges with the highest betweenness centrality, which is a measure of the number of shortest paths that pass through an edge. By removing these edges, the graph is divided into clusters or communities.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(<span class="fu">group_edge_betweenness</span>(<span class="at">weights =</span> weights, <span class="at">directed =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>g_mcgraph <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>    <span class="co">#filter the community size &gt; 2</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weights), </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community)) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>g_mcgraph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As seen from the community detection graph above, after filtering for community size &gt; 2, there are 9 community shown, and looking at the connectivity and density of the graph, it seems that community 1, seems to be the most densely populated. Thus, for the following analysis, we shall focus on community 1.</p>
<p>The code chunk below can be used to find out which node has the highest in-degree centrality for in community 1. And we can see that within community 1, Mar del Este CJSC has the highest in-degree centrality score.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>indegree_community <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(community <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">in_degree_centrality_community =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">"in"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(in_degree_centrality_community)) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(indegree_community, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
  id            shpcountry rcvcountry in_degree_centrality out_degree_centrality
  &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;                     &lt;dbl&gt;                 &lt;dbl&gt;
1 Mar del Este… Merigrad   Oceanus                     400                     0
2 hǎi dǎn Corp… Marebak    Oceanus                     337                     0
3 Caracola del… Puerto Sol Oceanus                     363                     0
4 Costa de la … Alverossia Oceanus                     181                     0
5 Pao gan SE S… Alverossia Oceanus                     150                     0
# ℹ 6 more variables: degree_centrality &lt;dbl&gt;, eigen_centrality &lt;dbl&gt;,
#   combined_centrality &lt;dbl&gt;, node_type &lt;chr&gt;, community &lt;fct&gt;,
#   in_degree_centrality_community &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="plotting-the-visnetwork-graph-of-transshipment-leader" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-visnetwork-graph-of-transshipment-leader">4.7 Plotting the visNetwork graph of transshipment leader</h2>
<p>Next, we will further investigate our highest transshipment node, <code>Mar del Este CJSC</code>, by plotting its network graph over the years from 2028-2034 to see if we can find any insights.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">2034</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the year and id in edges and the corresponding id</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>filtered_graph_2028 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2028</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>unique_ids_2028 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>filtered_graph_2028 <span class="ot">&lt;-</span> filtered_graph_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2028) <span class="sc">%&gt;%</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>edges_df_2028 <span class="ot">&lt;-</span> filtered_graph_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>nodes_df_2028 <span class="ot">&lt;-</span> filtered_graph_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>nodes_df_2028<span class="ot">&lt;-</span> nodes_df_2028 <span class="sc">%&gt;%</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>vis_2028 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2028, edges_df_2028, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph of Mar del Este CJSC in 2028 "</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>vis_2028</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-20ac406376996304aa6b" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-20ac406376996304aa6b">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Tripura  Market S.A. de C.V.","Mar de la Vida S.p.A.","Estrella de la Costa SRL","French  Seabed S.p.A. Forwading","Tamil Nadu s Barge","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Wave Watchers Ltd. Liability Co","Spanish Shrimp A/S Marine","Mar del Oeste Cruise ship","Aqua Azul LC International","Danish Plaice Ltd. Liability Co Logistics","Arena del Sol Pic","Rift Valley fishery Sagl","Adriatic Tuna Seabass BV Transit","Bay of Bengal's Corp","Costa de Coral SRL United","Ocean Emporium Pic Holdings","Marine Mates NV Worldwide","Tristen Jetty Company Solutions","Nagaland Sea  OJSC United","Mar del Placer CJSC Transport","Ob River AS Consulting","shí rén yú Marine conservation","Isla del Mar Ltd. Liability Co Enterprises","Caracola del Sol Incorporated","Bahía Azul Marine sanctuary","xiǎo lóng xiā Pic","Zambezi Delta  SE Solutions","Scottish Lobster AG Transit","OceanKing s ship Pic Logistics","Yenisei  Ltd. Liability Co","Náutica del Norte Ltd. Liability Co Marine biology","Dutch Eel LLC Express","Barco de Plata SE","Marine Adventures Ltd Cod","Playa de Arena Pic","Sudd Swamp   GmbH & Co. KG & Son's","ReefRider Foods Ltd. Corporation Family","Arena Azul Sagl Family","Turkish Salmon LC Barracuda","Aqua Azul Oyster  BV Freight ","Melanippe Incorporated Marine life","Caracola Marina Lighthouse A/S Forwading","TunaTime GmbH & Co. KG Export","Zanzibar Archipelago   Incorporated International","Oceanfront Oasis AS Delivery","Playa del Sol Incorporated","Seashell Seekers Ltd Distribution","Kallianassa Fish  AG Solutions"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Vesperanda","Mawazam","Osterivaria","Vesperanda","Mawazam","Mawazam","Merigrad","Marebak","Arreciviento","Arreciviento","Arreciviento","Merigrad","Osterivaria","Mawazam","Osterivaria","Mawazam","Vesperanda","Mawazam","Merigrad","Merigrad","Osterivaria","Vesperanda","Merigrad","Merigrad","Merigrad","Coral Solis","Marebak","Coral Solis","Calabrand","Coral Solis","Marebak","Merigrad","Merigrad","Coral Solis","Marebak","Marebak","Merigrad","Oceanus","Vesperanda","Mawazam","Vesperanda","Osterivaria","Marebak","Mawazam","Marebak","Brindivaria","Sol y Oceana","Marebak","Rio Isla"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus","Luminkind",null,null,"Oceanus","Merigrad",null,null,"Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus","Rio Isla","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus","Sol y Oceana",null,"Oceanus",null,null,"Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus",null,"Oceanus",null,"Oceanus","Oceanus",null,"Oceanus"],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,50,46,58,47,37,52,43,35,41,32,34,33,34,31,37,21,22,14,11,13,17,16,12,11,17,14,17,15,12,6,5,5,5,3,3,3,4,6,1,3,2,2,3,2,1,1,1,1,1,1],"degree_centrality":[400,108,117,96,98,87,77,64,50,46,58,47,37,52,43,35,41,32,34,33,34,31,37,21,22,14,20,13,17,16,12,11,17,14,17,15,12,6,5,5,5,3,3,3,4,6,5,3,2,2,3,2,1,1,1,1,1,1],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.329351108171994,0.323914548969599,0.256338039606934,0.248576589519272,0.280390574201113,0.183226876337697,0.205676577036492,0.224524194404989,0.185332177782541,0.22113181656351,0.187167196032936,0.180013158735149,0.165573214290342,0.178753099306787,0.132087705620464,0.137683535038096,0.129642520758976,0.15022249461782,0.0997283226967316,0.146647363481023,0.104950674020175,0.107846872147427,0.132324599376451,0.124469588848618,0.0726041502895553,0.0856420440310355,0.0681760252068941,0.0707160310377389,0.0770996138198175,0.0552904969675692,0.0608475844058034,0.0318063156120698,0.0306512984055041,0.0454053274124046,0.0454053274124046,0.0421593350980041,0.030392539056462,0.0201672510693907,0.0218824733770899,0.0288898273353588,0.0302702182749364,0.0302702182749364,0.0153354347225406,0.0204548871794339,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,16.4675554085997,14.9000692526016,14.8676062972021,11.6830997074058,10.3744512454412,9.52779756956026,8.84409281256914,7.85834680417462,7.59861928908419,7.07621813003231,6.36368466511981,5.9404342382599,5.62948928587163,5.54134607851039,4.88724510795717,2.89135423580002,2.85213545669747,2.10311492464948,1.99456645393463,1.9064157252533,1.78416145834298,1.72554995435884,1.58789519251741,1.3691654773348,1.23427055492244,1.1989886164345,1.1589924285172,1.06074046556608,0.92519536583781,0.331742981805415,0.304237922029017,0.159031578060349,0.153256492027521,0.136215982237214,0.136215982237214,0.126478005294012,0.121570156225848,0.121003506416344,0.10941236688545,0.0866694820060765,0.0605404365498728,0.0605404365498728,0.0460063041676217,0.0409097743588679,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","1","1","1","29","1","31","32","1","1","33","1","34","40","41","47","48","50","51","53","1","1","59","60","1","1","1","1","107","1","149","156","157","163","166","167","178","192","221","1","5","251","321","1","328","329","330","331"],"x":[0.00300511392942715,0.34713459165519,-0.0344441125444515,0.861578228683175,0.00456045203064348,0.319104742488266,-0.950004357577767,-0.146656134477696,-0.706745119772064,0.776469983531194,-0.295268217250532,-0.950703337653659,-0.733858650237985,-0.515557066316842,0.51141843687466,-0.688243290322954,0.205824385447842,-0.679183320414136,-0.664423275492525,0.0786806153513318,0.81300511825533,-0.107650903069193,-0.437178879753609,0.546318381155788,-0.428169037122025,-1,-0.879226868940293,0.96503897110864,-0.247085292351964,0.632111879441158,-0.463056494630509,-0.798127519833675,-0.715601332367332,0.562378018372005,1,-0.439769191072872,-0.158840805012452,0.697858380825526,0.445118569238984,0.726982017599919,0.869759156139429,-0.35941650031795,0.955860705006036,0.715879738300014,-0.526606330717718,-0.28543021110278,0.508583011199384,0.660858175847234,0.401888198114785,0.41680442607184,0.296714266962168,0.264641624383875,0.197168842003614,-0.194981630549433,0.123671456002998,0.0119364278461487,-0.886183144818243,-0.551384364619945],"y":[-0.00751627682147704,-0.866357099257175,-0.674069493774393,-0.503391315145424,-0.986251831269526,-0.464985407497581,-0.251582174589234,1,-0.26977556360902,-0.176378608587374,-0.992791197508639,0.2253037494276,0.243567512486484,-0.861237010521189,-0.622577219310513,-0.72512355020559,-1,-0.521120875798968,0.755936671313949,0.969557579173313,0.0795522019217376,-0.42014079412365,0.910299023550617,-0.861765091570927,-0.222639183902058,-0.0033853720888265,-0.47812474828863,0.247230763371718,0.819330580493271,0.524325398088609,0.671537019857741,-0.0364633074559866,0.552329091693822,0.0352181676884851,-0.0338518030319659,-0.500034650603774,-0.855113752764461,0.715693485289355,-0.215517515874993,-0.690317862099358,0.486654343528796,-0.714618980408951,-0.284739571055775,0.306005590845175,0.398956123213092,0.291824752148097,0.846675853392674,-0.40430187639687,0.276772911867491,0.583076749243798,0.966708735658782,0.751634234021672,-0.690021536552013,0.570054493618838,0.463602816507652,0.749350544176872,0.451337871432451,0.045960115533779]},"edges":{"from":[23,19,50,48,21,35,5,43,24,2,52,34,25,8,20,42,11,12,33,58,7,10,18,30,44,27,51,29,41,31,26,14,39,55,4,45,56,15,47,22,38,3,57,6,17,46,13,9,28,53,49,16,40,37,54,32,36],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["160414","306170","304620","306170","304620","160414","306170","160414","306170","306170","160414","304620","160414","306170","306170","304620","160414","306170","160414","306170","306170","306170","306170","306170","160414","160414","160414","304620","304620","306170","306170","160414","160414","160414","306170","160414","304620","160414","160414","306170","306170","304620","304620","160414","306170","304620","306170","306170","306170","306170","306170","306170","160414","160414","304620","306170","160414"],"Year":[2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028],"weights":[27,22,30,11,14,90,19,12,17,21,12,12,89,18,21,26,38,13,60,16,40,43,16,13,14,13,32,51,14,14,64,81,12,14,18,18,20,30,16,16,18,99,15,91,26,20,11,22,204,11,13,456,16,49,18,11,12],"median_weight":[18930,21337.5,20350,21015,20725,21852.5,18790,20632.5,17860,17985,18005,22232.5,12595,15730,17695,20345,39387.5,17225,18877.5,10150,18147.5,17470,25547.5,17985,22240,19970,19665,19635,20015,17850,24010,20055,21182.5,47215,17700,18135,25257.5,19967.5,18340,18495,20465,20670,11200,19960,18420,15397.5,16990,18180,17970,18015,24010,17567.5,84037.5,18725,11500,17465,19510]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels","vessels/transshipment"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph of Mar del Este CJSC in 2028 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the year and id in edges and the corresponding id</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>filtered_graph_2029 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2029</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>unique_ids_2029 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>filtered_graph_2029 <span class="ot">&lt;-</span> filtered_graph_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2029) <span class="sc">%&gt;%</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>edges_df_2029 <span class="ot">&lt;-</span> filtered_graph_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>nodes_df_2029 <span class="ot">&lt;-</span> filtered_graph_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>nodes_df_2029<span class="ot">&lt;-</span> nodes_df_2029 <span class="sc">%&gt;%</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>vis_2029 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2029, edges_df_2029, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph of Mar del Este CJSC in 2029 "</span>,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>vis_2029</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4d665f32624bb07eaa2c" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-4d665f32624bb07eaa2c">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Viento Azul N.V. Distribution","Tripura  Market S.A. de C.V.","Mar de la Vida S.p.A.","Estrella de la Costa SRL","nián yú Ltd. Corporation","French  Seabed S.p.A. Forwading","CoralCove Foods AG Marine conservation","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Chuan gou  N.V. Delivery","Wave Watchers Ltd. Liability Co","Spanish Shrimp A/S Marine","Ethiopian Highlands  Incorporated Marine biology","Aqua Azul LC International","Norwegian Haddock Ltd. Corporation Logistics","Danish Plaice Ltd. Liability Co Logistics","Olas del Mar N.V.","Adriatic Tuna Seabass BV Transit","Spanish Shrimp Incorporated Carriers","Bay of Bengal's Corp","Costa de Coral SRL United","Konkan Coast  Dashi BV Investment","Richard S.A. de C.V. Solutions","Ocean Emporium Pic Holdings","Tristen Jetty Company Solutions","Mar del Placer CJSC Transport","Saltwater Sanctuary ОАО Merchants","Caracola del Sol Incorporated","xiǎo lóng xiā Pic","Kambala Limited Liability Company","Mar de la Aventura Limited Liability Company","Playa de Coral Distribution Marine sanctuary","Barents Sea Shrimp Plc","Gambia River   Ges.m.b.H. &","Mar y Viento Ltd. Liability Co Captain","Gulf of Tadjoura  Corp Shipping","Yenisei  Ltd. Liability Co","Baltic Catch Oyj Shipping","Dutch Eel LLC Express","Barco de Plata SE","Playa de Arena Pic","xiǎo lóng xiā SRL","Jiangxi Seal Plc Distribution"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Vesperanda","Vesperanda","Mawazam","Merigrad","Osterivaria","Thessalandia","Mawazam","Mawazam","Merigrad","Merigrad","Marebak","Osterivaria","Arreciviento","Vesperanda","Arreciviento","Mawazam","Mawazam","Osterivaria","Osterivaria","Mawazam","Merigrad","Arreciviento","Vesperanda","Merigrad","Osterivaria","Merigrad","Merigrad","Marebak","Islavaria","Arvekalia","Osterivaria","Mawazam","Osterivaria","Marebak","Vesperanda","Marebak","Solovarossa","Merigrad","Coral Solis","Marebak","Marebak","Coraland"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Nyxonix","Oceanus",null,"Oceanus","Oceanus","Luminkind","Oceanus",null,"Oceanus","Oceanus","Merigrad",null,null,"Oceanus",null,null,"Oceanus","Oceanus",null,"Oceanus","Rio Isla",null,"Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus",null,null,null,"Maripuerto","Oceanus","Oceanus",null,"Oceanus",null,"Puerto Sol","Coraland"],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,57,50,46,58,57,47,41,52,43,40,35,41,31,34,26,33,40,37,19,21,22,16,27,14,13,16,17,14,15,11,6,6,6,6,4,4,5,4,3,3,4,4,1],"degree_centrality":[400,108,117,96,98,87,77,64,57,50,46,58,57,47,41,52,43,40,35,41,31,34,26,33,40,37,19,21,22,16,27,14,13,16,17,14,15,11,6,6,6,6,4,4,5,4,3,3,4,4,1],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.300199088528637,0.329351108171994,0.323914548969599,0.256338039606934,0.214742113686044,0.248576589519272,0.268580836627804,0.183226876337697,0.205676577036492,0.217927630662034,0.224524194404989,0.185332177782541,0.21748520393706,0.187167196032936,0.230173840245718,0.180013158735149,0.14638562352806,0.132087705620464,0.154958122918133,0.137683535038096,0.129642520758976,0.162232116678244,0.0886437570957385,0.15022249461782,0.146647363481023,0.107846872147427,0.0898264731269451,0.0856420440310355,0.0707160310377389,0.0927152855430226,0.0908106548248092,0.0666265297755448,0.0603621491034087,0.0561858795400281,0.0605404365498728,0.0507251054543703,0.0318063156120698,0.0389222587649156,0.0454053274124046,0.0454053274124046,0.030392539056462,0.0293267998954027,0.0151351091374682],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,17.1113480461323,16.4675554085997,14.9000692526016,14.8676062972021,12.2403004801045,11.6830997074058,11.01181430174,9.52779756956026,8.84409281256914,8.71710522648137,7.85834680417462,7.59861928908419,6.74204132204887,6.36368466511981,5.98451984638868,5.9404342382599,5.8554249411224,4.88724510795717,2.94420433544453,2.89135423580002,2.85213545669747,2.59571386685191,2.39338144158494,2.10311492464948,1.9064157252533,1.72554995435884,1.52705004315807,1.1989886164345,1.06074046556608,1.01986814097325,0.544863928948855,0.399759178653269,0.362172894620452,0.337115277240169,0.242161746199491,0.202900421817481,0.159031578060349,0.155689035059662,0.136215982237214,0.136215982237214,0.121570156225848,0.117307199581611,0.0151351091374682],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","1","1","1","1","1","29","30","1","31","1","1","1","1","2","34","1","40","41","1","13","47","50","53","55","60","1","1","79","94","97","105","118","1","1","148","156","157","166","1","325"],"x":[-0.00061511719869578,1,0.0921134310765808,-0.995052958734359,0.438408740308153,-0.497162820332505,-0.240731634844064,0.684853899414124,-0.49359898162097,-0.0518415089439948,-0.7957776109841,0.407387783928437,-0.827423576946145,0.653691624247841,0.729896918087489,0.0878132562953462,0.394056118680304,0.134848694089523,-0.390231886934043,-0.0723213691189641,-0.322582639080886,0.507816122558409,0.0851418044338947,0.399118426093851,0.936467963693151,-0.242924098248931,0.926097157829883,-0.598695276403298,0.545099234346389,-0.103158660280654,-0.890478327048789,-1,-0.542660006632313,-0.917191715142282,0.436607491579431,-0.720258504834572,-0.758990791928847,0.21989662999559,0.368929366640251,-0.285409121712972,-0.448513822507516,-0.52929430635196,0.721917445174564,-0.220378662896966,0.723295764974123,0.730292718278896,0.865580534367178,-0.699320263112294,-0.66787223408209,0.929939768600483,0.242495588705797],"y":[-0.00836710734272017,0.0318885146086187,0.533876669750802,0.202662903443449,-0.131136740538286,-0.62883294324633,-0.577681181531612,-0.245375688651966,0.857983948367722,0.821276385320792,0.112416958888184,0.227252868906147,-0.21674288744746,0.359054497161823,-0.515008616293657,1,0.92281159738758,-0.969633298966514,-0.294534143520584,-0.771845626211374,-0.921450784230441,-0.764710371194707,-0.477859371492833,0.533790414973081,0.253820764507169,0.970994242110597,-0.41089730827504,-0.0626535137737594,0.758661278871093,-1,0.463840671627742,-0.0842942974801021,-0.847043066687416,-0.425921142761037,-0.470426724040172,0.69303658511324,-0.669121382918505,0.781007585429023,-0.936472496027802,0.710006130617771,0.219478767120857,0.584210642402262,0.649573850870051,0.447832971015646,-0.723362014326397,0.0665012049668461,0.473196671685375,0.37542203791469,-0.427889269727035,-0.174581049687504,-0.712023296107983]},"edges":{"from":[26,22,5,46,48,41,28,2,36,18,15,29,8,24,47,12,21,14,42,44,51,38,30,7,39,11,34,43,23,32,16,25,4,49,40,17,31,35,3,6,20,27,10,33,9,19,45,13,37,50],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["160414","306170","306170","306170","160414","306170","306170","306170","304620","306170","306170","160414","306170","306170","304620","160414","306170","306170","304620","306170","306170","306170","304620","306170","160414","306170","306170","160414","306170","306170","160414","160414","306170","160414","306170","160414","306170","304620","304620","160414","306170","306170","306170","306170","306170","306170","160414","304620","160414","306170"],"Year":[2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029,2029],"weights":[44,13,31,17,20,13,12,47,11,17,17,70,14,14,44,26,13,22,16,12,23,12,23,23,36,23,22,16,14,88,69,65,23,11,12,18,21,114,31,105,13,14,17,263,11,475,26,14,14,42],"median_weight":[18927.5,21330,18645,19735,19532.5,16050,17157.5,17985,23720,17095,19255,18830,16205,20652.5,20355,21005,17215,18375,18000,17825,15060,20495,27015,18160,186732.5,17515,17985,18980,17982.5,24010,20060,20420,17700,19375,17885,19542.5,19860,21775,19475,19965,18770,17647.5,18170,17765,19350,16975,96075,19910,19672.5,21897.5]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph of Mar del Este CJSC in 2029 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>filtered_graph_2030 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2030</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>unique_ids_2030 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>filtered_graph_2030 <span class="ot">&lt;-</span> filtered_graph_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2030) <span class="sc">%&gt;%</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>edges_df_2030 <span class="ot">&lt;-</span> filtered_graph_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>nodes_df_2030 <span class="ot">&lt;-</span> filtered_graph_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>nodes_df_2030<span class="ot">&lt;-</span> nodes_df_2030 <span class="sc">%&gt;%</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>vis_2030 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2030, edges_df_2030, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph ofMar del Este CJSC in 2030 "</span>,</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) </span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>vis_2030</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-94b659712ac06e724437" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-94b659712ac06e724437">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Tripura  Market S.A. de C.V.","Michael Ltd. Corporation Seal","Mar de la Vida S.p.A.","Estrella de la Costa SRL","nián yú Ltd. Corporation","CoralCove Foods AG Marine conservation","Tamil Nadu s Barge","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Chuan gou  N.V. Delivery","Edward Tsunami Ges.m.b.H. Family","Wave Watchers Ltd. Liability Co","Ethiopian Highlands  Incorporated Marine biology","Neptune's Harvest A/S Hijiki","Marine Muse Ltd. Corporation Catfish","Norwegian Haddock Ltd. Corporation Logistics","Danish Plaice Ltd. Liability Co Logistics","Olas del Mar N.V.","Madhya Pradesh  Market LLC","Adriatic Tuna Seabass BV Transit","Spanish Shrimp Incorporated Carriers","Bay of Bengal's Corp","Costa de Coral SRL United","Konkan Coast  Dashi BV Investment","Richard S.A. de C.V. Solutions","Ocean Emporium Pic Holdings","Tristen Jetty Company Solutions","Saltwater Sanctuary ОАО Merchants","Kerala  Market OJSC United","xiǎo lóng xiā Pic","Zambezi Delta  SE Solutions","Náutica del Sol Brothers","SaltSea & Inc Carriers","Mar de la Aventura Limited Liability Company","Mar de Cristalino OJSC","Barents Sea Shrimp Plc","Haryana Sea  Marine ecology","Gambia River   Ges.m.b.H. &","Mar y Viento Ltd. Liability Co Captain","Gulf of Tadjoura  Corp Shipping","Dutch Eel LLC Express","Barco de Plata SE","Icelandic Cod GmbH & Co. KG Express","Rift Valley fishery OJSC Enterprises","Aqua Azul Oyster  BV Freight ","suō yú Incorporated Seagull","bái suō wěn lú Ltd. Corporation Freight ","Norwegian Fjord  Plc Transit"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Mawazam","Vesperanda","Mawazam","Merigrad","Thessalandia","Vesperanda","Mawazam","Mawazam","Merigrad","Osterivaria","Merigrad","Osterivaria","Mawazam","Osterivaria","Vesperanda","Arreciviento","Mawazam","Merigrad","Mawazam","Osterivaria","Osterivaria","Mawazam","Merigrad","Arreciviento","Vesperanda","Merigrad","Merigrad","Arreciviento","Marebak","Coral Solis","Mawazam","Oceanus","Arvekalia","Coral Solis","Mawazam","Osterivaria","Osterivaria","Marebak","Vesperanda","Merigrad","Coral Solis","Rio Solovia","Brindivaria","Vesperanda","Marebak","Merigrad","Marebak"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,null,"Oceanus","Oceanus","Oceanus",null,null,"Oceanus","Oceanus","Oceanus","Merigrad",null,"Oceanus","Oceanus",null,null,"Oceanus","Oceanus","Oceanus",null,"Oceanus","Rio Isla",null,"Oceanus","Oceanus","Oceanus","Oceanus","Arreciviento",null,"Oceanus","Mawazam",null,"Oceanus","Oceanus",null,"Oceanus",null,null,"Maripuerto",null,"Oceanus","Oceanus","Oceanus",null,"Oceanus",null,null],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,50,50,46,58,57,41,37,52,43,40,43,35,31,54,31,26,33,40,35,37,19,21,22,16,27,14,13,17,12,15,12,16,7,6,7,6,9,6,4,4,3,3,4,4,2,2,2,1],"degree_centrality":[400,108,117,96,98,87,77,64,50,50,46,58,57,41,37,52,43,40,43,35,31,54,31,26,33,40,35,37,19,21,22,16,27,14,13,17,12,15,12,16,7,6,7,6,9,6,4,4,3,3,4,4,2,2,2,1],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.329351108171994,0.327819710483913,0.323914548969599,0.256338039606934,0.214742113686044,0.268580836627804,0.280390574201113,0.183226876337697,0.205676577036492,0.217927630662034,0.185387789309921,0.224524194404989,0.21748520393706,0.11549267762166,0.197978542824751,0.230173840245718,0.180013158735149,0.14638562352806,0.141010314486313,0.132087705620464,0.154958122918133,0.137683535038096,0.129642520758976,0.162232116678244,0.0886437570957385,0.15022249461782,0.146647363481023,0.0898264731269451,0.116402584545104,0.0707160310377389,0.0770996138198175,0.0385072635023907,0.0857289580418639,0.0908106548248092,0.0769394183369525,0.0603621491034087,0.0390977540707102,0.0561858795400281,0.0605404365498728,0.0507251054543703,0.0454053274124046,0.0454053274124046,0.0183113222247097,0.016069776325231,0.0302702182749364,0.0157208874497795,0.0152267164293193,0.0151351091374682],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,16.4675554085997,16.3909855241957,14.9000692526016,14.8676062972021,12.2403004801045,11.01181430174,10.3744512454412,9.52779756956026,8.84409281256914,8.71710522648137,7.97167494032661,7.85834680417462,6.74204132204887,6.23660459156964,6.13733482756727,5.98451984638868,5.9404342382599,5.8554249411224,4.93536100702095,4.88724510795717,2.94420433544453,2.89135423580002,2.85213545669747,2.59571386685191,2.39338144158494,2.10311492464948,1.9064157252533,1.52705004315807,1.39683101454125,1.06074046556608,0.92519536583781,0.616116216038251,0.600102706293048,0.544863928948855,0.538575928358668,0.362172894620452,0.351879786636392,0.337115277240169,0.242161746199491,0.202900421817481,0.136215982237214,0.136215982237214,0.0732452888988389,0.064279105300924,0.0605404365498728,0.031441774899559,0.0304534328586386,0.0151351091374682],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","1","1","1","1","1","29","30","3","1","1","2","1","1","1","2","11","34","1","40","41","1","13","47","50","55","1","1","1","5","75","79","80","97","100","105","118","1","156","157","205","215","1","1","1","323"],"x":[0.00945514957464577,0.661714791474523,0.790771522702834,0.430626776924607,0.811949867791976,0.324316373992522,0.509533431371743,0.992237428430694,0.275515702340561,0.785768850666218,-0.78767456053361,-0.250188500346026,-0.802327234802412,-0.166844195560696,-0.50568497187308,0.622200942662635,-1,0.415333643471808,0.724151002899381,-0.915096511160563,-0.860057646288493,0.988418850421825,-0.00174696737239333,-0.216646790791167,-0.723019809271713,-0.609923744750344,0.456043100581408,-0.118972762581747,-0.535949052804283,0.0759372390439534,0.216429746819885,-0.587480077707188,0.871251363003845,-0.43436327568292,-0.842395443417463,-0.448114254492432,0.0556496307877838,0.041208071380183,-0.982723718836697,0.135198570262605,-0.614655517947306,-0.778896176318498,0.896749015137312,0.273264317236982,-0.2496252822349,0.450159482322747,0.625133135819461,-0.396416564246628,0.57003360832245,1,-0.621885284783069,0.241972990106592,-0.398336782467546,-0.334117378086275,-0.144324791516564,0.659333858415634],"y":[-0.00229885652050299,0.621838972679068,0.348067031879521,-0.496984925450719,-0.640135665322613,0.675483172457733,0.440443581728551,-0.208259048998013,-0.987679604756057,0.0374808616248481,0.24940833682171,-0.730709680576965,-0.0729838243444377,1,-0.607955348458397,-0.762880993707222,-0.158878462691682,0.880458816337093,-0.215137925361244,0.410549277410593,-0.515947619711807,0.261235652900109,-0.70235788591919,0.76074551166522,-0.688192209900887,0.7966955552289,-0.873122416751576,-1,-0.846554475081604,-0.950409233545239,0.398987085353242,-0.368758945885943,0.554118280539359,-0.135976884495833,-0.313026562997841,0.63401197534923,0.711398225179774,0.961875056239268,0.117587299693037,-0.423910553607248,0.0836909465255231,0.621962133037146,-0.407378303167121,-0.714991356515568,-0.444667707776235,-0.134697517823499,0.818629984427276,0.297516327852193,0.172991493838877,0.01967547421029,0.457824047988803,0.987725254915745,0.917059482279978,-0.946341555860807,0.480531289455199,-0.476014828784932]},"edges":{"from":[28,53,5,50,44,30,2,18,14,31,8,25,49,19,12,21,46,48,45,51,37,32,7,27,43,42,11,47,23,10,22,56,24,40,34,16,26,4,17,33,52,41,36,3,6,29,15,9,35,20,39,55,13,54,38],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["160414","304620","306170","160414","306170","306170","306170","306170","306170","160414","306170","306170","304620","306170","160414","306170","304620","306170","306170","160414","160414","304620","306170","304620","160414","160414","306170","160414","306170","306170","160414","160414","306170","160414","306170","160414","160414","306170","160414","306170","160414","306170","304620","304620","160414","306170","306170","306170","306170","306170","160414","304620","304620","160414","160414"],"Year":[2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030,2030],"weights":[145,30,28,14,11,13,53,208,33,138,19,15,12,11,13,18,20,18,12,42,16,94,24,15,14,138,41,26,11,38,14,14,14,22,37,60,143,22,12,26,16,19,14,147,91,13,13,24,136,271,35,18,27,12,30],"median_weight":[19275,21800,18637.5,19355,17690,17145,17485,17485,19450,12590,16200,20225,21805,19060,20270,22552.5,17990,17825,19370,89945,19982.5,27012.5,18132.5,23970,19112.5,183925,16890,18980,16990,18635,18165,39030,17167.5,73732.5,24005,20055,24500,17695,30612.5,23070,37872.5,19330,21595,20965,19970,15620,17710,18395,15667.5,15755,17900,26910,22505,19010,19505]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph ofMar del Este CJSC in 2030 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>filtered_graph_2031 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2031</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>unique_ids_2031 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>filtered_graph_2031 <span class="ot">&lt;-</span> filtered_graph_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2031) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>edges_df_2031 <span class="ot">&lt;-</span> filtered_graph_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>nodes_df_2031 <span class="ot">&lt;-</span> filtered_graph_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>nodes_df_2031<span class="ot">&lt;-</span> nodes_df_2031 <span class="sc">%&gt;%</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>vis_2031 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2031, edges_df_2031, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph ofMar del Este CJSC in 2031 "</span>,</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) </span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>vis_2031</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a91437d61e7d490d81ee" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-a91437d61e7d490d81ee">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Tripura  Market S.A. de C.V.","Michael Ltd. Corporation Seal","Mar de la Vida S.p.A.","Estrella de la Costa SRL","CoralCove Foods AG Marine conservation","Oceanfront Oases Co Shipping","Tamil Nadu s Barge","Adriatic Catch Ltd. Liability Co Transportation","Chuan gou  N.V. Delivery","Wave Watchers Ltd. Liability Co","Ethiopian Highlands  Incorporated Marine biology","Marine Muse Ltd. Corporation Catfish","Norwegian Haddock Ltd. Corporation Logistics","Olas del Mar N.V.","Rift Valley fishery Sagl","Manipur  Market Corporation Cargo","West Bengal  Ltd. Corporation","Spanish Shrimp Incorporated Carriers","Costa de Coral SRL United","Konkan Coast  Dashi BV Investment","Tristen Jetty Company Solutions","Marmooska Ltd. Liability Co","Kerala  Market OJSC United","shí rén yú Marine conservation","Mar de la Aventura Limited Liability Company","Mar de Cristalino OJSC","jīn qiāng yú Express","Playa de Coral Distribution Marine sanctuary","Marine Mates Pic Delivery","Dolphin Dreams Corp Tidal","Aqua Ventures AG Merchants","Wave Riders GmbH & Co. KG Sea","SurfSide  GmbH & Co. KG Consulting","OceanSavor Surf Limited Liability Company Logistics","Arawak S.A. de C.V."],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Mawazam","Vesperanda","Mawazam","Thessalandia","Vesperanda","Vesperanda","Vesperanda","Merigrad","Merigrad","Osterivaria","Osterivaria","Vesperanda","Mawazam","Osterivaria","Vesperanda","Coralmarica","Osterivaria","Mawazam","Merigrad","Merigrad","Vesperanda","Arreciviento","Merigrad","Arvekalia","Coral Solis","Oceanus","Osterivaria","Marebak","Mawazam","Mawazam","Mawazam","Marebak","Marebak","Osterivaria"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,null,"Oceanus","Oceanus",null,null,"Coralmarica","Oceanus","Merigrad",null,"Oceanus",null,"Oceanus","Oceanus","Oceanus",null,null,"Rio Isla",null,"Oceanus","Oceanus","Arreciviento","Oceanus","Oceanus","Oceanus","Coral Solis","Oceanus",null,"Oceanus","Oceanus","Oceanus",null,null,"Oceanus"],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,50,50,46,58,41,46,37,42,40,35,31,31,26,40,31,29,24,19,22,16,13,13,12,11,6,7,8,6,7,8,6,8,3,2,1],"degree_centrality":[400,108,117,96,98,87,77,64,50,50,46,58,41,46,37,42,40,35,31,31,26,40,31,29,24,19,22,16,13,13,12,11,6,7,8,6,7,8,6,8,3,2,1],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.329351108171994,0.327819710483913,0.323914548969599,0.256338039606934,0.268580836627804,0.238627508277461,0.280390574201113,0.243543894897177,0.217927630662034,0.224524194404989,0.21748520393706,0.197978542824751,0.230173840245718,0.14638562352806,0.178753099306787,0.153350168706746,0.1292226387638,0.154958122918133,0.129642520758976,0.162232116678244,0.146647363481023,0.13035440035115,0.116402584545104,0.124469588848618,0.0908106548248092,0.0769394183369525,0.0623237141220214,0.0666265297755448,0.0489672928491812,0.0243628042940289,0.0280181262988372,0.0176626960936853,0.0302801761283672,0.0154500244335296,0.0151351091374682],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,16.4675554085997,16.3909855241957,14.9000692526016,14.8676062972021,11.01181430174,10.9768653807632,10.3744512454412,10.2288435856814,8.71710522648137,7.85834680417462,6.74204132204887,6.13733482756727,5.98451984638868,5.8554249411224,5.54134607851039,4.44715489249562,3.1013433303312,2.94420433544453,2.85213545669747,2.59571386685191,1.9064157252533,1.69460720456495,1.39683101454125,1.3691654773348,0.544863928948855,0.538575928358668,0.498589712976172,0.399759178653269,0.342771049944269,0.194902434352231,0.168108757793023,0.141301568749482,0.0908405283851017,0.0309000488670592,0.0151351091374682],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","1","1","27","1","1","30","1","1","1","1","2","1","36","1","1","41","1","50","1","1","1","79","80","1","94","102","128","144","1","190","270","324"],"x":[-0.00403471398683586,-0.924605455273383,-0.185297116775778,-0.703129496113746,0.130530269337841,0.242670926422227,-0.435837118986172,0.81512557300969,-0.858222053569376,-0.601147194759644,0.0592116912073009,-1,0.978372400046835,0.940673311141154,-0.144293231868346,1,0.628878307206884,0.275352636144595,0.051607332819156,0.355052594403733,0.791567261138397,-0.205468652651068,0.705085912874582,-0.0295988682325651,-0.897452606661188,-0.723023218399789,-0.338603086535058,0.559559435058677,-0.171256012571136,0.51344216499143,-0.658549358366174,0.395187716728641,-0.440232837121906,-0.66219576055288,-0.395355630104672,0.581790000355128,0.766756733132545,0.737856253249536,-0.430769085535277,0.314840502846122,-0.976205788382575,0.354083951947712,-0.637345631441969],"y":[0.0191500274669811,-0.27594074624995,0.986135776661537,0.75466273667708,0.67038247905965,-0.970036310827879,0.939860621390898,-0.412452413342847,-0.52582886915835,-0.450818397476523,1,-0.0383236568271222,-0.231293782823826,0.372628223420542,0.66087643785126,0.0830834291182247,0.812897666831319,0.161502390110051,-0.671603685869662,-0.746925605393621,0.598418794334991,-0.83839526544655,0.243831420917036,-1,0.508026327849035,0.126087465714467,-0.591949737431881,-0.246421143135767,-0.249314201999819,0.473195493862051,-0.740500299420194,0.740765853784621,-0.9065910429327,0.453729278740525,0.311348511938974,-0.81705209097563,-0.0404825917543616,-0.627174308587099,0.675626479508954,0.986321337384781,0.234167704791078,-0.465901583066575,-0.153500115529703]},"edges":{"from":[16,39,43,5,2,17,13,27,8,38,12,19,31,28,7,24,34,33,11,37,20,30,10,21,42,14,22,4,36,23,3,6,26,41,15,9,29,29,40,18,18,25,35,32],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["306170","160414","306170","306170","306170","306170","306170","160414","306170","160414","160414","306170","160414","304620","306170","306170","160414","160414","306170","160414","306170","306170","306170","306170","304620","306170","160414","306170","306170","306170","304620","160414","306170","306170","306170","306170","304620","306170","160414","304620","306170","304620","306170","306170"],"Year":[2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031,2031],"weights":[17,26,15,38,186,393,43,76,49,28,26,12,16,77,13,35,25,166,24,14,65,27,52,12,14,11,56,41,19,14,117,143,38,14,13,69,117,100,22,262,366,16,32,99],"median_weight":[17265,16977.5,23500,18645,18535,17950,19860,19297.5,17160,21610,20077.5,22685,19972.5,27015,17935,18290,19325,189562.5,17980,23565,18540,18800,17935,23815,19887.5,17880,44900,25500,20420,19557.5,20965,19965,16707.5,24970,17995,18175,18605,17345,20065,18530,17477.5,22097.5,17827.5,18135]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph ofMar del Este CJSC in 2031 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>filtered_graph_2032 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2032</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>unique_ids_2032 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>filtered_graph_2032 <span class="ot">&lt;-</span> filtered_graph_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2032) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>edges_df_2032 <span class="ot">&lt;-</span> filtered_graph_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>nodes_df_2032 <span class="ot">&lt;-</span> filtered_graph_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>nodes_df_2032<span class="ot">&lt;-</span> nodes_df_2032 <span class="sc">%&gt;%</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>vis_2032 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2032, edges_df_2032, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph ofMar del Este CJSC in 2032 "</span>,</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) </span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>vis_2032</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ae96de491a508c5ee5e6" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-ae96de491a508c5ee5e6">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Viento Azul N.V. Distribution","Tripura  Market S.A. de C.V.","Michael Ltd. Corporation Seal","Mar de la Vida S.p.A.","Estrella de la Costa SRL","nián yú Ltd. Corporation","CoralCove Foods AG Marine conservation","Tamil Nadu s Barge","Adriatic Catch Ltd. Liability Co Transportation","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Chuan gou  N.V. Delivery","Wave Watchers Ltd. Liability Co","Mar del Oeste Cruise ship","Aqua Azul LC International","Neptune's Harvest A/S Hijiki","Marine Muse Ltd. Corporation Catfish","Norwegian Haddock Ltd. Corporation Logistics","Olas del Mar N.V.","The Salty Dog LLC","Adriatic Tuna Seabass BV Transit","Turkish Salmon A/S Marine","West Bengal  Ltd. Corporation","Spanish Shrimp Incorporated Carriers","Costa de Coral SRL United","Konkan Coast  Dashi BV Investment","Marit GmbH & Co. KG","Tristen Jetty Company Solutions","Marmooska Ltd. Liability Co","The Salty Dog Limited Liability Company","Kerala  Market OJSC United","shí rén yú Marine conservation","Aqua Mermaid Sagl Merchants","Kambala Limited Liability Company","Norwegian King Crab GmbH & Co. KG","Isla del Tesoro SE Transport","Caracola del Este Incorporated","Spanish Anchovy OJSC International","SaltSea & Inc Carriers","Mar de la Aventura Limited Liability Company","Mar de Cristalino OJSC","jīn qiāng yú Express","Mar y Viento Abalone N.V. Marine conservation","Playa de Coral Distribution Marine sanctuary","xiǎo xiā A/S Holdings","Marine Mates Pic Delivery","OceanKing s ship Pic Logistics","Lake Kariba   GmbH & Co. KG","Mar y Viento Ltd. Liability Co Captain","AquaBite Limited Liability Company Marine","SurfSide  GmbH & Co. KG Consulting","CoralCrest Limited Liability Company Seabass","Turkish Salmon LC Barracuda","Black Sea Anchovy NV","Mar del Oeste LLC Marine"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Vesperanda","Mawazam","Vesperanda","Mawazam","Merigrad","Thessalandia","Vesperanda","Vesperanda","Mawazam","Mawazam","Merigrad","Merigrad","Arreciviento","Arreciviento","Mawazam","Osterivaria","Vesperanda","Mawazam","Vesperanda","Mawazam","Vesperanda","Coralmarica","Osterivaria","Mawazam","Merigrad","Vesperanda","Merigrad","Vesperanda","Islavaria","Arreciviento","Merigrad","Osterivaria","Islavaria","Merigrad","Osterivaria","Vesperanda","Osterivaria","Oceanus","Arvekalia","Coral Solis","Oceanus","Mawazam","Osterivaria","Osterivaria","Marebak","Coral Solis","Marebak","Marebak","Coral Solis","Marebak","Merigrad","Mawazam","Osterivella","Merigrad"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Nyxonix","Oceanus",null,null,"Oceanus","Oceanus","Oceanus",null,"Coralmarica",null,"Oceanus","Oceanus","Merigrad",null,"Oceanus","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus",null,null,"Rio Isla",null,null,"Oceanus","Oceanus","Coralmarica","Arreciviento","Oceanus",null,"Oceanus","Oceanus",null,null,null,null,"Oceanus","Oceanus","Coral Solis","Oceanus","Oceanus","Oceanus",null,null,"Marebak",null,null,null,null,"Oceanus","Oceanus",null],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,57,50,50,46,58,57,41,37,42,52,43,40,35,32,34,54,31,26,40,34,37,20,24,19,22,16,18,13,13,14,12,11,16,11,11,14,11,10,7,6,7,8,13,6,11,7,5,10,4,4,3,4,2,2,2],"degree_centrality":[400,108,117,96,98,87,77,64,57,50,50,46,58,57,41,37,42,52,43,40,35,32,34,54,31,26,40,34,37,28,24,19,22,16,18,13,13,16,12,11,16,11,11,14,11,10,7,6,7,8,13,6,11,7,5,10,4,4,3,4,2,2,2],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.300199088528637,0.329351108171994,0.327819710483913,0.323914548969599,0.256338039606934,0.214742113686044,0.268580836627804,0.280390574201113,0.243543894897177,0.183226876337697,0.205676577036492,0.217927630662034,0.224524194404989,0.22113181656351,0.187167196032936,0.11549267762166,0.197978542824751,0.230173840245718,0.14638562352806,0.149890588409804,0.132087705620464,0.141185159415721,0.1292226387638,0.154958122918133,0.129642520758976,0.162232116678244,0.122714364871097,0.146647363481023,0.13035440035115,0.0907540195886131,0.116402584545104,0.124469588848618,0.0672751668100151,0.0927152855430226,0.0890006492962717,0.0688422741033549,0.078971172921881,0.0699159603077796,0.0857289580418639,0.0908106548248092,0.0769394183369525,0.0623237141220214,0.0364995112080282,0.0666265297755448,0.033817587988633,0.0489672928491812,0.0608475844058034,0.0275590271223556,0.0605404365498728,0.0540484519210718,0.0302801761283672,0.021650117891088,0.0302702182749364,0.0302702182749364,0.0302702182749364],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,17.1113480461323,16.4675554085997,16.3909855241957,14.9000692526016,14.8676062972021,12.2403004801045,11.01181430174,10.3744512454412,10.2288435856814,9.52779756956026,8.84409281256914,8.71710522648137,7.85834680417462,7.07621813003231,6.36368466511981,6.23660459156964,6.13733482756727,5.98451984638868,5.8554249411224,5.09628000593334,4.88724510795717,3.95318446364019,3.1013433303312,2.94420433544453,2.85213545669747,2.59571386685191,2.20885856767975,1.9064157252533,1.69460720456495,1.45206431341781,1.39683101454125,1.3691654773348,1.07640266896024,1.01986814097325,0.979007142258988,0.963791837446969,0.868682902140691,0.699159603077796,0.600102706293048,0.544863928948855,0.538575928358668,0.498589712976172,0.474493645704366,0.399759178653269,0.371993467874963,0.342771049944269,0.304237922029017,0.275590271223556,0.242161746199491,0.216193807684287,0.0908405283851017,0.0866004715643519,0.0605404365498728,0.0605404365498728,0.0605404365498728],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","1","1","1","1","1","1","1","29","30","1","32","1","2","1","1","2","1","34","37","1","1","41","1","45","50","1","56","1","1","16","1","1","63","67","71","75","79","80","1","85","94","1","102","107","1","118","123","190","193","221","1","222"],"x":[0.00479500083235318,0.732987885712344,0.140026379175281,-0.536347404260433,-0.683197406134802,-0.398277222037396,-0.639090087730184,-0.856414463308332,0.676704859419028,0.135088184995141,0.492672832291303,0.402487458368161,0.611483515803966,-0.397810669524463,-0.13514070043077,-0.510340808453535,-0.352039449739713,0.830090134285315,0.0476061082966344,-0.703638219820523,0.221104303638733,0.784199071404019,0.848698773967009,-0.991377552235533,-0.153642942031593,-0.358671559543877,0.275683696992333,0.784100808849884,0.495234884974128,1,0.0785213099340787,0.964478437405476,-0.215527326176335,0.403084480097313,-0.620800961066884,-0.270276217071404,-0.888081669895462,-0.756642882552972,-0.687942080835022,-0.359452381770856,0.482252545489707,-0.414995257434971,0.624609220782435,0.300008577853627,0.944353467214601,-1,-0.630069047150138,-0.136412824469503,0.792792380776218,-0.88877780506294,0.0708681276635394,0.297854533171647,-0.585730284902984,0.0378973197473242,0.605002792819846,0.561441249349277,-0.132107774266581,0.536333791986603,0.289078351027476,-0.912475616990465,-0.141042685968416,-0.843521629876786,0.991105960121869],"y":[-0.00491481715362307,0.328901328370568,0.75343729224852,0.819343791271954,-0.275605734261275,0.640246617948765,0.510126663199477,0.517317457624409,0.741948215292261,-0.531180256687103,0.888184949512884,0.711297619271297,-0.72951059781607,-0.601391680490624,-0.993787775856722,-0.819049711044293,0.391964501196694,0.564932771525902,0.427878132780667,0.707123356879895,-0.168443615586077,0.0928282430794662,-0.445358768113409,-0.197648119227587,1,0.905249748854549,0.952569425514092,-0.16008471111941,-0.87674745931739,-0.0729953045526135,-1,-0.291600290439473,-0.784903304700777,-0.542155698044973,-0.0569512521420082,0.00834820614729281,-0.364136756387506,0.133638168419555,-0.738904017185489,-0.950853721494485,0.304988521056959,-0.331194655766629,-0.48265765466628,0.508976480631358,0.352718781049286,0.149693474747956,-0.523962524563547,0.605235492212095,-0.643463216079908,0.32889964869243,0.979587666760706,-0.757843193930167,0.280429101224321,-0.783238102473831,0.543115963331501,-0.254709583470931,0.810012127803916,0.0354127520610126,-0.967134008127366,-0.0345893400789766,-0.538861385486841,-0.557307259938582,0.14376876767058]},"edges":{"from":[17,29,23,41,58,5,62,2,45,20,15,60,33,8,13,44,42,39,34,56,7,49,48,12,22,63,51,57,54,25,35,37,11,24,26,43,18,55,27,4,52,19,47,3,6,46,32,59,16,28,38,10,36,36,30,61,9,21,21,31,50,14,40,53],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["306170","160414","306170","306170","160414","306170","306170","306170","306170","306170","306170","306170","160414","306170","160414","306170","306170","160414","304620","160414","306170","160414","160414","306170","306170","304620","160414","160414","160414","306170","306170","306170","306170","160414","306170","160414","160414","160414","160414","306170","306170","160414","306170","304620","160414","306170","306170","306170","306170","306170","306170","306170","304620","306170","306170","306170","306170","304620","306170","304620","306170","304620","306170","160414"],"Year":[2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032,2032],"weights":[11,14,12,11,14,40,12,231,44,245,38,12,191,30,16,11,11,20,60,20,72,27,192,135,19,13,12,14,40,83,26,28,43,43,12,12,32,28,40,47,34,41,21,272,208,27,39,16,31,15,31,108,36,478,12,11,19,35,544,18,19,42,78,12],"median_weight":[20665,20027.5,22595,17415,16065,20715,21645,18565,18895,19945,19612.5,18800,17095,20415,21255,20075,20155,19980,27015,21375,18352.5,18815,191775,17440,23465,10175,20802.5,18980,70847.5,18600,22635,22505,17930,17175,19947.5,20137.5,19010,21525,38095,25500,19515,19805,19935,21595,19965,20025,17990,24980,20165,19455,23705,19252.5,17110,17170,26260,24000,18665,16940,17120,24142.5,19895,24002.5,18805,19662.5]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels","vessels/transshipment"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph ofMar del Este CJSC in 2032 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>#2033</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>filtered_graph_2033 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2033</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>unique_ids_2033 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>filtered_graph_2033 <span class="ot">&lt;-</span> filtered_graph_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2033) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>edges_df_2033 <span class="ot">&lt;-</span> filtered_graph_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>nodes_df_2033 <span class="ot">&lt;-</span> filtered_graph_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>nodes_df_2033<span class="ot">&lt;-</span> nodes_df_2033 <span class="sc">%&gt;%</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>vis_2033 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2033, edges_df_2033, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph ofMar del Este CJSC in 2033 "</span>,</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) </span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>vis_2033</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-34502bf33f978b4367d0" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-34502bf33f978b4367d0">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Lake Tana  & Son's","Daniel Ferry N.V. Transit","Tripura  Market S.A. de C.V.","Mar de la Vida S.p.A.","Estrella de la Costa SRL","Perla del Mar Deep-sea","nián yú Ltd. Corporation","CoralCove Foods AG Marine conservation","Oceanfront Oases Co Shipping","Tamil Nadu s Barge","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Chuan gou  N.V. Delivery","Wave Watchers Ltd. Liability Co","Mar del Oeste Cruise ship","Neptune's Harvest A/S Hijiki","Marine Muse Ltd. Corporation Catfish","Danish Plaice Ltd. Liability Co Logistics","Olas del Mar N.V.","The Salty Dog LLC","Adriatic Tuna Seabass BV Transit","Manipur  Market Corporation Cargo","Turkish Salmon A/S Marine","West Bengal  Ltd. Corporation","Spanish Shrimp Incorporated Carriers","Costa de Coral SRL United","Rufiji River  Ges.m.b.H. Family","Donald Sp & Son's","Marit GmbH & Co. KG","Ocean Emporium Pic Holdings","Tristen Jetty Company Solutions","Marmooska Ltd. Liability Co","The Salty Dog Limited Liability Company","Kerala  Market OJSC United","shí rén yú Marine conservation","Norwegian King Crab GmbH & Co. KG","Caracola del Este Incorporated","Spanish Anchovy OJSC International","Seaside Summit SE Merchants","guī yú Ltd. Corporation","Mar de la Aventura Limited Liability Company","Mar de Cristalino OJSC","Yenisei  Eel GmbH & Co. KG Services","jīn qiāng yú Express","Mar y Viento Abalone N.V. Marine conservation","Playa de Coral Distribution Marine sanctuary","xiǎo xiā A/S Holdings","Angrapa S.A. de C.V.","Marine Mates Pic Delivery","Gambia River   Ges.m.b.H. &","OceanKing s ship Pic Logistics","Mar y Viento Ltd. Liability Co Captain","Uttarakhand   Tidepool Oyj International","AquaBite Limited Liability Company Marine","Gulf of Tadjoura  Corp Shipping","Ob River LLC and Son's","Pez Dorado Inc Freight ","Ola de la Costa Ges.m.b.H.","Marine Adventures Ltd Cod","Coral Reef Oyj Solutions","Estrella de Mar AB Delivery","Greek ermen Kga Freight ","Black Sea Anchovy NV","Mar del Oeste LLC Marine","Ola del Este Ltd"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Osterivaria","Vesperanda","Vesperanda","Mawazam","Osterivaria","Merigrad","Thessalandia","Vesperanda","Vesperanda","Mawazam","Mawazam","Merigrad","Merigrad","Arreciviento","Mawazam","Osterivaria","Arreciviento","Mawazam","Vesperanda","Mawazam","Vesperanda","Vesperanda","Coralmarica","Osterivaria","Mawazam","Vesperanda","Merigrad","Vesperanda","Vesperanda","Merigrad","Vesperanda","Islavaria","Arreciviento","Merigrad","Merigrad","Vesperanda","Osterivaria","Merigrad","Oceanus","Arvekalia","Coral Solis","Merigrad","Oceanus","Mawazam","Osterivaria","Osterivaria","Marebak","Marebak","Osterivaria","Coral Solis","Marebak","Marebak","Coral Solis","Vesperanda","Vesperanda","Merigrad","Merigrad","Marebak","Marebak","Merigrad","Marebak","Osterivella","Merigrad","Marebak"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus",null,null,null,"Oceanus","Oceanus","Merigrad",null,"Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,null,"Rio Isla","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Coralmarica","Arreciviento","Oceanus","Oceanus",null,null,null,"Oceanus","Oceanus","Oceanus","Oceanus","Coral Solis","Oceanus","Oceanus","Oceanus",null,null,null,null,null,"Marebak",null,"Maripuerto","Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus",null,"Oceanus",null,"Utoporiana"],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,77,64,50,46,58,68,57,41,46,37,52,43,40,35,32,54,31,33,40,34,37,29,20,24,19,22,18,21,18,14,13,13,14,12,11,11,11,10,19,9,6,7,7,8,13,6,11,8,7,6,5,4,7,4,4,5,9,4,3,5,3,4,2,2,3],"degree_centrality":[400,108,117,96,98,87,77,64,50,46,58,68,57,41,46,37,52,43,40,35,32,54,31,33,40,34,37,29,28,24,19,22,18,21,18,14,13,13,16,12,11,11,11,10,19,9,6,7,7,8,13,6,11,8,7,6,5,4,7,4,4,5,9,4,3,5,3,4,2,2,3],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.332105433070485,0.322405903470676,0.329351108171994,0.323914548969599,0.256338039606934,0.201785790214797,0.214742113686044,0.268580836627804,0.238627508277461,0.280390574201113,0.183226876337697,0.205676577036492,0.217927630662034,0.224524194404989,0.22113181656351,0.11549267762166,0.197978542824751,0.180013158735149,0.14638562352806,0.149890588409804,0.132087705620464,0.153350168706746,0.141185159415721,0.1292226387638,0.154958122918133,0.129642520758976,0.145976887049605,0.112757621743321,0.122714364871097,0.15022249461782,0.146647363481023,0.13035440035115,0.0907540195886131,0.116402584545104,0.124469588848618,0.0890006492962717,0.078971172921881,0.0699159603077796,0.0366160467291787,0.0637524610832706,0.0908106548248092,0.0769394183369525,0.0732504800293336,0.0623237141220214,0.0364995112080282,0.0666265297755448,0.033817587988633,0.0438705385892335,0.0489672928491812,0.0561858795400281,0.0608475844058034,0.0605404365498728,0.0318447947552434,0.0540484519210718,0.0507251054543703,0.0357428959742571,0.0187804779405785,0.0342237472131506,0.0421593350980041,0.0193700599204569,0.030277153908864,0.0183113222247097,0.0302702182749364,0.0302702182749364,0.0172525845289625],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,25.5721183464273,20.6339778221233,16.4675554085997,14.9000692526016,14.8676062972021,13.7214337346062,12.2403004801045,11.01181430174,10.9768653807632,10.3744512454412,9.52779756956026,8.84409281256914,8.71710522648137,7.85834680417462,7.07621813003231,6.23660459156964,6.13733482756727,5.9404342382599,5.8554249411224,5.09628000593334,4.88724510795717,4.44715489249562,3.95318446364019,3.1013433303312,2.94420433544453,2.85213545669747,2.62758396689288,2.36791005660973,2.20885856767975,2.10311492464948,1.9064157252533,1.69460720456495,1.45206431341781,1.39683101454125,1.3691654773348,0.979007142258988,0.868682902140691,0.699159603077796,0.695704887854395,0.573772149749436,0.544863928948855,0.538575928358668,0.512753360205335,0.498589712976172,0.474493645704366,0.399759178653269,0.371993467874963,0.350964308713868,0.342771049944269,0.337115277240169,0.304237922029017,0.242161746199491,0.222913563286704,0.216193807684287,0.202900421817481,0.178714479871285,0.169024301465206,0.136894988852602,0.126478005294012,0.0968502996022846,0.0908314617265921,0.0732452888988389,0.0605404365498728,0.0605404365498728,0.0517577535868876],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels/transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","3","1","1","1","1","3","1","1","27","1","1","29","30","1","32","2","1","1","2","1","34","36","37","1","1","41","1","43","45","47","50","1","56","1","1","1","67","71","72","1","79","80","1","1","85","94","1","101","102","105","107","118","1","123","1","135","143","155","163","187","191","206","1","222","232"],"x":[0.00851409936510961,-0.774313626147661,-0.56219826694815,0.869718036824549,-0.0865896533122712,0.861765434578697,0.279917799294638,-0.717032005990942,0.307509231183168,0.542811809719185,0.594905364795707,0.537707466527943,-0.271836714540454,0.986566643746186,0.0922242725225229,-0.678117319657014,0.0547993825150523,0.535020234691345,0.307298512785562,0.0768099850843742,0.515453123537672,-0.682075790829595,0.223572980121376,-0.0181159878786903,0.599564980226321,-0.429266013789968,-0.830495696625652,0.080845261829283,-0.607833436695472,0.345142337598924,-0.924043229213439,-0.286475114780465,0.447465111562258,-0.939488364925277,0.255810403940603,0.44840466564338,0.86018051622739,-0.452445998461326,0.676926468954093,0.136855619972076,0.599543936791134,-0.312366046707798,0.41488374668521,-0.484871172932635,-0.719303847982389,0.988971111401824,0.720428792578426,1,-0.149114161522873,0.783848608817171,-0.110400716538114,-0.114883198895836,0.780461712014129,0.940525283316601,-0.710411721188909,-0.863645428367556,-0.65507241541822,-0.874173211563679,-0.471006256144692,-0.355980621952693,0.727382366868415,0.304666233086636,-0.210922271511399,-0.506077192994641,-1,-0.497495688519949,-0.284702334885109,-0.0707474155007876,0.75137425204581,-0.400457371173156,-0.967694265605824],"y":[0.00164556901102553,-0.163074632612647,-0.263955852887885,0.337396307269372,0.365225976868231,0.531054973147074,0.653611068967727,-0.639944754530724,-0.780603025782211,-0.59254030425587,-0.783458544633657,-0.10430725159446,0.520742352386931,0.0404719341542865,0.551506814469399,0.0207894875547467,-0.615753238314051,0.875032166651088,-0.577733983073873,-0.835723185866461,-0.366929402648436,0.727244648996532,-0.972471839448386,-1,0.171642169199714,-0.729447985927973,0.553784381871015,1,-0.785442257408436,0.184281983065606,0.368131122053566,-0.578621050109238,-0.903026014270367,-0.293800286551509,-0.320594719103276,0.73514195722609,-0.510100876517268,0.121418916233926,0.386794608744231,0.826528594771868,0.585692830743955,0.948756199469138,0.4387944483963,0.653176762347212,-0.412183171407759,0.225012913044829,-0.377532925555125,-0.141608260699895,-0.76276665400525,0.0703657118190923,-0.407771096095932,0.965976964387568,-0.155367007010453,-0.324779199226136,0.289230131968165,0.174447033325136,0.50334888340514,-0.493146857039243,0.370360205850583,-0.175225114854049,0.707499827194731,0.944800163103451,-0.954329052468173,-0.508724003244182,0.0875259405430975,0.856341737232271,0.758124233441452,0.741692150971728,-0.661733068266686,-0.911561884437947,-0.0955722994162129]},"edges":{"from":[27,54,60,5,69,2,43,19,66,14,32,8,24,34,67,11,56,68,61,40,7,28,48,47,10,21,70,51,58,65,55,23,35,38,22,42,62,36,17,57,15,64,71,25,12,63,4,52,18,33,3,45,6,44,31,16,26,39,9,37,29,59,20,30,49,46,50,13,41,53],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["160414","160414","160414","306170","306170","306170","306170","306170","160414","306170","160414","306170","306170","306170","160414","160414","306170","160414","306170","160414","306170","306170","160414","160414","306170","306170","304620","160414","160414","160414","160414","306170","306170","306170","160414","160414","306170","306170","160414","160414","306170","306170","160414","160414","306170","160414","306170","306170","160414","306170","304620","160414","160414","306170","306170","306170","306170","306170","306170","306170","306170","304620","306170","304620","304620","306170","306170","304620","306170","160414"],"Year":[2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033,2033],"weights":[25,53,28,66,12,307,16,163,64,47,119,35,11,15,12,61,11,14,12,26,12,39,30,173,41,17,14,18,12,18,48,84,17,16,152,26,15,21,50,68,23,310,28,36,15,77,35,14,44,23,360,121,205,19,44,44,20,30,91,507,18,21,543,31,56,16,42,52,137,33],"median_weight":[19810,98910,19167.5,20705,22022.5,18340,19260,19725,98917.5,18530,17095,20425,18270,17885,12040,20810,20740,74217.5,17825,19975,17482.5,20345,19315,189235,16985,22715,10175,20807.5,19480,21090,86870,18340,18435,21807.5,17620,20465,20955,24810,18922.5,21597.5,19445,17120,100550,19170,16995,20270,21565,18385,20055,20140,22420,20270,19965,18525,20015,19612.5,19720,20652.5,20435,16790,26260,19980,16990,23130,21177.5,22010,19382.5,22240,18800,19665]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels","vessels/transshipment"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph ofMar del Este CJSC in 2033 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>filtered_graph_2034 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2034</span>, to <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>unique_ids_2034 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(filtered_graph_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(from),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                       filtered_graph_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">pull</span>(to)))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>filtered_graph_2034 <span class="ot">&lt;-</span> filtered_graph_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> unique_ids_2034) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>edges_df_2034 <span class="ot">&lt;-</span> filtered_graph_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>nodes_df_2034 <span class="ot">&lt;-</span> filtered_graph_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> label)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>nodes_df_2034<span class="ot">&lt;-</span> nodes_df_2034 <span class="sc">%&gt;%</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> node_type) </span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network graph with labeled nodes using visNetwork</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>vis_2034 <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_df_2034, edges_df_2034, <span class="at">submain =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Network Graph ofMar del Este CJSC in 2034 "</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">dragNodes =</span> <span class="cn">TRUE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) </span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>vis_2034</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d9327f1edcb6de183860" style="width:100%;height:433px;"></div>
<script type="application/json" data-for="htmlwidget-d9327f1edcb6de183860">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61],"label":["Mar del Este CJSC","Blue Horizon Family &","Sea Breezes S.A. de C.V. Freight ","Playa de Arena OJSC Express","Balkan Cat ОАО Transport","Shou gan  Oyj Overseas","Daniel Ferry N.V. Transit","Viento Azul N.V. Distribution","Tripura  Market S.A. de C.V.","Mar de la Vida S.p.A.","Estrella de la Costa SRL","nián yú Ltd. Corporation","CoralCove Foods AG Marine conservation","Oceanfront Oases Co Shipping","Tamil Nadu s Barge","Playa del Mar Corporation","Ocean Quest Inc Marine ecology","Pregolya S.A. de C.V. Import","Chuan gou  N.V. Delivery","Wave Watchers Ltd. Liability Co","Oceanfront Oasis Company Green ","Neptune's Harvest A/S Hijiki","Marine Muse Ltd. Corporation Catfish","Olas del Mar N.V.","Arena del Sol Pic","The Salty Dog LLC","Italian Sardines Ltd. Liability Co","Manipur  Market Corporation Cargo","West Bengal  Ltd. Corporation","Spanish Shrimp Incorporated Carriers","Costa de Coral SRL United","Rufiji River  Ges.m.b.H. Family","Donald Sp & Son's","Marit GmbH & Co. KG","Seaside Strolls A/S Marine ecology","Ocean Emporium Pic Holdings","Tristen Jetty Company Solutions","Marmooska Ltd. Liability Co","Kerala  Market OJSC United","Isla del Mar Ltd. Liability Co Enterprises","Bahía Azul Marine sanctuary","Caracola del Este Incorporated","Seaside Summit SE Merchants","Caracola Marina Ltd Holdings","Mar de la Aventura Limited Liability Company","Mar de Cristalino OJSC","Yenisei  Eel GmbH & Co. KG Services","Tamil Nadu   Express Surf","OceanKing s ship Pic Logistics","Uttarakhand   Tidepool Oyj International","Ob River LLC and Son's","Ola de la Costa Ges.m.b.H.","Bahía del Sol Kga Consulting","Estrella de Mar AB Delivery","Mar de la Luz Oyj Merchants","Baltic Sprat Pic Freight ","Adriatic Squid SE Marine conservation","Jammu & Kashmir  & Son's and","Spanish Anchovy CJSC Marine","Arunachal Pradesh s Sagl","Estrella del Mar N.V. Solutions"],"shpcountry":["Merigrad","Osterivaria","Isliandor","Vesperanda","Vesperanda","Mawazam","Osterivaria","Vesperanda","Vesperanda","Vesperanda","Mawazam","Merigrad","Thessalandia","Vesperanda","Vesperanda","Vesperanda","Mawazam","Mawazam","Merigrad","Merigrad","Mawazam","Mawazam","Osterivaria","Mawazam","Merigrad","Vesperanda","Vesperanda","Vesperanda","Coralmarica","Osterivaria","Mawazam","Vesperanda","Merigrad","Vesperanda","Vesperanda","Vesperanda","Merigrad","Vesperanda","Arreciviento","Merigrad","Coral Solis","Vesperanda","Merigrad","Vesperanda","Arvekalia","Coral Solis","Merigrad","Osterivaria","Coral Solis","Marebak","Vesperanda","Merigrad","Vesperanda","Merigrad","Merigrad","Vesperanda","Merigrad","Polarisdom","Merigrad","Isliandor","Arreciviento"],"rcvcountry":["Oceanus",null,"Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Nyxonix","Oceanus",null,"Oceanus","Oceanus","Oceanus",null,null,"Coralmarica",null,"Oceanus","Oceanus","Merigrad","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus",null,null,"Rio Isla","Oceanus","Oceanus",null,null,"Oceanus","Oceanus","Oceanus","Arreciviento","Oceanus","Oceanus",null,null,"Marifada","Oceanus","Oceanus","Oceanus","Oceanus",null,"Marebak","Oceanus",null,"Oceanus","Oceanus","Merigrad","Oceanus",null,null,"Oceanus","Oceanus","Luminkind"],"in_degree_centrality":[400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"out_degree_centrality":[0,108,117,96,98,87,64,57,50,46,58,57,41,46,37,46,52,43,40,35,35,54,31,40,34,34,43,29,24,19,22,18,21,18,20,14,13,13,12,17,17,11,19,11,6,7,7,7,5,7,5,4,6,3,3,3,1,1,1,1,1],"degree_centrality":[400,108,117,96,98,87,64,57,50,46,58,57,41,46,37,46,52,43,40,35,35,54,31,40,34,34,43,29,24,19,22,18,21,18,20,14,13,13,12,17,17,11,19,11,6,7,7,7,5,7,5,4,6,3,3,3,1,1,1,1,1],"eigen_centrality":[1,0.506079666617843,0.460183430902252,0.554209254311229,0.44528429213011,0.307108629653742,0.322405903470676,0.300199088528637,0.329351108171994,0.323914548969599,0.256338039606934,0.214742113686044,0.268580836627804,0.238627508277461,0.280390574201113,0.213059741849585,0.183226876337697,0.205676577036492,0.217927630662034,0.224524194404989,0.201531423081136,0.11549267762166,0.197978542824751,0.14638562352806,0.165573214290342,0.149890588409804,0.103545511799624,0.153350168706746,0.1292226387638,0.154958122918133,0.129642520758976,0.145976887049605,0.112757621743321,0.122714364871097,0.108409025643124,0.15022249461782,0.146647363481023,0.13035440035115,0.116402584545104,0.0726041502895553,0.0681760252068941,0.078971172921881,0.0366160467291787,0.0516837167095074,0.0908106548248092,0.0769394183369525,0.0732504800293336,0.0652246180375183,0.0608475844058034,0.0318447947552434,0.0357428959742571,0.0342237472131506,0.0216738197025143,0.030277153908864,0.0208475585444463,0.0197634403900893,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682],"combined_centrality":[400,54.6566039947271,53.8414614155635,53.204088413878,43.6378606287508,26.7184507798756,20.6339778221233,17.1113480461323,16.4675554085997,14.9000692526016,14.8676062972021,12.2403004801045,11.01181430174,10.9768653807632,10.3744512454412,9.80074812508093,9.52779756956026,8.84409281256914,8.71710522648137,7.85834680417462,7.05359980783977,6.23660459156964,6.13733482756727,5.8554249411224,5.62948928587163,5.09628000593334,4.45245700738384,4.44715489249562,3.1013433303312,2.94420433544453,2.85213545669747,2.62758396689288,2.36791005660973,2.20885856767975,2.16818051286248,2.10311492464948,1.9064157252533,1.69460720456495,1.39683101454125,1.23427055492244,1.1589924285172,0.868682902140691,0.695704887854395,0.568520883804581,0.544863928948855,0.538575928358668,0.512753360205335,0.456572326262628,0.304237922029017,0.222913563286704,0.178714479871285,0.136894988852602,0.130042918215086,0.0908314617265921,0.0625426756333388,0.0592903211702678,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682,0.0151351091374682],"group":["transshipment","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels","vessels"],"community":["1","1","10","1","1","1","1","1","1","1","1","1","1","27","1","1","1","29","30","1","1","2","1","2","33","1","35","36","1","1","41","1","43","45","46","47","50","1","1","59","1","67","72","77","79","80","1","88","107","1","135","155","160","191","217","223","320","322","326","327","332"],"x":[0.0009521940661541,0.38140283570846,-0.0225151246686608,0.87105129494604,0.478239196356595,-0.634674904767633,0.331561240860211,-0.779213727860893,0.569451168354151,0.499065476492366,-0.614481529445623,-0.832041660251395,-0.427180744196685,0.165976174551399,0.151558594533092,-0.409450552779865,0.352199502894244,0.646651066165616,-0.977263643899086,-0.243199319720092,-0.473389620286433,0.743525894391336,0.834683133110291,0.465546568596045,-0.391598732947056,0.424695187293252,-0.0836892589775632,0.98452647860452,-0.64168735196134,-0.464409121347535,0.920407795418572,0.900271343533281,0.190658963112056,-0.771181524725111,-0.659482278615344,-0.929936332266476,-1,-0.358978521189871,0.119736116394169,0.80790968454193,-0.749823378739408,0.537878557574661,-0.172549879114153,0.675623354028448,-0.437746223525953,-0.231255113631141,-0.103737431802071,0.727295717562441,0.0560345840209542,0.343462138367269,-0.90695173191498,-0.0348225610264906,-0.843727350994794,0.690005861282389,-0.643867880872269,1,-0.269546671394843,0.238521558757901,-0.515527090475519,-0.0326050775752375,0.61364218044743],"y":[-0.00968281081467992,0.334895427548556,-0.680964585796929,0.468070973634576,0.0151022376701788,-0.784681552994947,0.94042861704259,-0.609405983332014,0.823637855662924,0.595667147917328,-0.454388487456231,0.164985948531084,0.117258014789399,0.640029289547036,-1,0.677697686420287,-0.918647940897264,0.427544658751674,-0.186814259063936,-0.749858454158732,0.885707679120995,0.658283567071108,-0.548285281032647,-0.268225578607679,0.41510486261565,-0.644020684528482,-0.41933745840429,-0.14786510140021,0.293256804550759,-0.661624720442949,-0.356963170806463,0.273587196192428,-0.7669727394654,-0.270031106935036,0.741048433409465,0.334653634290608,0.0468943311936287,-0.412313268298936,0.966416787746196,-0.0214705971365148,-0.0358387454928231,-0.844057511052885,0.578779537588294,0.181413033440263,-0.899958791516389,-0.984220150183504,1,-0.241082268635009,0.393533051823703,0.75285431875749,-0.430172464537348,-0.959489455294037,0.531185915787715,-0.706275885397217,0.539814702854827,0.101169485156031,0.889284998766705,-0.45267466439657,-0.16100250402857,0.783829022916577,-0.480970761910032]},"edges":{"from":[57,25,60,41,53,5,56,2,44,42,19,13,31,7,33,54,11,61,40,27,58,39,28,46,45,55,10,23,34,38,22,51,36,17,49,14,21,52,24,4,16,18,32,3,35,43,6,59,30,48,15,26,9,37,50,8,20,29,47,12],"to":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hscode":["306170","304620","306170","160414","306170","306170","306170","306170","306170","306170","306170","306170","160414","306170","306170","160414","160414","160414","160414","306170","306170","160414","306170","160414","160414","160414","306170","306170","306170","306170","160414","306170","306170","160414","160414","306170","306170","306170","160414","306170","306170","160414","306170","304620","306170","160414","160414","160414","306170","306170","306170","306170","306170","306170","304620","306170","306170","304620","304620","304620"],"Year":[2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034,2034],"weights":[16,20,12,25,13,34,15,87,52,14,162,12,118,25,11,14,178,26,54,28,12,28,19,31,61,18,86,30,29,30,108,13,20,20,56,53,21,60,29,108,14,14,16,40,13,143,127,42,18,54,25,38,58,71,14,27,642,40,42,66],"median_weight":[19452.5,22007.5,19905,19670,19255,20650,21620,18555,20655,21515,19827.5,18517.5,17100,20420,18300,19145,18865,20010,17365,20030,19530,19975,20975,18790,187850,21180,16990,18595,19260,19617.5,14405,21920,24775,18927.5,21482.5,19935,17620,17145,19055,21180,19075,19072.5,19677.5,24837.5,20665,20270,19900,49770,17705,22050,19920,19700,18170,15490,19290,17995,17010,24170,20330,24010]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"interaction":{"dragNodes":true,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["transshipment","vessels"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":{"text":"Network Graph ofMar del Este CJSC in 2034 ","style":"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;"},"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<section id="summary-of-the-changes-of-transshipment-leader-over-the-years" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-the-changes-of-transshipment-leader-over-the-years">4.7.1 Summary of the changes of transshipment leader over the years</h3>
<p>Below is the code chunk to find if there is any missing nodes or addition of new nodes over the different time period:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Diff 2028-2029 </span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all nodes in nodes_df_2028 are present in nodes_df_2029</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>missing_nodes_1 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2028<span class="sc">$</span>id, nodes_df_2029<span class="sc">$</span>id)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>missing_node_names_1 <span class="ot">&lt;-</span> nodes_df_2028<span class="sc">$</span>label[nodes_df_2028<span class="sc">$</span>id <span class="sc">%in%</span> missing_nodes_1]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify any new nodes in nodes_df_2029</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>new_nodes_1 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2029<span class="sc">$</span>id, nodes_df_2028<span class="sc">$</span>id)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>new_node_names_1 <span class="ot">&lt;-</span> nodes_df_2029<span class="sc">$</span>label[nodes_df_2029<span class="sc">$</span>id <span class="sc">%in%</span> new_nodes_1]</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the missing node names with a comma after each label found</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Missing nodes: ", paste(missing_node_names_1, collapse = ", "), "\n")</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the new node names with a comma after each label found</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("New nodes: ", paste(new_node_names_1, collapse = ", "), "\n")</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Diff 2029-2030</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all nodes in nodes_df_2020 are present in nodes_df_2030</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>missing_nodes_2 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2029<span class="sc">$</span>id, nodes_df_2030<span class="sc">$</span>id)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>missing_node_names_2 <span class="ot">&lt;-</span> nodes_df_2029<span class="sc">$</span>label[nodes_df_2029<span class="sc">$</span>id <span class="sc">%in%</span> missing_nodes_2]</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify any new nodes in nodes_df_2030</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>new_nodes_2 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2030<span class="sc">$</span>id, nodes_df_2029<span class="sc">$</span>id)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>new_node_names_2 <span class="ot">&lt;-</span> nodes_df_2030<span class="sc">$</span>label[nodes_df_2030<span class="sc">$</span>id <span class="sc">%in%</span> new_nodes_2]</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the missing node names with a comma after each label found</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Missing nodes: ", paste(missing_node_names_2, collapse = ", "), "\n")</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the new node names with a comma after each label found</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("New nodes: ", paste(new_node_names_2, collapse = ", "), "\n")</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Diff 2030-2031</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all nodes in nodes_df_2030 are present in nodes_df_2031</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>missing_nodes_3 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2030<span class="sc">$</span>id, nodes_df_2031<span class="sc">$</span>id)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>missing_node_names_3 <span class="ot">&lt;-</span> nodes_df_2030<span class="sc">$</span>label[nodes_df_2030<span class="sc">$</span>id <span class="sc">%in%</span> missing_nodes_3]</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify any new nodes in nodes_df_2031</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>new_nodes_3 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2031<span class="sc">$</span>id, nodes_df_2030<span class="sc">$</span>id)</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>new_node_names_3 <span class="ot">&lt;-</span> nodes_df_2031<span class="sc">$</span>label[nodes_df_2031<span class="sc">$</span>id <span class="sc">%in%</span> new_nodes_3]</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the missing node names with a comma after each label found</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Missing nodes: ", paste(missing_node_names_3, collapse = ", "), "\n")</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the new node names with a comma after each label found</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("New nodes: ", paste(new_node_names_3, collapse = ", "), "\n")</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Diff 2031-2032</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all nodes in nodes_df_2031 are present in nodes_df_2032</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>missing_nodes_4 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2031<span class="sc">$</span>id, nodes_df_2032<span class="sc">$</span>id)</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>missing_node_names_4 <span class="ot">&lt;-</span> nodes_df_2031<span class="sc">$</span>label[nodes_df_2031<span class="sc">$</span>id <span class="sc">%in%</span> missing_nodes_4]</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify any new nodes in nodes_df_2032</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>new_nodes_4 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2032<span class="sc">$</span>id, nodes_df_2031<span class="sc">$</span>id)</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>new_node_names_4 <span class="ot">&lt;-</span> nodes_df_2032<span class="sc">$</span>label[nodes_df_2032<span class="sc">$</span>id <span class="sc">%in%</span> new_nodes_4]</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the missing node names with a comma after each label found</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Missing nodes: ", paste(missing_node_names_4, collapse = ", "), "\n")</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the new node names with a comma after each label found</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("New nodes: ", paste(new_node_names_4, collapse = ", "), "\n")</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Diff 2033-2034</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all nodes in nodes_df_2033 are present in nodes_df_2034</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>missing_nodes_5 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2033<span class="sc">$</span>id, nodes_df_2034<span class="sc">$</span>id)</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>missing_node_names_5 <span class="ot">&lt;-</span> nodes_df_2033<span class="sc">$</span>label[nodes_df_2033<span class="sc">$</span>id <span class="sc">%in%</span> missing_nodes_5]</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify any new nodes in nodes_df_2034</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>new_nodes_5 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(nodes_df_2034<span class="sc">$</span>id, nodes_df_2033<span class="sc">$</span>id)</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the corresponding names for the missing nodes</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>new_node_names_5 <span class="ot">&lt;-</span> nodes_df_2034<span class="sc">$</span>label[nodes_df_2034<span class="sc">$</span>id <span class="sc">%in%</span> new_nodes_5]</span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the missing node names with a comma after each label found</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("Missing nodes: ", paste(missing_node_names_5, collapse = ", "), "\n")</span></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the new node names with a comma after each label found</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("New nodes: ", paste(new_node_names_5, collapse = ", "), "\n")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th>Year</th>
<th>Findings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2028 and 2029</td>
<td><p>6 Missing nodes:</p>
<ol type="1">
<li>Caracola Marina Lighthouse A/S Forwading</li>
<li>Seashell Seekers Ltd Distribution</li>
<li>Zanzibar Archipelago Incorporated International</li>
<li>Oceanfront Oasis AS Delivery</li>
<li>Playa del Sol Incorporated, Kallianassa Fish AG Solutions</li>
<li>TunaTime GmbH &amp; Co.&nbsp;KG Export.</li>
</ol></td>
</tr>
<tr class="even">
<td>2029 - 2030</td>
<td><p>5 New nodes:</p>
<ol type="1">
<li>Rift Valley fishery OJSC Enterprises</li>
<li>Aqua Azul Oyster BV Freight</li>
<li>suō yú Incorporated Seagull</li>
<li>bái suō wěn lú Ltd.&nbsp;Corporation Freight</li>
<li>Norwegian Fjord Plc Transit</li>
</ol></td>
</tr>
<tr class="odd">
<td>2030 - 2031</td>
<td><p>13 Missing nodes:</p>
<ol type="1">
<li>Barents Sea Shrimp Plc</li>
<li>Haryana Sea Marine ecology</li>
<li>Gambia River Ges.m.b.H. &amp;</li>
<li>Mar y Viento Ltd.&nbsp;Liability Co Captain</li>
<li>Gulf of Tadjoura Corp Shipping</li>
<li>Barco de Plata SE</li>
<li>Dutch Eel LLC Express</li>
<li>Icelandic Cod GmbH &amp; Co.&nbsp;KG Express</li>
<li>Rift Valley fishery OJSC Enterprises</li>
<li>Aqua Azul Oyster BV Freight</li>
<li>suō yú Incorporated Seagull</li>
<li>bái suō wěn lú Ltd.&nbsp;Corporation Freight</li>
<li>Norwegian Fjord Plc Transit</li>
</ol></td>
</tr>
<tr class="even">
<td>2031 - 2032</td>
<td><p>20 New nodes:</p>
<ol type="1">
<li>Isla del Tesoro SE Transport</li>
<li>Caracola del Este Incorporated</li>
<li>Spanish Anchovy OJSC International</li>
<li>SaltSea &amp; Inc Carriers</li>
<li>Mar de la Aventura Limited Liability Company</li>
<li>Mar de Cristalino OJSC</li>
<li>jīn qiāng yú Express</li>
<li>Mar y Viento Abalone N.V. Marine conservation</li>
<li>Playa de Coral Distribution Marine sanctuary</li>
<li>xiǎo xiā A/S Holdings</li>
<li>Marine Mates Pic Delivery</li>
<li>OceanKing s ship Pic Logistics</li>
<li>Lake Kariba GmbH &amp; Co.&nbsp;KG</li>
<li>Mar y Viento Ltd.&nbsp;Liability Co Captain</li>
<li>AquaBite Limited Liability Company Marine</li>
<li>SurfSide GmbH &amp; Co.&nbsp;KG Consulting</li>
<li>CoralCrest Limited Liability Company Seabass</li>
<li>Black Sea Anchovy NV</li>
<li>Mar del Oeste LLC Marine</li>
<li>Turkish Salmon LC Barracuda</li>
</ol></td>
</tr>
<tr class="odd">
<td>2032 - 2034</td>
<td><p>10 Missing nodes:</p>
<ol type="1">
<li>Ob River LLC and Son’s</li>
<li>Pez Dorado Inc Freight</li>
<li>Ola de la Costa Ges.m.b.H.</li>
<li>Marine Adventures Ltd Cod</li>
<li>Coral Reef Oyj Solutions</li>
<li>Estrella de Mar AB Delivery</li>
<li>Greek ermen Kga Freight</li>
<li>Black Sea Anchovy NV</li>
<li>Mar del Oeste LLC Marine</li>
<li>Ola del Este Ltd</li>
</ol></td>
</tr>
</tbody>
</table>
<p>Also, we can see from the networkgraph that in 2028, Marine Mates NV Worldwide and ReefRider Foods Lte Corporation Family supplies goods to Mar del Este CSJC but disappears in 2029. And in 2032, there are 2 new suppliers, The Salty Dog Limited Liability Company and Turkish Salmon A/S Marine, however, both disappeared in 2034.</p>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>5. References</h1>
<p>A. Petrossian,G., Barthuly,B.,C. Sosnowski,M.(2022).Identifying Central Carriers and Detecting Key Communities Within the Global Fish Transshipment Networks. Retrieved June 4, 2032, from <a href="https://www.frontiersin.org/articles/10.3389/fmars.2022.798893/full" class="uri">https://www.frontiersin.org/articles/10.3389/fmars.2022.798893/full</a></p>
<p>J. Park,A.,Z. Stamato,S.(2020).Social Network Analysis of Global Transshipment: A Framework for Discovering Illegal Fishing.</p>
<p>Datastorm(nd).visNetowork,an R package for an interactive network visualistion. Retrieved June 4, 2032, from <a href="https://datastorm-open.github.io/visNetwork/edges.html" class="uri">https://datastorm-open.github.io/visNetwork/edges.html</a></p>
<p><a href="https://tidygraph.data-imaginist.com/index.html%20https://ona-book.org/vertex-importance.html">https://tidygraph.data-imaginist.com/index.html https://ona-book.org/vertex-importance.html</a> <a href="https://ona-book.org/vertex-importance.html">6 Vertex Importance and Centrality | Handbook of Graphs and Networks in People Analytics (ona-book.org)</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Take-Home Exercise 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html" class="pagination-link">
        <span class="nav-page-text">Take-Home Exercise 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>