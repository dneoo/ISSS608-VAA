[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\nThis website is a collection of my coursework for the Visual Analytics courses taken during my MITB Journey.\nThere are 3 type of exercises:\n\nHands-on Exercise\nIn-Class Exercise\nTake-Home Exercise"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "The code chunk below uses p_load() of pacman package to check if tidyverse packages are installed in the computer. If they are, then they will be launched into R.\n\npacman::p_load(tidyverse)\n\n\n\n\n\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#plotting-a-simple-chart",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#plotting-a-simple-chart",
    "title": "Hands-on Exercise 1",
    "section": "Plotting a simple chart",
    "text": "Plotting a simple chart\n\nUsing geombar() to plot a bar chart\n\nggplot(data=exam_data, \n       aes(x=RACE)) +\n  geom_bar()\n\n\n\n\n\n\nUsing geom_dotplot() to plot a dot plot\n\nggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot(binwidth=2.5,         \n               dotsize = 0.5) +      \n  scale_y_continuous(NULL,           \n                     breaks = NULL)\n\n\n\n\n\n\nUsing geom_histogram() to create a histogram\n\nggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_histogram() \n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#working-with-theme",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#working-with-theme",
    "title": "Hands-on Exercise 1",
    "section": "Working with Theme",
    "text": "Working with Theme\n\nChanging theme of bar chart\n\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar() +\n  coord_flip() +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"lightblue\", colour = \"lightblue\", \n                                    size = 0.5, linetype = \"solid\"),\n    panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = \"white\"), \n    panel.grid.minor = element_line(size = 0.25, linetype = 'solid', colour = \"white\"))\n\nWarning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n\n\nWarning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#designing-data-driven-graphics-for-analysis",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#designing-data-driven-graphics-for-analysis",
    "title": "Hands-on Exercise 1",
    "section": "Designing Data-driven Graphics for Analysis",
    "text": "Designing Data-driven Graphics for Analysis\n\nExercise 1\n\nggplot(data=exam_data, \n       aes(x=reorder(RACE,RACE,\n                     function(x)-length(x)))) +\n  geom_bar() +\n  ylim(0,220) +\n  geom_text(stat=\"count\", \n      aes(label=paste0(..count.., \", \", \n      round(..count../sum(..count..)*100, 1), \"%\")),\n      vjust=-1) +\n  xlab(\"Race\") +\n  ylab(\"No. of\\nPupils\") +\n  theme(axis.title.y=element_text(angle = 0))\n\nWarning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(count)` instead.\n\n\n\n\n\n\n\nExercise 2 : Adding mean and median lines\n\nggplot(data=exam_data, \n       aes(x= MATHS)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  geom_vline(aes(xintercept=mean(MATHS, na.rm=T)),\n             color=\"red\", \n             linetype=\"dashed\", \n             size=1) +\n  geom_vline(aes(xintercept=median(MATHS, na.rm=T)),\n             color=\"grey30\",\n             linetype=\"dashed\", \n             size=1)\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\nExercise 3: Distribution of English scores for all pupils\n\nd <- exam_data   \nd_bg <- d[, -3]  \n\nggplot(d, aes(x = ENGLISH, fill = GENDER)) +\n  geom_histogram(data = d_bg, fill = \"grey\", alpha = .5) +\n  geom_histogram(colour = \"black\") +\n  facet_wrap(~ GENDER) +\n  guides(fill = FALSE) +  \n  theme_bw()\n\nWarning: The `<scale>` argument of `guides()` cannot be `FALSE`. Use \"none\" instead as\nof ggplot2 3.3.4.\n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\nExercise 4\n\nggplot(data=exam_data, \n       aes(x=MATHS, y=ENGLISH)) +\n  geom_point() +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  geom_hline(yintercept=50,\n             linetype=\"dashed\",\n             color=\"grey60\",\n             size=1) + \n  geom_vline(xintercept=50, \n             linetype=\"dashed\",\n             color=\"grey60\",\n             size=1)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "",
    "text": "The code chunck below will be used to check if these packages have been installed and also will load them onto your working R environment.\n\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse) \n\n\n\n\n\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#working-with-ggrepel",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#working-with-ggrepel",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "2.1 Working with ggrepel",
    "text": "2.1 Working with ggrepel\nggrepel helps to repel overlapping text\n\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label(aes(label = ID), \n             hjust = .5, \n             vjust = -.5) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nSimply replace geom_text() by geom_text_repel() and geom_label() by geom_label_repel.\n\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label_repel(aes(label = ID), \n                   fontface = \"bold\") +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: ggrepel: 317 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#working-with-themes",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#working-with-themes",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "2.2 Working with Themes",
    "text": "2.2 Working with Themes\n8 Built-in Themes: theme_gray(), theme_bw(), theme_classic(), theme_dark(), theme_light(), theme_linedraw(), theme_minimal(), and theme_void()\n\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  theme_gray() +\n  ggtitle(\"Distribution of Maths scores\")\n\n\n\n\n\nUsing ggtheme package\nIn the example below, The Economist theme is used.\n\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_economist()\n\n\n\n\n\n\nUsing hrbthems package\nProvides a base theme that focuses on typographic elements, including where various labels are placed and fonts used.\n\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  theme_ipsum(axis_title_size = 18,       #increase font size of axis title to 18 \n              base_size = 15,             #increase default axis label to 15\n              grid = \"Y\") +               # keep only y-axis grid lines\n  ggtitle(\"Distribution of Maths scores\")\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not\nfound in Windows font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not\nfound in Windows font database\n\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\n\nWarning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\nfont family not found in Windows font database\n\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#beyond-single-graph",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#beyond-single-graph",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "2.3 Beyond Single Graph",
    "text": "2.3 Beyond Single Graph\nCreate composite plot by combining multiple graphs First, create the three statistical graphics below\n\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, \n                 y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n\n\nWorking with patchwork\nCreating patchwork Use ‘+’ to create two columns layout Use ‘/’ to create two row layout (stack) Use ‘()’ to create subplot group Use ‘|’ to place the plots beside each other\n\n((p1 / p2) | p3) + \n  plot_annotation(tag_levels = 'I')   #creating a composite figure with tag\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nCombining patchwork and themes\n\n((p1 / p2) | p3) & theme_economist()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nInsert another plot in a plot with inset_element()\n\np3 + inset_element(p2, \n                   left = 0.02, \n                   bottom = 0.7, \n                   right = 0.5, \n                   top = 1)\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html",
    "href": "Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html",
    "title": "Hands-on Exercise 3",
    "section": "",
    "text": "The code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:\n\nggiraph, for making ‘ggplot’ graphics interactive.\nplotly, R library for plotting interactive statistical graphs.\ngganimate, an ggplot extension for creating animated statistical graphs.\nDT, provides an R interface to the JavaScript library DataTablesthat create interactive table on html page.\ntidyverse, a family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.\npatchwork, for combining multiple plots into one figure.\ngifski , converts video frames to GIF animations using pngquant’s fancy features for efficient cross-frame palettes and temporal dithering. It produces animated GIFs that use thousands of colors per frame.\ngapminder, an excerpt of the data available at Gapminder.org. We just want to use its country_colors scheme.\n\n\npacman::p_load(ggiraph, plotly, \n               patchwork, DT, tidyverse)\n\n\n\n\n\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html#using-ggiraph-for-interactive-data-visualisation",
    "href": "Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html#using-ggiraph-for-interactive-data-visualisation",
    "title": "Hands-on Exercise 3",
    "section": "2.1 Using ggiraph for interactive data visualisation",
    "text": "2.1 Using ggiraph for interactive data visualisation\nggiraph is an htmlwidget and a ggplot2 extension. It allows ggplot graphics to be interactive. The interactivity is made with ggplot geometries that can understand three arguments:\n\nTooltip: a column of data-sets that contain tooltips to be displayed when the mouse is over elements.\nData_id: a column of data-sets that contain an id to be associated with elements.\nOnclick: a column of data-sets that contain a JavaScript function to be executed when elements are clicked.\n\nIf it is used within a shiny application, elements associated with an id (data_id) can be selected and manipulated on client and server sides.\n\n2.1.1 Using tooltip (tooltip effect)\nThere are two parts of the codes: 1. creating ggplot object, 2. girafe() of ggiraph will be used to create an interactive svg object.\n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  #geom_dotplot_interactive still takes argument of original geom_dotplot but with tooltip enabled in aes()\n  geom_dotplot_interactive(\n    aes(tooltip = ID),\n    stackgroups = TRUE, \n    binwidth = 1, \n    method = \"histodot\") +\n  scale_y_continuous(NULL, \n                     breaks = NULL)\ngirafe(\n  ggobj = p,\n  width_svg = 6,\n  height_svg = 6*0.618\n)\n\n\n\n\n\n\n\n\n\n\n\nInteractivity\n\n\n\nBy hovering the mouse pointer on an data point of interest, the student’s ID will be displayed.\n\n\n\n\n2.1.2 Displaying multiple information on tooltip\n\n# Create a new field called tooltip\nexam_data$tooltip <- c(paste0(     \n  \"Name = \", exam_data$ID,         \n  \"\\n Class = \", exam_data$CLASS)) \n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(\n    aes(tooltip = exam_data$tooltip), \n    stackgroups = TRUE,\n    binwidth = 1,\n    method = \"histodot\") +\n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(\n  ggobj = p,\n  width_svg = 8,\n  height_svg = 8*0.618\n)\n\n\n\n\n\n\n\n\n\n\n\nInteractivity\n\n\n\nBy hovering the mouse pointer on an data point of interest, the student’s ID and Class will be displayed.\n\n\n\n\n2.1.3 Customising Tooltip style\nUsing opts_tooltip() of ggiraph to customize tooltip rendering by adding css declarations.\n\ntooltip_css <- \"background-color:white; #<<\nfont-style:bold; color:blue;\" #<<\n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(              \n    aes(tooltip = ID),                   \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618,\n  options = list(    #<<\n    opts_tooltip(    #<<\n      css = tooltip_css)) #<<\n)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nBackground colour of the tooltip is now white and the font colour is blue and bold\n\n\n\n\n2.1.4 Displaying statistics on tooltip"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html",
    "href": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html",
    "title": "Hands-on Ex 5: Network Data Visualisation and Analysis",
    "section": "",
    "text": "pacman::p_load(igraph, tidygraph, ggraph,visNetwork, lubridate, clock,\n               tidyverse, graphlayouts)\n\n\n\n\n\nGAStech_nodes <- read_csv(\"data/GAStech_email_node.csv\")\nGAStech_edges <- read_csv(\"data/GAStech_email_edge-v2.csv\")\n\n\n\n\n\nglimpse(GAStech_edges)\n\nRows: 9,063\nColumns: 8\n$ source      <dbl> 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…\n$ target      <dbl> 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…\n$ SentDate    <chr> \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\"…\n$ SentTime    <time> 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…\n$ Subject     <chr> \"GT-SeismicProcessorPro Bug Report\", \"GT-SeismicProcessorP…\n$ MainSubject <chr> \"Work related\", \"Work related\", \"Work related\", \"Work rela…\n$ sourceLabel <chr> \"Sven.Flecha\", \"Sven.Flecha\", \"Kanon.Herrero\", \"Kanon.Herr…\n$ targetLabel <chr> \"Isak.Baza\", \"Lucas.Alcazar\", \"Felix.Resumir\", \"Hideki.Coc…\n\n\n\n\n\n\nGAStech_edges <- GAStech_edges %>%\n  mutate(SendDate = dmy(SentDate)) %>%\n  mutate(Weekday = wday(SentDate,\n                        label = TRUE,\n                        abbr = FALSE))\nglimpse(GAStech_edges)\n\nRows: 9,063\nColumns: 10\n$ source      <dbl> 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…\n$ target      <dbl> 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…\n$ SentDate    <chr> \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\"…\n$ SentTime    <time> 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…\n$ Subject     <chr> \"GT-SeismicProcessorPro Bug Report\", \"GT-SeismicProcessorP…\n$ MainSubject <chr> \"Work related\", \"Work related\", \"Work related\", \"Work rela…\n$ sourceLabel <chr> \"Sven.Flecha\", \"Sven.Flecha\", \"Kanon.Herrero\", \"Kanon.Herr…\n$ targetLabel <chr> \"Isak.Baza\", \"Lucas.Alcazar\", \"Felix.Resumir\", \"Hideki.Coc…\n$ SendDate    <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-0…\n$ Weekday     <ord> Friday, Friday, Friday, Friday, Friday, Friday, Friday, Fr…\n\n\n\n\n\nGAStech_edges data.frame consists of individual email flow records, which is not useful for visualisation.\nThus, we will aggregate the individual by date,senders, receivers, main subject and day of the week.\n\nGAStech_edges_aggregated <- GAStech_edges %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(source, target, Weekday) %>%\n  summarise(Weight = n()) %>%\n  filter(source!=target) %>%    #only want those that you sent to others, dont want those u cc yourself\n  filter(Weight > 1) %>%         #only want those you sent out more than 1\n  ungroup()\n\nGAStech_edges_aggregated\n\n# A tibble: 1,372 × 4\n   source target Weekday   Weight\n    <dbl>  <dbl> <ord>      <int>\n 1      1      2 Sunday         5\n 2      1      2 Monday         2\n 3      1      2 Tuesday        3\n 4      1      2 Wednesday      4\n 5      1      2 Friday         6\n 6      1      3 Sunday         5\n 7      1      3 Monday         2\n 8      1      3 Tuesday        3\n 9      1      3 Wednesday      4\n10      1      3 Friday         6\n# ℹ 1,362 more rows"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#using-tbl_graph-to-build-tidygraph-data-model",
    "href": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#using-tbl_graph-to-build-tidygraph-data-model",
    "title": "Hands-on Ex 5: Network Data Visualisation and Analysis",
    "section": "Using tbl_graph() to build tidygraph data model",
    "text": "Using tbl_graph() to build tidygraph data model\n\nGAStech_graph <- tbl_graph(nodes = GAStech_nodes,\n                           edges = GAStech_edges_aggregated, \n                           directed = TRUE)\nGAStech_graph\n\n# A tbl_graph: 54 nodes and 1372 edges\n#\n# A directed multigraph with 1 component\n#\n# A tibble: 54 × 4\n     id label               Department     Title                                \n  <dbl> <chr>               <chr>          <chr>                                \n1     1 Mat.Bramar          Administration Assistant to CEO                     \n2     2 Anda.Ribera         Administration Assistant to CFO                     \n3     3 Rachel.Pantanal     Administration Assistant to CIO                     \n4     4 Linda.Lagos         Administration Assistant to COO                     \n5     5 Ruscella.Mies.Haber Administration Assistant to Engineering Group Manag…\n6     6 Carla.Forluniau     Administration Assistant to IT Group Manager        \n# ℹ 48 more rows\n#\n# A tibble: 1,372 × 4\n   from    to Weekday Weight\n  <int> <int> <ord>    <int>\n1     1     2 Sunday       5\n2     1     2 Monday       2\n3     1     2 Tuesday      3\n# ℹ 1,369 more rows"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#plotting-a-basic-network-graph",
    "href": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#plotting-a-basic-network-graph",
    "title": "Hands-on Ex 5: Network Data Visualisation and Analysis",
    "section": "3.1 Plotting a basic network graph",
    "text": "3.1 Plotting a basic network graph\n\nggraph(GAStech_graph) +\n  geom_edge_link() +\n  geom_node_point()\n\n\n\n\n\n3.1.2 Changing the default network graph theme\n\ng <- ggraph(GAStech_graph) + \n  geom_edge_link(aes()) +\n  geom_node_point(aes())\n\ng + theme_graph()\n\n\n\n\n\n\n3.1.3 Changing the color of the plot\n\ng <- ggraph(GAStech_graph) + \n  geom_edge_link(aes(colour = 'grey50')) +\n  geom_node_point(aes(colour = 'grey40'))\n\ng + theme_graph(background = 'grey10',\n                text_colour = 'white')\n\n\n\n\n\n\n3.1.4 Modifying network nodes\nIn this section, you will color each node by referring to their respective departments.\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes()) +\n  geom_node_point(aes(colour = Department, \n                      size = 3))\n\ng + theme_graph()\n\n\n\n\n\n\n3.1.5 Modifying edges\nHere, the code chunck below shows how the thickness of the edges will be mapped with the Weight variable. (Thin line means not much interaction with one another)\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") +\n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 3)\n\ng + theme_graph()\n\n\n\n\n\n\n3.1.6 Creating facet graphs\n\nset_graph_style()\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2)\n\ng + facet_edges(~Weekday)\n\n\n\n\nAs shown above, we can see that weekdays there are interactions, but Saturday there are no links, meaning not much interaction with others."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#network-metrics-analysis",
    "href": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#network-metrics-analysis",
    "title": "Hands-on Ex 5: Network Data Visualisation and Analysis",
    "section": "3.2 Network Metrics Analysis",
    "text": "3.2 Network Metrics Analysis\n\n3.2.1 Computing centrality indices\n\ng <- GAStech_graph %>%\n  mutate(betweenness_centrality = centrality_betweenness()) %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department,\n            size=betweenness_centrality))\ng + theme_graph()\n\n\n\n\n\n\n3.2.2 Visualising Community\n\ng <- GAStech_graph %>%\n  mutate(community = as.factor(group_edge_betweenness(weights = Weight, directed = TRUE))) %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = community))  \n\ng + theme_graph()"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#building-interactive-network-graph-with-visnetwork",
    "href": "Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html#building-interactive-network-graph-with-visnetwork",
    "title": "Hands-on Ex 5: Network Data Visualisation and Analysis",
    "section": "3.3 Building Interactive Network Graph with visNetwork",
    "text": "3.3 Building Interactive Network Graph with visNetwork\nBefore we plot the interactive network graph, we need to prepare the data model using the code chunk below.\n\nGAStech_edges_aggregated <- GAStech_edges %>%\n  left_join(GAStech_nodes, by = c(\"sourceLabel\" = \"label\")) %>%\n  rename(from = id) %>%\n  left_join(GAStech_nodes, by = c(\"targetLabel\" = \"label\")) %>%\n  rename(to = id) %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(from, to) %>%\n    summarise(weight = n()) %>%\n  filter(from!=to) %>%\n  filter(weight > 1) %>%\n  ungroup()\n\nPlotting the first interactive network graph\n\nvisNetwork(GAStech_nodes, \n           GAStech_edges_aggregated)\n\n\n\n\n\n\n3.3.1 Working with visual attributes - Nodes\nRename Department field to group\n\nGAStech_nodes <- GAStech_nodes %>%\n  rename(group = Department) \n\nWhen we rerun the code chunk below, visNetwork shades the nodes by assigning unique colour to each category in the group field.\n\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-On_Ex07.html",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-On_Ex07.html",
    "title": "In-class Exercise 7",
    "section": "",
    "text": "1. Getting Started\nBefore getting start, make sure that ggHoriPlot has been included in the pacman::p_load(...) statement above.\n\npacman::p_load(ggHoriPlot, ggthemes, tidyverse, lubridate)\n\n\n\n2. Importing the Data\n\naverp <- read_csv(\"data/AVERP.csv\") \n\nRows: 7452 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Date, Consumer Items\ndbl (1): Values\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n3. Data Wrangling\n\naverp <- averp %>%\n  mutate(`Date` = dmy(`Date`))\n\n\n\n4. Plotting the Horizon graph\n\naverp %>% \n  filter(Date >= \"2018-01-01\") %>%\n  ggplot() +\n  geom_horizon(aes(x = Date, y=Values), \n               origin = \"midpoint\", \n               horizonscale = 6)+\n  facet_grid(`Consumer Items`~.) +\n    theme_few() +\n  scale_fill_hcl(palette = 'RdBu') +\n  theme(panel.spacing.y=unit(0, \"lines\"), strip.text.y = element_text(\n    size = 5, angle = 0, hjust = 0),\n    legend.position = 'none',\n    axis.text.y = element_blank(),\n    axis.text.x = element_text(size=7),\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.border = element_blank()\n    ) +\n    scale_x_date(expand=c(0,0), date_breaks = \"3 month\", date_labels = \"%b%y\") +\n  ggtitle('Average Retail Prices of Selected Consumer Items (Jan 2018 to Dec 2022)')\n\nWarning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` in the `default_aes` field and elsewhere instead."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex04/In-class_Ex04.html",
    "href": "In-class_Ex/In-class_Ex04/In-class_Ex04.html",
    "title": "In-Class Exercise 4",
    "section": "",
    "text": "pacman::p_load(rstatix,gt,patchwork,tidyverse,ggstatsplot,ggpubr)\n\n\n\n\n\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\n\n\n\n\n\n\n\nThe plotThe code chunk\n\n\n\n\n\n\n\n\n\n\nggplot(exam_data,\n       aes(sample=ENGLISH))+\n  stat_qq() +\n  stat_qq_line()\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nWe can see that the points deviate significantly from the straight diagonal line. This is a clear indication that the set of data is not normally distributed.\n\n\n\n\n\n\nThe plotThe code chunk\n\n\n\n\n\n\n\n\n\n\nggplot(exam_data,\n       aes(sample=ENGLISH))+\n  stat_qq() +\n  stat_qq_line()"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In_class_Ex05_MC1.html",
    "href": "In-class_Ex/In-class_Ex05/In_class_Ex05_MC1.html",
    "title": "Jsonlite",
    "section": "",
    "text": "pacman::p_load(jsonlite,tidygraph,ggraph,visNetwork,tidyverse)\n\n\nMC1 <- jsonlite::fromJSON(\"data/MC1.json\")\n\n\n#Extract id, type and country and make it as a tibble database. use select to choose the fields you want and reorganise the data as you want\nMC1_nodes <- as_tibble(MC1$nodes) %>%\n  select(id, type, country)\n\n\nMC1_edges <- as_tibble(MC1$links) %>%\n  select(source, target, type, weight, key)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Visual Analytics and Application Learning Journey",
    "section": "",
    "text": "Welcome to ISSS608 Visual Analytics and Applications.\nIn this website, you will find my coursework prepared for this course.\nHope you enjoy reading them!\nMost Recent Submissions…\n\n\n\n\n\n\n\n\n\n\n\nIn-class Exercise 7\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTake Home_Ex02\n\n\n\n\n\n\nDabbie Neo\n\n\nJun 4, 2023\n\n\n\n\n\n\n\n\n\n\n\nTake Home_Ex03\n\n\n\n\n\n\nDabbie Neo\n\n\nJun 3, 2023\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html",
    "title": "Take-Home_Ex01",
    "section": "",
    "text": "This exercise aims to discover the demographic, financial characteristics and hidden patterns of the City of Engagement, using static and interactive statistical graphics methods. The data will be processed using appropriate tidyverse packages and visualization will be designed using ggplot2 and its extensions."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#install-and-launching-r-packages",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#install-and-launching-r-packages",
    "title": "Take-Home_Ex01",
    "section": "3.1 Install and launching R packages",
    "text": "3.1 Install and launching R packages\nThe code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:\n\nplotly: R library for plotting interactive statistical graphs.\nggstatsplot: Used for creating graphics with details from statistical tests.\ngganimate: an ggplot extension for creating animated statistical graphs.\ngifski: converts video frames to GIF animations using pngquant’s fancy features for efficient cross-frame palettes and temporal dithering. It produces animated GIFs that use thousands of colors per frame.\nknitr: Used for dynamic report generation\npatchwork: Used to combine plots\nggdist: Used for visualization distribution and uncertainty\nggthemes: Provide additional themes for ggplot2\nggrepel: A package in R used for avoiding overplotting of text labels\ngt:For creating and styling publication-quality tables in R\nrstatix: Used for statistical analysis and data visualization\nggridges: For creating ridge plots\nviridis: An R package that provides a set of color palettes for data visualization\nggiraph: For making ‘ggplot’ graphics interactive\nreshape2: Provides functions for transforming and reshaping data between “wide” and “long” formats\nscales: Provides a set of functions for formatting and labeling data for visualization\ntidyverse: A family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.\n\n\npacman::p_load(plotly, ggstatsplot, knitr, patchwork, ggdist, ggthemes,ggrepel, tidyverse,gt,rstatix,ggpmisc,ggridges,gganimate,viridis,ggiraph,reshape2,scales, performance,ggalt,ggpubr,crosstalk, ungeviz, ggdist, colorspace)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#importing-the-data",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#importing-the-data",
    "title": "Take-Home_Ex01",
    "section": "3.2 Importing the Data",
    "text": "3.2 Importing the Data\n\nparticipants <- read_csv(\"data/Participants.csv\")\nfinancial <- read_csv(\"data/FinancialJournal.csv\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#data-wrangling",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#data-wrangling",
    "title": "Take-Home_Ex01",
    "section": "3.3 Data Wrangling",
    "text": "3.3 Data Wrangling\n\n3.3.1 Check for missing values in each column in the participants and financial data\n\n# Check for missing values in each column in participants data\ncolSums(is.na(participants))\n\n participantId  householdSize       haveKids            age educationLevel \n             0              0              0              0              0 \n interestGroup      joviality \n             0              0 \n\n# Check for missing values in each column\ncolSums(is.na(financial))\n\nparticipantId     timestamp      category        amount \n            0             0             0             0 \n\n\n\n\n3.3.2 Data Issues\nUsing glimpse(), we can look at the data types of the datasets.\n\nglimpse(participants)\n\nRows: 1,011\nColumns: 7\n$ participantId  <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…\n$ householdSize  <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…\n$ haveKids       <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…\n$ age            <dbl> 36, 25, 35, 21, 43, 32, 26, 27, 20, 35, 48, 27, 34, 18,…\n$ educationLevel <chr> \"HighSchoolOrCollege\", \"HighSchoolOrCollege\", \"HighScho…\n$ interestGroup  <chr> \"H\", \"B\", \"A\", \"I\", \"H\", \"D\", \"I\", \"A\", \"G\", \"D\", \"D\", …\n$ joviality      <dbl> 0.001626703, 0.328086500, 0.393469590, 0.138063446, 0.8…\n\n\n\nglimpse(financial)\n\nRows: 1,513,636\nColumns: 4\n$ participantId <dbl> 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6,…\n$ timestamp     <dttm> 2022-03-01, 2022-03-01, 2022-03-01, 2022-03-01, 2022-03…\n$ category      <chr> \"Wage\", \"Shelter\", \"Education\", \"Wage\", \"Shelter\", \"Educ…\n$ amount        <dbl> 2472.50756, -554.98862, -38.00538, 2046.56221, -554.9886…\n\n\nISSUE 1: WRONG DATA FORMAT\nparticipantId is in <dbl> format. It needs to be converted to <chr>.\n\nparticipants$participantId <- as.character(participants$participantId)\n#str(participants)--> to check if data type has been changed\n\nfinancial$participantId <- as.character(financial$participantId)\n#str(financial) --> to check if data type has been changed\n\nISSUE 2: CHANGE TIMESTAMP TO MONTH_YEAR FORMAT\nExtract the month and year using lubridate.\n\nfinancial$month_year <- floor_date(as.POSIXct(financial$timestamp), unit = \"month\")\nfinancial$month_year <- format(financial$month_year, format = \"%m/%Y\")\n\n# Convert month_year to date format\nfinancial$month_year <- as.Date(paste0(\"01/\", financial$month_year), format = \"%d/%m/%Y\")\n\n#head(financial) --> check if new col month_year is created \n\nISSUE 3: DUPLICATES FOUND IN DATA\nCheck for duplicates in both dataset using the following code chunk,\n\n#Check for duplicates in financial table\nsum(duplicated(financial))\n\n[1] 1113\n\n#Check for duplicates in participants table\nsum(duplicated(participants))\n\n[1] 0\n\n#Remove duplicates in financial table\nfinancial_unique <- distinct(financial)\nnrow(financial_unique)\n\n[1] 1512523\n\n\nISSUE 4: DATA IS SEGREGATED BY INDIVDUAL ENTRIES\nGroup the entries by participants taking into consideration month_year and category and summing up the amount.\n\n# Group by participant_id and month_year, subgroup by category, then summarize by amount\nnew_financial <- financial_unique %>%\n  group_by(participantId, month_year, category) %>%\n  summarise(total_amount = sum(amount)) %>%\n  mutate(total_amount = round(total_amount, 2))\n\n# Pivot the table so that the categories appear as columns\nnew_financial_wide <- new_financial %>% \n  pivot_wider(names_from = category, values_from = total_amount)\n\nNext, check if columns have missing value, if yes, replace the missing values with 0\n\n# Check if any columns has missing value \ncolSums(is.na(new_financial_wide))\n\n participantId     month_year      Education           Food     Recreation \n             0              0           7673              0           1199 \n       Shelter           Wage RentAdjustment \n           131              0          10619 \n\n# replace missing values with 0\nnew_financial_wide <- new_financial_wide %>% \n  mutate_all(~replace_na(., 0))\n\nISSUE 5: DATA DOES NOT SHOW FINANCIAL HEALTH AND COST OF LIVING\nFinancial Health = Sum (Wage + Education + Shelter + Recreation + Food + RentAdjustment)\n\nnew_financial_wide$Financial_health <- rowSums(new_financial_wide[, c(\"Wage\", \"Education\",\"Shelter\",\"Recreation\",\"Food\",\"RentAdjustment\" )], na.rm = TRUE)\n\nCost_of_living = Sum(Education + Shelter + Recreation + Food)\n\nnew_financial_wide$Cost_of_living <- rowSums(new_financial_wide[,c(\"Education\",\"Shelter\",\"Recreation\",\"Food\")], na.rm = TRUE)\nnew_financial_wide$Cost_of_living <- new_financial_wide$Cost_of_living * -1\n\nISSUE 6: AGE DATA ARE NOT AGGREGATED\nBin age data by groups of 10.\n\nparticipants <- participants %>%\n  mutate(age_bin = cut(age, \n                       breaks = c(seq(max(age), min(age) - 10, -10), min(age)), \n                       right = FALSE, \n                       include.lowest = TRUE, \n                       labels = NULL))\n\n# Replace the numeric bin labels with age ranges\nparticipants$age_bin <- sub(\"(\\\\d+)-(\\\\d+)\", \"\\\\1-\\\\2\", as.character(participants$age_bin))\nparticipants$age_bin[participants$age_bin == paste0(max(participants$age_bin), \"-\")] <- paste0(\"<= \", max(as.numeric(levels(participants$age_bin)))-1)\n\n# Display the first 10 rows of the new data frame with age_bin column\n#head(participants, 10)\n\nISSUE 7: PARTICIPANTS DATA AND FINANCIAL DATA ARE SEPARATED\nCombine the two tables together by participantId\n\ncombined_table <- merge(participants, new_financial_wide, by = \"participantId\")\nDT::datatable(combined_table, class= \"compact\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#demographic-analysis",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#demographic-analysis",
    "title": "Take-Home_Ex01",
    "section": "4.1 Demographic Analysis",
    "text": "4.1 Demographic Analysis\n\n4.1.1 Distribution of Income and Age\n\nDistribution of Income\nWe will first take a look at the Income Distribution using histogram and boxplot.\nBased on the boxplot plotted, we can observe that the minimum income is $1600, which means that all the participants are considering under the working population and we can analyse them as a whole.\nFurthermore, we can observe from the shape of the wage distribution that there is income inequality in the city. It has a right-skewed distribution, i.e. mean wage > median wage, where there is very few high earners at the top and majority falls under the middle and bottom.\n\n\nShow the code\n#computing summary statistics of mean, median and lower and upper whiskers in boxplot\nwage_mean <- round(mean(combined_table$Wage))\nwage_median <- round(median(combined_table$Wage))\nymax <- as.numeric(round((IQR(combined_table$Wage)*1.5) +\n                quantile(combined_table$Wage,0.75)))\nymin <- as.integer(min(combined_table$Wage))\n\n#plotting histogram\nh_wage <- ggplot(data = combined_table, aes(x = Wage)) + \n  geom_histogram(color=\"black\", fill=\"azure4\", binwidth = 500) + \n  scale_x_continuous(limits = c(0,25000), labels = scales::comma) +\n  labs(x = \"Wage\", y = \"Number of participants\") +\n  geom_vline(aes(xintercept = wage_mean), col=\"darkblue\", linewidth=0.75) +\n  annotate(\"text\", x=5900, y=1700, label=\"Mean wage:\", \n           size=3, color=\"darkblue\") +\n  annotate(\"text\", x=5600, y=1550, label=format(wage_mean, big.mark = \",\"),\n           size=3, color=\"darkblue\") +\n  geom_vline(aes(xintercept = wage_median), col=\"lightpink4\", linewidth=0.75) +\n  annotate(\"text\", x=1900, y=1700, label=\"Median wage\", \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=1900, y=1600, label=format(wage_median, big.mark = \",\"),\n           size=3, color=\"lightpink4\") +\n  theme(axis.text.x = element_text(size=8))\n\n#plotting boxplot\nb_wage <- ggplot(data = combined_table, aes(y = Wage)) + \n  geom_boxplot(outlier.colour=\"firebrick\", outlier.shape=16,\n               outlier.size=0.6, notch=FALSE, width = 0.25) + \n  coord_flip() + labs(y = \"\", x = \"\") + \n  scale_y_continuous(limits = c(0,25000), labels = scales::comma) +\n  theme(axis.text = element_blank(), axis.ticks = element_blank()) + \n  stat_boxplot(geom=\"errorbar\", width=0.25) + \n  annotate(\"text\", x=0.20, y=ymax, label=format(ymax, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=0.20, y=ymin, label=format(ymin, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=-0.25, y=5000, label=format(wage_median, big.mark = \",\"),\n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=-0.25, y=2500, label=\"Median wage =\",\n           size=3, color=\"lightpink4\")\n\n# combine the 2 plots \n\nwage_distri <- b_wage / h_wage + plot_layout(heights = c(1, 2)) \n\nwage_distri + plot_annotation(title = \"Distribution of Wage\", \n                               subtitle = str_wrap(\"There is a right-skewed distribution i.e. mean wage > median wage. There is also a large number of outliers (wage >$9,110).\", width =60),\n                               theme = theme(\n                                 plot.title = element_text(size = 18),\n                                 plot.subtitle = element_text(size = 12)))\n\n\n\n\n\nTo confirm that the wage distribution is indeed not normally distributed, we will perform the normality assumption test. But before performing the normality assumption test, we will first create the meanwage_table as shown in the code chunk below,\n\n# Create mean wage table \nmeanwage_table <- combined_table %>%\n  group_by(participantId) %>%\n  summarize(mean_wage = mean(Wage))\n#head(meanwage_table)\n\nNext, we will use the Q-Q Plot to visualize if normal distribution exist.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nqq <- ggplot(meanwage_table,\n       aes(sample=mean_wage))+\n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"Normal Q-Q Plot of Income\")\n\nsw_t <- meanwage_table %>%\n  shapiro_test(mean_wage) %>%\n  gt() #make it to gt format to give a nice table\n\ntmp <- tempfile(fileext = '.png')\ngtsave(sw_t, tmp)\ntable_png <- png::readPNG(tmp,native=TRUE) #sw_t cant be recognised by patchwork so change it to png\n\nqq + table_png\n\n\n\n\n\nLooking at Normal Quartile Plot (Q-Q plot), we can see that the points deviate significantly from the straight diagonal line. The results of the Shaprio-test above also suggest that there is sufficient statistical evidence to reject the null hypothesis at 95% confidence. Thus, the set of data is indeed not normally distributed, showing that the city has income inequality.\n\n\nDistribution of Age\nSimilarly, we will use histogram and boxplot to show the age distribution.\nThe boxplot below shows that the minimum age is 18 and the maximum age is 60, which is most likely the retirement age. The histogram shows that the age is normally distributed,where the mean age equals the median age of 39. Thus, it appears that the city of engagement does not need to worry about aging population, which in turn meant that they do not need to invest in improving birth rate.\nHowever, based on the pie chart, we can see that though the starting age is 18, only 5% of the working population is below the age of 21. This is probably because most are still studying at that age and are not actively working.\n\n\nShow the code\nage_count <- combined_table %>%\n  group_by(age_bin) %>%\n  summarize(\n    count = n_distinct(participantId)) %>% \n  mutate(prop_count = as.numeric(count) / n_distinct(as.numeric(combined_table$participantId)),\n         age_pie_pct = round(prop_count * 100)) %>% \n  mutate(ypos_p = rev(cumsum(rev(age_pie_pct))),\n         pos_p = age_pie_pct/2 + lead(ypos_p, 1, default = 0),\n         pos_p = if_else(is.na(pos_p), age_pie_pct/2, pos_p))\n\npie_age <- ggplot(age_count, aes(x = \"\" , y = age_pie_pct, fill = fct_inorder(age_bin))) +\n  geom_col(width = 1, color = 1) +\n  coord_polar(theta = \"y\") +\n  scale_fill_brewer(palette = \"YlGnBu\") +\n  geom_label_repel(data = age_count,\n                   aes(y = pos_p, label = paste0(age_pie_pct, \"%\")),\n                   size = 4.5, nudge_x = 1, color = c(1, 1, 1, 1, 1), show.legend = FALSE) +\n  guides(fill = guide_legend(title = \"Age Bin\")) +\n  labs(title = \"Proportion of participants in each Age Bin\") +\n  theme(legend.position = \"bottom\",\n        plot.title = element_text(face = \"bold\")) +\n  theme_minimal() \n\n\n\n\nShow the code\n#computing summary statistics of mean, median and lower and upper whiskers in boxplot for AGE\nage_mean <- round(mean(combined_table$age))\nage_median <- round(median(combined_table$age))\nymax <- max(combined_table$age)\nymin <- as.integer(min(combined_table$age))\n\n#plotting histogram for AGE\nh_age <- ggplot(data = combined_table, aes(x = age)) + \n  geom_histogram(color=\"black\", fill=\"azure4\", binwidth = 4) + \n  scale_x_continuous(limits = c(0,70), labels = scales::comma) +\n  labs(x = \"Age\", y = \"Number of participants\") +\n  geom_vline(aes(xintercept = age_mean), col=\"black\", linewidth=0.75) +\n  annotate(\"text\", x=48, y=1700, label=\"Mean age:\", \n           size=3, color=\"black\") +\n  annotate(\"text\", x=48, y=1600, label=format(age_mean, big.mark = \",\"),\n           size=3, color=\"black\") +\n  geom_vline(aes(xintercept = age_median), col=\"black\", linewidth=0.75) +\n  annotate(\"text\", x=30, y=1750, label=\"Median age:\", \n           size=3, color=\"black\") +\n  annotate(\"text\", x=30, y=1650, label=format(age_median, big.mark = \",\"),\n           size=3, color=\"black\") +\n  theme(axis.text.x = element_text(size=8))\n\n#plotting boxplot for AGE\nb_age <- ggplot(data = combined_table, aes(y = age)) + \n  geom_boxplot(outlier.colour=\"firebrick\", outlier.shape=16,\n               outlier.size=1, notch=FALSE, width =0.2) + \n  coord_flip() + labs(y = \"\", x = \"\") + \n  scale_y_continuous(limits = c(0,70), labels = scales::comma) +\n  theme(axis.text = element_blank(), axis.ticks = element_blank()) + \n  stat_boxplot(geom=\"errorbar\", width=0.2) + \n  annotate(\"text\", x=0.15, y=ymax, label=format(ymax, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=0.15, y=ymin, label=format(ymin, big.mark = \",\"), \n           size=3, color=\"lightpink4\") \n  #annotate(\"text\", x=-0.25, y=50, label=format(age_median, big.mark = \",\"),\n           #size=3, color=\"lightpink4\") \n  #annotate(\"text\", x=-0.25, y=25, label=\"Median age =\",\n           #size=3, color=\"lightpink4\")\n\nage_distri <- b_age / h_age + plot_layout(heights = c(1, 2)) \n\n# age_distri + plot_annotation(title = \"Distribution of Age\", \n#                                subtitle = \"There is a normal distribution i.e. mean age = median age\",\n#                                theme = theme(\n#                                  plot.title = element_text(size = 18),\n#                                  plot.subtitle = element_text(size = 12)))\n\n\n\n\nShow the code\n#combine the age_distri plot dervied earlier with the pie_age plot\nage_distri_pie <- (age_distri | pie_age) + plot_layout(widths = c(3,3))\n\nage_distri_pie + plot_annotation(title = \"Distribution of Age\", \n                               theme = theme(\n                                 plot.title = element_text(size = 16)))\n\n\n\n\n\n\n\n\n4.1.2 Income by Age\nLet’s find out if income is affected by age.\nTo compare the income level across ages, we will test the following null hypothesis:\nH0: the mean wage across different age groups are the same\nH1: the mean wage across different age groups are different\nTo start the confirmatory data analysis, we first perform the normality assumption test for the distribution of income and age. Normality assumption test for income has been performed previously.\nPlot the qqplot for income and age.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n# Create age table \nunique_participants <- unique(subset(combined_table, select = c(\"participantId\", \"age\")))\nhead(unique_participants)\n\n\n   participantId age\n1              0  36\n13             1  25\n25            10  48\n37           100  29\n49          1000  56\n61          1001  49\n\n\nShow the code\nqq_age <- ggplot(unique_participants,\n       aes(sample=age))+\n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"Normal Q-Q Plot of Age\")\n\nsw_t_age <- unique_participants %>%\n  shapiro_test(age) %>%\n  gt() #make it to gt format to give a nice table\n\ntmp_age <- tempfile(fileext = '.png')\ngtsave(sw_t_age, tmp_age)\ntable_png_age <- png::readPNG(tmp_age,native=TRUE) #sw_t cant be recognised by patchwork so change it to png\n\n(qq_age + table_png_age) / (qq + table_png)\n\n\n\n\n\nBased on the Shapiro test, both the p-value are < alpha value of 0.05, thus there is sufficient statistical evidence to conclude that the distribution of income and age are not normally distributed. Thus we will perform the non-parametric test, Oneway ANOVA Test.\n\n\nShow the code\nggbetweenstats(\n  data = combined_table,\n  x = age_bin, \n  y = Wage,\n  type = \"np\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"ns\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE,\n  ylim = c(0, 25000)\n) +\nggtitle(\"Oneway ANNOVA - Income across different age\")\n\n\n\n\n\nThe Kruskal-Wallis Test p-value is lower than the alpha values, thus there is sufficient statistical evidence to reject the null hypothesis and infer that the mean income across age is not the same.\nWe can observe that there are few pairs of age_bin with p-value > 0.05 such as [40,50) and [50,60]. This suggests that the differences between the medians of the pair are not statistically significant.\nWe can also observe that there is a higher wage median for those age 30-40. After the age of 40, it seems that the increase in age is not consistent with the increase in wage. The 2 highest wage level are from the opposite ends of the age spectrum. Though these are outliers, it suggests that age is not the limiting factor for high wage tier. It does not necessary mean that an individual has to be older to earn a higher income.\n\n\n4.1.3 Financial Health Observation\n\nCumulative Financial Health\nCreate a table to plot the cumulative financial health to see if there are cumulative savings in the city.\n\n# Create a data frame\ndf_totalfh <- combined_table %>%\n  group_by(month_year) %>%\n  summarise(total_fh = sum(Financial_health))\n\n#head(df_totalfh)\n\n\n\nShow the code\n# calculate cumulative financial health\ndf_totalfh <- df_totalfh %>% \n  mutate(cumulative_fh = cumsum(total_fh))\n\nhead(df_totalfh)\n\n\n# A tibble: 6 × 3\n  month_year total_fh cumulative_fh\n  <date>        <dbl>         <dbl>\n1 2022-03-01 4832812.      4832812.\n2 2022-04-01 2204851.      7037663.\n3 2022-05-01 2403220.      9440883.\n4 2022-06-01 2421291.     11862173.\n5 2022-07-01 2272492.     14134666.\n6 2022-08-01 2574129.     16708794.\n\n\nShow the code\n# Calculate y-axis breaks and labels\ny_breaks <- pretty_breaks(n = 3)(range(df_totalfh$cumulative_fh))\ny_labels <- dollar_format(prefix = \"$\")(y_breaks)\n\n# plot graph\nggplot(data = df_totalfh, aes(x = month_year, y = cumulative_fh)) +\n  geom_line() +\n  labs(x = \"Month/Year\", y = \"Cumulative Financial Health\", title = \"Cumulative Financial Health Over Time\") +\n  stat_summary(geom = \"line\", fun = \"cumsum\", linetype = \"dashed\") +\n  scale_y_continuous(breaks = y_breaks, labels = y_labels) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  theme(plot.title = element_text(face = \"bold\"),\n        plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), \"cm\"))\n\n\n\n\n\nFrom the figure above, we can see that the city has cumulative savings across the months.\nDiving deeper into the financial health of the participants, we will plot the boxplot of the Financial Health vs Mean Financial Health. Based on the plot below, we can see that the mean of the financial health is at the highest in March 2022 at around $4800 and decreased significantly in April 2022. Between April 2022 to Feb 2023, financial health was maintained between $2,500 to $3,000.\n\n\nShow the code\np_fh <- ggplot(data = combined_table, aes(x = month_year, y = Financial_health, \n                                      tooltip = month_year)) +\n  geom_boxplot() +\n  geom_point(stat = \"summary\", fun.y = \"mean\", colour = \"red\", size = 1) +\n  geom_line(stat = \"summary\", fun.y = \"mean\", colour = \"red\", size = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(title = \"Financial Health Over Time\",\n       y = \"Financial Health\",\n       x = \"Month/Year\") +\n  theme(plot.title = element_text(hjust = 0.2, size = 12, face = 'bold'),\n        plot.margin = margin(20, 20, 20, 20),\n        legend.position = \"bottom\",\n        axis.text = element_text(size = 8, face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1),\n        axis.title.x = element_text(hjust = 0.5, size = 12, face = \"bold\"),\n        axis.title.y = element_text(hjust = 0.5, size = 12, face = \"bold\")) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b-%Y\")\n\nggplotly(p_fh, tooltip = c(\"x\", \"y\", \"tooltip\"))\n\n\n\n\n\n\nTo find out if financial health is affected by wage or cost of living, we use the correlogram to see the correlation between financial health and wage, cost of living and the various expense category. Based on the correlation table and the significant test of correlation, we can see that financial health and wage has a strong positive correlation of 0.98 , while cost of living has low negative correlation of -0.14.\nBased on the correlogram below, we can also observe that Recreation and Shelter have a high correlation with Cost of living.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c( \"Wage\", \"Financial_health\", \"Cost_of_living\", \"Food\", \"Shelter\", \"Recreation\", \"Education\", \"RentAdjustment\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Financial Health Correlation Table\")\n\n\n\n\n\n\nWage CorrelationCost of Living Correlation\n\n\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Wage,\n  y = Financial_health,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\n\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Cost_of_living,\n  y = Financial_health,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\n\n\nTo further explore each expense category over time, we will plot the different expense category over time.\n\n\nShow the code\n# group the expenses by month year\nexpenses_grouped <- combined_table %>%\n  group_by(month_year) %>%\n  summarize(total_recreation = mean(Recreation),\n            total_food = mean(Food),\n            total_shelter = mean(Shelter),\n            total_education = mean(Education))\n\n# plot the data using ggplot2\np_expense <- ggplot(expenses_grouped, aes(x = month_year)) + \n  geom_line(aes(y = total_recreation, color = \"Recreation\")) +\n  geom_line(aes(y = total_food, color = \"Food\")) +\n  geom_line(aes(y = total_shelter, color = \"Shelter\")) +\n  geom_line(aes(y = total_education, color = \"Education\")) +\n  labs(x = \"Month/Year\", y = \"Mean Expenses($)\") +\n  scale_y_continuous(limits = c(-1000, 0), \n                      breaks = seq(-1000, 0, 2*100),\n                      labels = dollar_format(prefix = \"$\")) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  ggtitle(\"Expenses Over time\") +\n  scale_color_manual(values = c(\"Recreation\" = \"red\", \n                                \"Food\" = \"blue\", \n                                \"Shelter\" = \"green\", \n                                \"Education\" = \"purple\")) +\n  theme(plot.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5)) \n\n\nAlso, we shall plot the wage over time to compare it with the expenses over time plot.\n\n\nShow the code\n# group the wage by month year\nwage_grouped <- combined_table %>%\n  group_by(month_year) %>%\n  summarize(mean_wage_bymonth = mean(Wage))\n\n# plot the data using ggplot2\np_meanwage <- ggplot(wage_grouped, aes(x = month_year)) + \n  geom_line(aes(y = mean_wage_bymonth)) +\n  labs(x = \"Month/Year\", y = \"Mean Wage($)\") +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  ggtitle(\"Expenses by Month/Year\") +\n  theme(plot.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))\n\n\nFor easier comparison, we shall combine the 2 plots together for better visualization.\n\nexpenses_wage <- p_expense + p_meanwage + plot_layout(heights = c(80, 50)) \nexpenses_wage\n\n\n\n\nLooking at the expenses over time plot above, it showed that education, food and shelter remained stable over time, which meant these costs are most likely fixed despite any wage fluctuations. Recreation expenses, on the hand, is high in March and decreases significantly from March 2022 to April 2022 and plateaus to a stable rate thereafter.\nLooking at the wage over time plot, we can see that in March, the mean income is at its peak in March 2022 and dips significantly in April 2022. April 2022 onward, the income remains relatively stable and starts to increase slightly in August 2022, but in Jan 2023 it start to decrease further. The fluctuations in the financial health and income is directly proportionate. And we can also see that, recreation expenses increases when there is an increase in income but remain low when income is low.\nSince this is an agricultural city, participants’ pay could be likely to be affected by the seasons and harvest.\n\n\nWage vs Cost of Living overtime\nLooking at the wage vs cost of living, we can see that on average, most citizens can cope with their cost of living as their mean wage (blue bars) is higher than the mean cost of living (red bars). Most citizens should still have savings monthly.\n\n# Creating a table with Wage and Cost of Living by month_year\n\n# Group the data by month and find the corresponding means\ndf_monthly <- combined_table %>%\n  group_by(month_year) %>%\n  summarise(mean_income = mean(Wage),\n            mean_cost_of_living = mean(Cost_of_living))\n# Melt the data frame to create a long format\ndf_monthly_melt <- melt(df_monthly, id.vars = \"month_year\", variable.name = \"variable\", value.name = \"value\")\n\n\n\nShow the code\n# Plot using ggplot2\nggplot(df_monthly_melt, aes(x = month_year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 25), alpha = 0.7) +\n  scale_fill_manual(name = \"Legend\", values = c(\"mean_income\" = \"blue\", \"mean_cost_of_living\" = \"red\")) +\n  labs(x = \"Month\", y = \"Mean\", title = \"Monthly Mean Income and Cost of Living\") +\n  scale_x_date(guide = guide_axis(angle = 45)) +\n  theme(axis.text.x = element_text(hjust = 0.4, vjust = 0.5, size = 5)) \n\n\n\n\n\n\n\n\n4.1.4 Observation on Education Level\n\nEducation affects financial health and birth rate\nTo see if education affects financial health and birth rate, we will create the boxplot as shown below.\n\n\nShow the code\n# Create a factor with the education levels in the desired order\nedu_levels <- c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")\ncombined_table$educationLevel <- factor(combined_table$educationLevel, levels = edu_levels)\n\n# Create a box plot with separate panels for individuals with and without kids\np_fh_kids <- ggplot(combined_table, aes(x = educationLevel, y = Financial_health, fill = haveKids)) +\n  geom_boxplot() +\n  stat_summary(aes(group = haveKids, color = haveKids), fun = mean, geom = \"line\", size = 0.5) + # add mean lines\n  stat_boxplot(geom='errorbar', width=0.1, coef=1.5, size=0.5) + # add error bars\n  scale_fill_manual(name = \"haveKids\", values = c(\"FALSE\" = \"grey\", \"TRUE\" = \"orange\")) +\n  labs(title = \"Boxplot of Financial Health and Education by Kids\", x = \"Education\", y = \"Financial Health\") +\n  facet_wrap(~haveKids, ncol = 2) +\n  theme_bw() +\n  theme(plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)) \n\n# Display the plot\nggplotly(p_fh_kids)\n\n\n\n\n\n\nWe observe here that education is positively correlated to wage and financial health of the citizens. The higher the education level, the higher the financial health. Also, we can see that citizen with kids tend to have better financial health overall. Thus, showing that good education is necessary for higher wage.\nTo further confirm that wage is affected by education level, we will test the following null hypothesis:\nH0: the mean wage across different education levels are the same\nH1: the mean wage across different education levels are different\nAs based on previous normality assumption test done for wage, we know that wage is not normally distributed. Thus, to test the null hypothesis, we will perform the non-parametric test, Oneway ANOVA Test.\n\n\nShow the code\nggbetweenstats(\n  data = combined_table,\n  x = educationLevel, \n  y = Wage,\n  type = \"np\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"ns\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE,\n  ylim = c(0, 25000),\n  breaks = seq(0, 25000, 5000)\n) +\nggtitle(\"Oneway ANNOVA - Income across different educationLevel\")\n\n\n\n\n\nSince the p-value < critical value of 0.05, there is statistical evidence to reject the null hypothesis. We can thus conclude that education indeed does affect one’s wage and overall the median wage is higher for higher education level, which is consistent with our findings earlier."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#observation-on-joviality",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#observation-on-joviality",
    "title": "Take-Home_Ex01",
    "section": "4.2 Observation on Joviality",
    "text": "4.2 Observation on Joviality\nTo find out the factors that could possibly affect joviality, we plot the below correlogram. However, looking at the plot below, we can see that none of the factors have correlation more than 0.5. Joviality has a negative correlation relationship with wage, expense, and savings.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c(\"joviality\", \"Wage\", \"Financial_health\", \"Cost_of_living\", \"age\", \"householdSize\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Joviality Correlation Table\")\n\n\n\n\n\n\n4.2.1 Joviality is affected by Financial health\nEven though correlation between joviality is weak (-0.35), we can observe the smooth red curve is relatively different across different income levels. It appears joviality has a strong correlation for lower income levels as compaeed to the rich. when broken down in health levels, it appears that joviality has the lowest correlation for middle income, the R2= 0.006.\nHowever, we also observed that there are poor people who have the highest joviality of 0.90 whereas for the income earners (in red), all of them have a joviality score below 0.64. Thus, we can conclude that being rich does not necessarily make citizens happy.\n\n\nShow the code\n# Create the plot\np_j <- ggplot(combined_table, aes(x = Financial_health, y = joviality, color = Wage)) +\n  geom_point() + # Scatter plot\n  geom_smooth(method = \"loess\", se = FALSE, colour = \"red\") + # Add smoother\n  scale_y_continuous(limits = c(0, 1)) + # Set Y-axis limits to 0-1\n  scale_color_gradient(low = \"blue\", high = \"red\") # Set color scale from blue to red\n\nggplotly(p_j)\n\n\n\n\n\n\n\n\nShow the code\nlibrary(ggpmisc)\n# Compute the 25th and 75th percentiles of Financial_health\nq <- quantile(combined_table$Financial_health, probs = c(0.25, 0.75))\n\n# Create a new column \"income_level\" based on Financial_health percentiles\ncombined_table$income_level <- ifelse(combined_table$Financial_health < q[1], \"Low\",\n                                      ifelse(combined_table$Financial_health > q[2], \"High\", \"Middle\"))\n\n# Specify the order of the income levels\ncombined_table$income_level <- factor(combined_table$income_level,\n                                      levels = c(\"Low\", \"Middle\", \"High\"))\n\n# Create the plot with facets and regression line equation\nggplot(combined_table, aes(x = Financial_health, y = joviality)) +\n  geom_point() + # Scatter plot\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"red\") + # Add smoother\n  scale_y_continuous(limits = c(0, 1)) + # Set Y-axis limits to 0-1\n  facet_wrap(~ income_level) + # Create facets by income level\n  stat_poly_eq(formula = y ~ x, aes(label = paste(\"R^2 = \", round(..r.squared.., 3))),\n               parse = TRUE, label.x = \"right\", label.y = 0.9, \n               eq.with.lhs = FALSE, size = 3) + # Show R-squared only, adjust label position and decrease font size\n  theme(plot.margin = unit(c(1, 1, 1, 5), \"lines\")) # Adjust right margin to make room for equation\n\n\n\n\n\n\n\n4.2.2 Joviality is affected by Cost of Living\nTo test the significance of correlation between joviality and cost of living, the following code chunk is used, and we notice that the slight positive correlation for 0.45.\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Cost_of_living,\n  y = joviality,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\nJoviality vs expense_category\nWe can see that food expenses has the highest correlation at 0.49. Thus, the city planners and managers can consider allocating a portion of the grant to food expenses.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c(\"joviality\", \"Food\", \"Education\", \"Shelter\", \"Recreation\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Joviality Correlation Table\")\n\n\n\n\n\n\n\nShow the code\n# Select only the columns of interest from combined_table\ndata_reg <- select(combined_table, Shelter, Food, Education, Recreation, joviality)\n\ndata_reg <- data_reg %>%\n  mutate_at(vars(Shelter, Food, Education, Recreation), abs)\n\n# Melt data into long format\ndata_reg <- reshape2::melt(data_reg, id.vars = \"joviality\")\n\n#Create plot with multiple regression lines\n\nggplot(data_reg, aes(x = value, y = joviality, color = variable)) +\n  geom_point(size = 0.25) +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = FALSE, aes(group = variable)) +\n  xlab(\"Expenses_type\") +\n  ylab(\"Joviality\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#observation-on-interest-groups",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#observation-on-interest-groups",
    "title": "Take-Home_Ex01",
    "section": "4.3 Observation on Interest Groups",
    "text": "4.3 Observation on Interest Groups\nWe can plot the histogram below to observe the distribution of the different interest interest group. As seen from below, there is roughly the same proportion of participants in each group.\n\n\nShow the code\ncombined_table_grp <- combined_table %>% \n  group_by(participantId) %>%\n  summarise(interestGroup = first(interestGroup), age_bin = first(age_bin)) # assuming interestGroup and age_bin are constant for each participantID\n\nggplot(data = combined_table_grp, aes(x = interestGroup)) + \n  stat_count(color=\"black\", fill=\"azure4\") + \n  labs(x = \"Interest Groups\", y = \"Number of participants\") +\n  ggtitle(\"Distribution of interest groups\") +\n  geom_text(stat = \"count\", aes(label=..count..), vjust=-0.5) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\nFurthermore, we can use the heatmap to have overall glimpse of the interest groups by age_bin to see if it affects the type of interest participants are in.\nFrom the heatmap below, we can see that there is a high proportion of age_bin [30,40) that are in Interest Group H.\n\n\nShow the code\n#Group the data by interest group and age bin, and count the number of participants\n\ndf_heatmap <- combined_table_grp %>% \n  group_by(interestGroup, age_bin) %>% \n  summarize(n = n()) %>% \n  ungroup()\n\n# Create a heatmap\nggplot(data = df_heatmap, aes(x = interestGroup, y = age_bin, fill = n)) +\n  geom_tile() +\n  scale_fill_gradientn(colors = c(\"lightblue\", \"red\"), na.value = \"white\") +\n  labs(x = \"Interest Group\", y = \"Age Bin\", fill = \"Number of Participants\") +\n  ggtitle(\"Heatmap of Participants by Interest Group and Age\") +\n  theme(plot.title = element_text(hjust = 0.5))"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#visualizing-uncertainty",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html#visualizing-uncertainty",
    "title": "Take-Home_Ex01",
    "section": "4.4 Visualizing uncertainty",
    "text": "4.4 Visualizing uncertainty\n\n4.4.1 Visualizing uncertainty of point estimates\nIt can be tempting to interpret point estimates like median as the true precise representation of the true data value. However, it should be noted that there are uncertainties surrounding these point estimates. Thus we want to show the target quantile confidence levels (95% or 99%) that the true (unknown) estimate would like within the interval, given evidence provided by observed data.\nAs can been seen from the age_bin plot below, some age_bin have higher uncertainties such as age_bin [20,30) and [50,60]. This could be due to the presence of large no of outliers, and probably at the stage of the deciding their career path. On the other hand, age_bin such as [18,20) has less uncertainties,which may indicate lower presence of outliers.\nLikewise, for the educationLevel plot below, low level education has less uncertainties, while the higher educationLevel, the higher the uncertainties get.\n\nAge_bineducationLevel\n\n\n\n\nShow the code\n#Base ggplot\nggplot(data = combined_table,\n  aes(x = age_bin,\n      y = Wage)) +\n\n#Using stat_pointinterval to plot the points and intervals\n  stat_pointinterval(\n    aes(interval_color = stat(level)),\n    .width = c(0.95, 0.99),\n    .point = median,\n    .interval = qi,\n    point_color = \"darkred\",\n    show.legend = FALSE) +\n\n#Defining the color of the intervals\n  scale_color_manual(\n    values = c(\"blue2\", \"darkblue\"),\n    aesthetics = \"interval_color\") +\n\n#Title, subtitle, and caption\n  labs(title = 'Visualising uncertainty in median estimates of wage by age_bin',\n  subtitle = 'Quantiles intervals (95% and 99%) of wage by age_bin',\n  x = \"age_bin\",\n  y = \"Wage\") +\n\n  theme_hc() +\n\n  theme(plot.title = element_text(face = \"bold\", size = 18),\n        plot.subtitle = element_text(size = 14),\n        axis.text.x = element_text(angle = 30, hjust = 1))\n\n\n\n\n\n\n\n\n\nShow the code\n#Base ggplot\nggplot(\n  data = combined_table,\n  aes(x = educationLevel,\n      y = Wage)) +\n\n#Using stat_pointinterval to plot the points and intervals\n  stat_pointinterval(\n    aes(interval_color = stat(level)),\n    .width = c(0.95, 0.99),\n    .point = median,\n    .interval = qi,\n    point_color = \"darkred\",\n    show.legend = FALSE) +\n\n#Defining the color of the intervals\n  scale_color_manual(\n    values = c(\"blue2\", \"darkblue\"),\n    aesthetics = \"interval_color\") +\n\n#Title, subtitle, and caption\n  labs(title = 'Visualising uncertainty in median estimates of wage by educationLevel',\n  subtitle = 'Quantiles intervals (95% and 99%) of wage by educationLevel',\n  x = \"educationLevel\",\n  y = \"Wage\") +\n\n  theme_hc() +\n\n  theme(plot.title = element_text(face = \"bold\", size = 18),\n        plot.subtitle = element_text(size = 14),\n        axis.text.x = element_text(angle = 30, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n4.4.2 Visualizing Uncertainty with Hypothetical Outcome Plots (HOPs)\nHPOs can help to illustrate the uncertainty and variability of the data and model predictions, and highlight the potential impact of different variables or factors on the outcomes of interest.\n\nAge_bineducationLevel\n\n\n\n\nShow the code\nlibrary(ungeviz)\n\nggplot(data = combined_table,\n        (aes(x = factor(age_bin), y = Wage))) +\n   geom_point(position = position_jitter(\n     width = 0.05, height = 0.3),\n     size = 0.4, color = \"#0072B2\", alpha = 1/2) +\n   geom_hpline(data = sampler(25, group = age_bin), height = 0.6, color = \"#D55E00\") +\n   theme_bw() +\n  transition_states(.draw, 1, 3)\n\n\n\n\n\n\n\n\n\nShow the code\nggplot(data = combined_table,\n        aes(x = factor(educationLevel), y = Wage)) +\n   geom_point(position = position_jitter(\n     width = 0.05, height = 0.3),\n     size = 0.4, color = \"#0072B2\", alpha = 1/2) +\n   geom_hpline(data = sampler(25, group = educationLevel), height = 0.6, color = \"#D55E00\") +\n   theme_bw() +\n   transition_states(.draw, 1, 3)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html",
    "title": "Take Home_Ex02",
    "section": "",
    "text": "The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. As part of the collaboration, FishEye’s analysts received import/export data for Oceanus’ marine and fishing industries.\nWith reference to Mini-Challenge 2 of VAST Challenge 2023 and by using appropriate static and interactive statistical graphics methods, we will be helping FishEye to identify companies that may be engaged in illegal fishing."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#install-and-launching-r-packages",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#install-and-launching-r-packages",
    "title": "Take Home_Ex02",
    "section": "3.1 Install and launching R packages",
    "text": "3.1 Install and launching R packages\nThe code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:\n\npacman::p_load(jsonlite,tidygraph,ggraph,visNetwork,tidyverse,lubridate,igraph,plotly,treemap)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#loading-the-data",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#loading-the-data",
    "title": "Take Home_Ex02",
    "section": "3.2 Loading the Data",
    "text": "3.2 Loading the Data\nfromJSON() of jsonlite package is used to import mc2_challenge_graph.json into R environment.\n\nMC2 <- fromJSON(\"data/mc2_challenge_graph.json\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#data-wrangling",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#data-wrangling",
    "title": "Take Home_Ex02",
    "section": "3.3 Data Wrangling",
    "text": "3.3 Data Wrangling\n\n3.3.1 Extracting the nodes\nThe code chunk is used to extract nodes data table from mc2_data list object and save the output in a tibble data frame object called mc2_nodes.\n\n#Extract id, shpcountry and rcvcountry and make it as a tibble database. use select to choose the fields you want and reorganise the fields as you want\nMC2_nodes <- as_tibble(MC2$nodes) %>%\n  select(id, shpcountry, rcvcountry)\nhead(MC2_nodes)\n\n# A tibble: 6 × 3\n  id                                shpcountry rcvcountry\n  <chr>                             <chr>      <chr>     \n1 AquaDelight Inc and Son's         Polarinda  Oceanus   \n2 BaringoAmerica Marine Ges.m.b.H.  <NA>       <NA>      \n3 Yu gan  Sea spray GmbH Industrial Oceanus    Oceanus   \n4 FlounderLeska Marine BV           <NA>       <NA>      \n5 Olas del Mar Worldwide            Oceanus    Oceanus   \n6 French Crab S.p.A. Worldwide      Kondanovia Utoporiana\n\n\n\n\n\n\n\n\nThings to learn\n\n\n\nselect() is used not only to select the field needed but also to re-organise the sequence of the fields.\n\n\n\n\n3.3.2 Extracting the edges\nThe code chunk is used to extract edges data table from mc2_data list object and save the output in a tibble data frame object called mc2_edges.\n\nMC2_edges <- as_tibble(MC2$links) %>%\n  select(source, target, arrivaldate, hscode, valueofgoods_omu, valueofgoodsusd, volumeteu, weightkg)\n\n\n\n3.3.3 Reviewing the imported data\nNext, we will examine the structure of the data frame using glimpse() of dplyr.\n\nglimpse(MC2_nodes)\n\nRows: 34,576\nColumns: 3\n$ id         <chr> \"AquaDelight Inc and Son's\", \"BaringoAmerica Marine Ges.m.b…\n$ shpcountry <chr> \"Polarinda\", NA, \"Oceanus\", NA, \"Oceanus\", \"Kondanovia\", NA…\n$ rcvcountry <chr> \"Oceanus\", NA, \"Oceanus\", NA, \"Oceanus\", \"Utoporiana\", NA, …\n\nglimpse(MC2_edges)\n\nRows: 5,464,378\nColumns: 8\n$ source           <chr> \"AquaDelight Inc and Son's\", \"AquaDelight Inc and Son…\n$ target           <chr> \"BaringoAmerica Marine Ges.m.b.H.\", \"BaringoAmerica M…\n$ arrivaldate      <chr> \"2034-02-12\", \"2034-03-13\", \"2028-02-07\", \"2028-02-23…\n$ hscode           <chr> \"630630\", \"630630\", \"470710\", \"470710\", \"470710\", \"47…\n$ valueofgoods_omu <dbl> 141015, 141015, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ valueofgoodsusd  <dbl> NA, NA, NA, NA, NA, NA, 87110, 188140, NA, 221110, 58…\n$ volumeteu        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ weightkg         <int> 4780, 6125, 10855, 11250, 11165, 11290, 9000, 19490, …\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe output report of MC2_edges above reveals that the arrivaldate is treated as  data type instead of date data type. This is an error! Before we continue, it is important for us to change the data type of arrivaldate field to “Date”” data type.\n\n\n\n\n3.3.4 Wrangling Time\n\nMC2_edges <- MC2_edges %>%\n  mutate(ArrivalDate = ymd(arrivaldate)) %>%\n  mutate(Year = year(ArrivalDate)) %>%\n  mutate(Month = month(ArrivalDate)) %>%\n  mutate(Monthyear = paste(Year, Month, sep = \"-\")) %>%\n  select(source, target, ArrivalDate, Month, Year, hscode, valueofgoods_omu, volumeteu, weightkg, valueofgoodsusd) %>%\n  distinct()\nhead(MC2_edges)\n\n# A tibble: 6 × 10\n  source        target ArrivalDate Month  Year hscode valueofgoods_omu volumeteu\n  <chr>         <chr>  <date>      <dbl> <dbl> <chr>             <dbl>     <dbl>\n1 AquaDelight … Barin… 2034-02-12      2  2034 630630           141015         0\n2 AquaDelight … Barin… 2034-03-13      3  2034 630630           141015         0\n3 AquaDelight … -15045 2028-02-07      2  2028 470710               NA         0\n4 AquaDelight … -15045 2028-02-23      2  2028 470710               NA         0\n5 AquaDelight … -15045 2028-09-11      9  2028 470710               NA         0\n6 AquaDelight … -15045 2028-10-09     10  2028 470710               NA         0\n# ℹ 2 more variables: weightkg <int>, valueofgoodsusd <dbl>\n\n\n\n\n\n\n\n\nThings to learn\n\n\n\n\nmutate() is used 4 times to create 4 derive fields.\n\nymd() of lubridate package is used to covert arrivaldate field from character data type into date data type.\nyear() of lubridate package is used to convert the values in ArrivalDate field into year values.\nmonth() of lubridate package is used to convert the values in ArrivalDate field into month values.\n\nselect() is used not only to select the field needed but also to re-organise the sequent of the fields.\n\n\n\n\n\n3.3.5 Checking if there is any missing values in the edge data table\nThe below chunck is used to calculate the percentage of NAs and 0s in the each column in the edge data table to see if we should use it for our analysis.\n\n# Select specific columns in your dataset\nselected_columns <- c(\"valueofgoods_omu\", \"volumeteu\", \"weightkg\", \"valueofgoodsusd\")\n\n## Calculate the percentage of NA values and zeros for the selected columns\ntotal_rows <- nrow(MC2_edges)\nna_percentage <- colSums(is.na(MC2_edges[, selected_columns])) / total_rows * 100\nzero_percentage <- colSums(MC2_edges[, selected_columns] == 0, na.rm = TRUE) / total_rows * 100\n\n# Combine the results into a data frame\nresult <- data.frame(NA_Percentage = na_percentage, Zero_Percentage = zero_percentage)\n\n# Display the result\nresult\n\n                 NA_Percentage Zero_Percentage\nvalueofgoods_omu      99.99471      0.00000000\nvolumeteu              9.38167     75.91084870\nweightkg               0.00000      0.90128491\nvalueofgoodsusd       54.36443      0.08169013\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThere is a high percentage of NA value in valueofgoods_omu and valueofgoodusd and a high percentage of zero in volumeteu, thus we will leave them out in our analysis, since we are unable to derive any useful insights.\n\n\n\n\n3.3.6 Preparing the edges data table\nHarmonized System (HS) codes are the identification codes given to goods for use in international trade. The HS codes are administered by the World Customs Organization (WCO) and are internationally accepted for use by customs authorities and companies to identify goods.\nSince we are doing an analysis on the fishing industry, we have to first filter those hscodes that are fishing industry related products.\n\nmc2_edges_aggregated <- MC2_edges %>%\n  filter(grepl(\"^30[1-8]|^2301|^160[4-5]|^1212|^1302|^1504|^151610|^151790\", hscode)) %>% # filter out only those hscode that are fishing industry related products \n  group_by(source, target, hscode, Year) %>%\n    summarise(weights = n(), median_weight = median(weightkg)) %>%\n  filter(source!=target) %>%\n  filter(weights>10) %>%\n  ungroup()\nmc2_edges_aggregated\n\n# A tibble: 12,408 × 6\n   source                              target hscode  Year weights median_weight\n   <chr>                               <chr>  <chr>  <dbl>   <int>         <dbl>\n 1 \" Direct Herring Company Transit\"   Estre… 306170  2031      12        21078.\n 2 \"1 Limited Liability Company\"       Olas … 303630  2034      28        19830 \n 3 \"1 Limited Liability Company Trans… Selou… 160414  2030      12         9985 \n 4 \"1 Limited Liability Company Trans… Selou… 160414  2031      21         8815 \n 5 \"1 Limited Liability Company Trans… Selou… 160414  2032      16         6908.\n 6 \"1 Limited Liability Company Trans… Selou… 160414  2033      54         6922.\n 7 \"1 Limited Liability Company Trans… Selou… 160414  2034      28         6545 \n 8 \"1 Ltd. Liability Co Cargo\"         Himac… 306170  2028      68        10095 \n 9 \"1 Ltd. Liability Co Cargo\"         Himac… 306170  2029      59        19205 \n10 \"1 Ltd. Liability Co Cargo\"         Himac… 306170  2030      26        17708.\n# ℹ 12,398 more rows\n\n\nNext, we take a look at what are the top fishing related products that has most transactions.\n\ntop_3_hscode <- mc2_edges_aggregated %>%\n  group_by(hscode) %>%\n  summarise(total_weights = sum(weights)) %>%\n  arrange(desc(total_weights)) %>%\n  slice_head(n = 3)\n\ntop_3_hscode\n\n# A tibble: 3 × 2\n  hscode total_weights\n  <chr>          <int>\n1 306170        122910\n2 304620         81075\n3 160414         63745\n\n\nThe top 3 hscodes that has most number of transactions are ‘306170’,‘304620’ and ‘160414’. Thus, we will focus our analysis based on these 3 hscodes.\n\n#Filter the mc2_edges_aggregated based on the top 3 hscode\nmc2_edges_aggregated_top <- mc2_edges_aggregated %>%\n  filter(hscode == \"306170\"| hscode == \"304620\"| hscode == \"160414\")\n\n#mc2_edges_aggregated_top\n\n\n\n\n\n\n\nThings to learn\n\n\n\n\nfilter() is used to select records whereby hscode that fishing industry related products. The selection of hscode is referenced from the link here\ngroup_by() is used to aggregate values by source, target, hscode, Year.\nsummarise() and n() are used to count the aggregated records.\nfilter() is then used to perform the below selection,\n\nto select all records whereby source are not equal to target\n\n\n\n\n\n\n3.3.7 Preparing the nodes data table\nInstead of using the nodes data table extracted from mc2_data, we will prepare a new nodes data table by using the source and target fields of mc2_edges_aggregated data table. This is necessary to ensure that the nodes in nodes data tables include all the source and target values. Then we will reference to the MC2_nodes table to get the corresponding shpcountry and rcvcountry values.\n\nid1_aggregated <- mc2_edges_aggregated_top %>%\n  select(source) %>%\n  rename(id = source)\nid2_aggregated <- mc2_edges_aggregated_top %>%\n  select(target) %>%\n  rename(id = target)\nmc2_nodes_extracted_aggregated <- rbind(id1_aggregated, id2_aggregated) %>%\n  distinct()\n\n# Join with MC2_nodes by 'id to get the 'shpcountry', and 'rcvcountry'\nmc2_nodes_extracted_aggregated <- mc2_nodes_extracted_aggregated %>%\n  left_join(MC2_nodes, by = \"id\")\nhead(mc2_nodes_extracted_aggregated)\n\n# A tibble: 6 × 3\n  id                                                shpcountry rcvcountry \n  <chr>                                             <chr>      <chr>      \n1 \" Direct Herring Company Transit\"                 Mawazam    Coralmarica\n2 \"1 Limited Liability Company Transport\"           Kondanovia Oceanus    \n3 \"1 Ltd. Liability Co Cargo\"                       Mawandia   <NA>       \n4 \"6 Ltd. Liability Co Transportation\"              Marebak    Oceanus    \n5 \"8 Aquamarine Limited Liability Company Holdings\" Marebak    Oceanus    \n6 \"9 Marine biology Ltd Family\"                     Mawazam    <NA>       \n\n\n\n\n3.3.8 Building the tidygraph model\nThe code chunk below is then used to build the tidy graph data model.\n\nmc2_graph <- tbl_graph(nodes = mc2_nodes_extracted_aggregated,\n                       edges = mc2_edges_aggregated_top,\n                       directed = TRUE)\nmc2_graph\n\n# A tbl_graph: 930 nodes and 4670 edges\n#\n# A directed acyclic multigraph with 27 components\n#\n# A tibble: 930 × 3\n  id                                                shpcountry rcvcountry \n  <chr>                                             <chr>      <chr>      \n1 \" Direct Herring Company Transit\"                 Mawazam    Coralmarica\n2 \"1 Limited Liability Company Transport\"           Kondanovia Oceanus    \n3 \"1 Ltd. Liability Co Cargo\"                       Mawandia   <NA>       \n4 \"6 Ltd. Liability Co Transportation\"              Marebak    Oceanus    \n5 \"8 Aquamarine Limited Liability Company Holdings\" Marebak    Oceanus    \n6 \"9 Marine biology Ltd Family\"                     Mawazam    <NA>       \n# ℹ 924 more rows\n#\n# A tibble: 4,670 × 6\n   from    to hscode  Year weights median_weight\n  <int> <int> <chr>  <dbl>   <int>         <dbl>\n1     1   543 306170  2031      12        21078.\n2     2   544 160414  2030      12         9985 \n3     2   544 160414  2031      21         8815 \n# ℹ 4,667 more rows"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#calulating-the-in-out-and-total-degree-centrality-of-the-nodes",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#calulating-the-in-out-and-total-degree-centrality-of-the-nodes",
    "title": "Take Home_Ex02",
    "section": "4.1 Calulating the in, out and total degree centrality of the nodes",
    "text": "4.1 Calulating the in, out and total degree centrality of the nodes\nDegree centrality is a measure of immediate connection in a network. It could be interpreted as immediate reach in a social network.\nWe will calculate the in and out degree centrality of the nodes, and create 2 new columns to store these scores.\n\n\n# A tbl_graph: 930 nodes and 4670 edges\n#\n# A directed acyclic multigraph with 27 components\n#\n# A tibble: 930 × 6\n  id            shpcountry rcvcountry in_degree_centrality out_degree_centrality\n  <chr>         <chr>      <chr>                     <dbl>                 <dbl>\n1 Mar del Este… Merigrad   Oceanus                     400                     0\n2 Caracola del… Puerto Sol Oceanus                     363                     0\n3 hǎi dǎn Corp… Marebak    Oceanus                     337                     0\n4 Costa de la … Alverossia Oceanus                     181                     0\n5 Selous Game … Isliandor  Oceanus                     153                     0\n6 Pao gan SE S… Alverossia Oceanus                     150                     0\n# ℹ 924 more rows\n# ℹ 1 more variable: degree_centrality <dbl>\n#\n# A tibble: 4,670 × 6\n   from    to hscode  Year weights median_weight\n  <int> <int> <chr>  <dbl>   <int>         <dbl>\n1   402    48 306170  2031      12        21078.\n2   403     5 160414  2030      12         9985 \n3   403     5 160414  2031      21         8815 \n# ℹ 4,667 more rows\n\n\n\n\n\n\n\n\nThings to learn\n\n\n\nactivate() is used to make the nodes of mc2_graph active to calculate the degree centrality.\nmutate() function from the dplyr package is used to add two new columns, in_degree_centrality and out_degree_centrality, to the nodes of the mc2_graph object"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#determining-the-type-of-entity-the-id-belongs-to",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#determining-the-type-of-entity-the-id-belongs-to",
    "title": "Take Home_Ex02",
    "section": "4.2 Determining the type of entity the id belongs to",
    "text": "4.2 Determining the type of entity the id belongs to\n\n#Specify what entity the id could be \nmc2_graph <- mc2_graph %>%\n  mutate(\n    node_type = case_when(\n      in_degree_centrality == 0 & out_degree_centrality > 0 ~ \"vessels\",\n      in_degree_centrality > 0 & out_degree_centrality == 0 ~ \"transshipment\",\n      in_degree_centrality > 0 & out_degree_centrality > 0 ~ \"vessels/transshipment\"\n    )\n  )\n\n\n4.2.1 Counting number of entities for each business type\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n#Count the how many id belong to each entity\nvessels_count <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  filter(node_type == \"vessels\") %>%\n  nrow()\n\ntranshipment_count <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  filter(node_type == \"transshipment\") %>%\n  nrow()\n\nboth_count <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  filter(node_type == \"vessels/transshipment\") %>%\n  nrow()\n\n# cat(\"Number of vessels:\", vessels_count, \"\\n\")\n# cat(\"Number of transshipment:\", transhipment_count, \"\\n\")\n# cat(\"Number of vessels/transshipment:\", both_count, \"\\n\")\n\n\nAfter cleaning up the data, we have a total of 529 vessels, 388 transshipment and 13 companies that may be either a vessel or transshipment to work with for our analysis.\n\n\n\n\n\n\nNote\n\n\n\n\nIf in_degree_centrality == 0, it means that the company is most likely a pure exporter and highly likely a vessel.\nIf out_degree_centrality == 0, it means that the company is most likely a pure importer and highly likely involved in transshipment.\nIf in_degree_centrality > 0 & out_degree_centrality > 0, the company is most likely both a vessel or transshipment."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#community-detection-analysis",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#community-detection-analysis",
    "title": "Take Home_Ex02",
    "section": "4.6 Community Detection Analysis",
    "text": "4.6 Community Detection Analysis\nNext, we will do a community detection analysis using the group_edge_betweenness function. It works by iteratively removing the edges with the highest betweenness centrality, which is a measure of the number of shortest paths that pass through an edge. By removing these edges, the graph is divided into clusters or communities.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nset.seed(123)\nmc2_graph <- mc2_graph %>%\n   mutate(community = as.factor(group_edge_betweenness(weights = weights, directed = TRUE)))\n\ng_mcgraph <- mc2_graph %>%\n  activate(nodes) %>%\n  group_by(community) %>%\n  filter(n() > 2) %>%    #filter the community size > 2\n  ungroup() %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width = weights), \n                 alpha = 0.2,\n                 arrows = \"to\") +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = community)) +\n  theme_graph()\n\ng_mcgraph\n\n\n\n\n\nAs seen from the community detection graph above, after filtering for community size > 2, there are 9 community shown, and looking at the connectivity and density of the graph, it seems that community 1, seems to be the most densely populated. Thus, for the following analysis, we shall focus on community 1.\nThe code chunk below can be used to find out which node has the highest in-degree centrality for in community 1. And we can see that within community 1, Mar del Este CJSC has the highest in-degree centrality score.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nindegree_community <- mc2_graph %>%\n  activate(nodes) %>%\n  filter(community == 1) %>%\n  mutate(in_degree_centrality_community = centrality_degree(mode = \"in\")) %>%\n  arrange(desc(in_degree_centrality_community)) %>%\n  as_tibble()\n\nhead(indegree_community, 5)\n\n\n# A tibble: 5 × 11\n  id            shpcountry rcvcountry in_degree_centrality out_degree_centrality\n  <chr>         <chr>      <chr>                     <dbl>                 <dbl>\n1 Mar del Este… Merigrad   Oceanus                     400                     0\n2 hǎi dǎn Corp… Marebak    Oceanus                     337                     0\n3 Caracola del… Puerto Sol Oceanus                     363                     0\n4 Costa de la … Alverossia Oceanus                     181                     0\n5 Pao gan SE S… Alverossia Oceanus                     150                     0\n# ℹ 6 more variables: degree_centrality <dbl>, eigen_centrality <dbl>,\n#   combined_centrality <dbl>, node_type <chr>, community <fct>,\n#   in_degree_centrality_community <dbl>"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html",
    "href": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html",
    "title": "Take Home_Ex03",
    "section": "",
    "text": "The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. As part of the collaboration, FishEye’s analysts received import/export data for Oceanus’ marine and fishing industries.\nWith reference to Mini-Challenge 3 of VAST Challenge 2023 and by using appropriate static and interactive statistical graphics methods, we will be helping FishEye to identify companies that may be engaged in illegal fishing."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#install-and-launching-r-packages",
    "href": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#install-and-launching-r-packages",
    "title": "Take Home_Ex03",
    "section": "3.1 Install and launching R packages",
    "text": "3.1 Install and launching R packages\nThe code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:\n\npacman::p_load(jsonlite,tidygraph,ggraph,visNetwork,tidyverse,graphlayouts, ggforce, tidytext)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#loading-the-data",
    "href": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#loading-the-data",
    "title": "Take Home_Ex03",
    "section": "3.2 Loading the Data",
    "text": "3.2 Loading the Data\nfromJSON() of jsonlite package is used to import MC3.json into R environment.\n\nMc3_data <- fromJSON(\"data/MC3.json\")\n\n\nmc3_edges <- as_tibble(Mc3_data$links)\n\n\nmc3_edges <- as_tibble(Mc3_data$links) %>%\n  distinct() %>%\n  mutate(source = as.character(source),\n         target = as.character(target),\n         type = as.character(type)) %>%\n  group_by(source, target, type) %>%\n  summarise(weights = n()) %>%\n  filter(source != target) %>%\n  ungroup()\n\n\nmc3_nodes <- as_tibble(Mc3_data$nodes) %>%\n  mutate(country = as.character(country),\n         id = as.character(id),\n         product_services = as.character(product_services),\n         revenue_omu = as.numeric(as.character(revenue_omu)),\n         type = as.character(type)) %>%\n  select(id, country, type, revenue_omu, product_services) #select() used to organise the sequence of col"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#data-wrangling",
    "href": "Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html#data-wrangling",
    "title": "Take Home_Ex03",
    "section": "3.3 Data Wrangling",
    "text": "3.3 Data Wrangling"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#calculating-the-in-out-and-total-degree-centrality-of-the-nodes",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#calculating-the-in-out-and-total-degree-centrality-of-the-nodes",
    "title": "Take Home_Ex02",
    "section": "4.1 Calculating the in, out and total degree centrality of the nodes",
    "text": "4.1 Calculating the in, out and total degree centrality of the nodes\nDegree centrality is a measure of immediate connection in a network. It could be interpreted as immediate reach in a social network.Eigenvector centrality is a measure that takes into account both the number of connections that a node or an actor has, and the degree of influence that the node’s immediate connections have in the entire network.\nWe will calculate the in, out and total degree centrality of the nodes, and use mutate() to create new columns to store these values.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n# Calulate the in, out and total degree centrality and add 3 new columns via mutate() to store the values \nmc2_graph <- mc2_graph %>%\n  activate(nodes) %>%\n  mutate(\n    in_degree_centrality = centrality_degree(mode = \"in\"),\n    out_degree_centrality = centrality_degree(mode = \"out\"),\n    degree_centrality = centrality_degree(mode = \"all\"),\n    eigen_centrality = centrality_eigen()\n  ) %>%\n  mutate(combined_centrality = degree_centrality * eigen_centrality) %>%\n  arrange(desc(combined_centrality)) \nmc2_graph\n\n\n# A tbl_graph: 930 nodes and 4670 edges\n#\n# A directed acyclic multigraph with 27 components\n#\n# A tibble: 930 × 8\n  id            shpcountry rcvcountry in_degree_centrality out_degree_centrality\n  <chr>         <chr>      <chr>                     <dbl>                 <dbl>\n1 \"Mar del Est… Merigrad   Oceanus                     400                     0\n2 \"Caracola de… Puerto Sol Oceanus                     363                     0\n3 \"hǎi dǎn Cor… Marebak    Oceanus                     337                     0\n4 \"Costa de la… Alverossia Oceanus                     181                     0\n5 \"Blue Horizo… Osterivar… <NA>                          0                   108\n6 \"Sea Breezes… Isliandor  Coralmari…                    0                   117\n# ℹ 924 more rows\n# ℹ 3 more variables: degree_centrality <dbl>, eigen_centrality <dbl>,\n#   combined_centrality <dbl>\n#\n# A tibble: 4,670 × 6\n   from    to hscode  Year weights median_weight\n  <int> <int> <chr>  <dbl>   <int>         <dbl>\n1   788   158 306170  2031      12        21078.\n2   279     7 160414  2030      12         9985 \n3   279     7 160414  2031      21         8815 \n# ℹ 4,667 more rows\n\n\nBelow code chunk to find out the top 20 id that has a high combined degree and eigenvector centrality score.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n#Select the top 20 IDs based on centrality value\ntop_20_ids <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  pull(id) %>%\n  head(20)\n\ntop_20_ids\n\n\n [1] \"Mar del Este CJSC\"                   \"Caracola del Sol Services\"          \n [3] \"hǎi dǎn Corporation Wharf\"           \"Costa de la Felicidad Shipping\"     \n [5] \"Blue Horizon Family &\"               \"Sea Breezes S.A. de C.V. Freight \"  \n [7] \"Selous Game Reserve  S.A. de C.V.\"   \"Playa de Arena OJSC Express\"        \n [9] \"Pao gan SE Seal\"                     \"Pao gan LC Freight \"                \n[11] \"AquaDelight N.V. Coral Reef\"         \"Balkan Cat ОАО Transport\"           \n[13] \"Madagascar Coast  AG Freight \"       \"Shou gan  Oyj Overseas\"             \n[15] \"Lake Tana  & Son's\"                  \"Daniel Ferry N.V. Transit\"          \n[17] \"Caracola del Este Ltd. Liability Co\" \"Viento Azul N.V. Distribution\"      \n[19] \"Tripura  Market S.A. de C.V.\"        \"The Sea Turtle GmbH & Co. KG\"       \n\n\nBsed on the table above, we can see that the top 20 actors with high combined degree and eigen centrality value, include Mar del Este CJSC, Caracola del Sol Services and hǎi dǎn Corporation Wharf.\n\n\n\n\n\n\nThings to learn\n\n\n\nactivate() is used to make the nodes of mc2_graph active to calculate the degree centrality.\nmutate() function from the dplyr package is used to add two new columns, in_degree_centrality and out_degree_centrality, to the nodes of the mc2_graph object"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#visualising-the-network-graph-with-ggraph",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#visualising-the-network-graph-with-ggraph",
    "title": "Take Home_Ex02",
    "section": "4.3 Visualising the network graph with ggraph",
    "text": "4.3 Visualising the network graph with ggraph\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nggraph(mc2_graph,\n       layout = \"fr\") +\n  geom_edge_link(aes(width=weights), \n                 alpha=0.2) +\n  geom_node_point(aes(colour = node_type)) +\n  theme_graph() +\n  labs(title = \"Network graph of global transhipment activities\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#flag-based-network",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#flag-based-network",
    "title": "Take Home_Ex02",
    "section": "4.4 Flag Based Network",
    "text": "4.4 Flag Based Network\nTo gain a better understanding of the prevalence of the types of flags in the transshipment events, we can find out which country the vessels tends to be most often associated with when shipping.\nAnd we can see that vessels tend to ship to Merigrad and Marebak.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\ncountry_id_counts_shp <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  filter(in_degree_centrality == 0) %>% # filter out for the vessels \n  group_by(shpcountry) %>%\n  summarise(id_count = n_distinct(id)) %>%\n  arrange(desc(id_count))\n\nhead(country_id_counts_shp)\n\n\n# A tibble: 6 × 2\n  shpcountry   id_count\n  <chr>           <int>\n1 Merigrad           97\n2 Marebak            78\n3 Vesperanda         54\n4 Mawazam            52\n5 Osterivaria        49\n6 Arreciviento       31\n\n\nAlso, we can see that for transshipment, companies are most often associated with Oceanus when receiving their products.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\ncountry_id_counts_rcv <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  filter(out_degree_centrality == 0) %>% # filter out for the vessels \n  group_by(rcvcountry) %>%\n  summarise(id_count = n_distinct(id)) %>%\n  arrange(desc(id_count))\n\nhead(country_id_counts_rcv)\n\n\n# A tibble: 6 × 2\n  rcvcountry   id_count\n  <chr>           <int>\n1 Oceanus           362\n2 Coralmarica        13\n3 Sol y Oceana        5\n4 Utoporiana          2\n5 Icarnia             1\n6 Kethilim            1"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#top-20-transshipment-companies-trading-frequencies",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#top-20-transshipment-companies-trading-frequencies",
    "title": "Take Home_Ex02",
    "section": "4.5 Top 20 transshipment companies trading frequencies",
    "text": "4.5 Top 20 transshipment companies trading frequencies\nCheck out the trading frequencies of the top 20 transshipment companies trading frequencies over the years. These top 20 companies are those who has high in-degree centrality.\nWe can see that the total transactions fluctuates more for Caracola del Sol Services, Mar del Este CJSC and Pao gan SE Seal.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n#Select the top 20 IDs based on centrality value\ntop_20_ids <- mc2_graph %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  arrange(desc(in_degree_centrality)) %>%\n  pull(id) %>%\n  head(20)\n\n# Filter the mc2_edges_aggregated_top dataframe\nfiltered_edges_entities <- mc2_edges_aggregated_top %>%\n  filter(target %in% top_20_ids) %>%\n  group_by(Year, target) %>%\n  summarise(total_weight = sum(weights))\n\n# Plot the aggregated weights\np <- ggplot(filtered_edges_entities, aes(x = Year, y = total_weight, color = target)) +\n  geom_line() +\n  geom_point() +\n  labs(x = \"Year\", y = \"Total transactions\", title = \"Number of Transactions by Year\") +\n  scale_color_discrete(name = \"Target Entity\")\n\nggplotly(p)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#plotting-the-visnetwork-graph-of-transshipment-leader",
    "href": "Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html#plotting-the-visnetwork-graph-of-transshipment-leader",
    "title": "Take Home_Ex02",
    "section": "4.7 Plotting the visNetwork graph of transshipment leader",
    "text": "4.7 Plotting the visNetwork graph of transshipment leader\nNext, we will further investigate our highest transshipment node, Mar del Este CJSC, by plotting its network graph over the years from 2028-2034 to see if we can find any insights.\nLooking at the network graph below, we can see that initially in 2028, Marine Mates NV Worldwide and ReefRider Foods Lte Corporation Family supplies goods to Mar del Este CSJC but disappears in 2029. And in 2032, there are 2 new suppliers, The Salty Dog Limited Liability Company and Turkish Salmon A/S Marine, however, both disappeared in 2034.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n# Filter the year and id in edges and the corresponding id\nfiltered_graph_2028 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2028, to == 1)\n\nunique_ids_2028 <- unique(c(filtered_graph_2028 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2028 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2028 <- filtered_graph_2028 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2028) %>%\n  as_tbl_graph()\n\nedges_df_2028 <- filtered_graph_2028 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2028 <- filtered_graph_2028 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2028<- nodes_df_2028 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2028 <- visNetwork(nodes_df_2028, edges_df_2028, submain = list(text = \"Network Graph of Mar del Este CJSC in 2028 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE)\nvis_2028\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n# Filter the year and id in edges and the corresponding id\nfiltered_graph_2029 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2029, to == 1)\n\nunique_ids_2029 <- unique(c(filtered_graph_2029 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2029 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2029 <- filtered_graph_2029 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2029) %>%\n  as_tbl_graph()\n\nedges_df_2029 <- filtered_graph_2029 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2029 <- filtered_graph_2029 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2029<- nodes_df_2029 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2029 <- visNetwork(nodes_df_2029, edges_df_2029, submain = list(text = \"Network Graph of Mar del Este CJSC in 2029 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE)\nvis_2029\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nfiltered_graph_2030 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2030, to == 1)\n\nunique_ids_2030 <- unique(c(filtered_graph_2030 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2030 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2030 <- filtered_graph_2030 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2030) %>%\n  as_tbl_graph()\n\nedges_df_2030 <- filtered_graph_2030 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2030 <- filtered_graph_2030 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2030<- nodes_df_2030 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2030 <- visNetwork(nodes_df_2030, edges_df_2030, submain = list(text = \"Network Graph ofMar del Este CJSC in 2030 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE) \nvis_2030\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nfiltered_graph_2031 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2031, to == 1)\n\nunique_ids_2031 <- unique(c(filtered_graph_2031 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2031 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2031 <- filtered_graph_2031 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2031) %>%\n  as_tbl_graph()\n\nedges_df_2031 <- filtered_graph_2031 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2031 <- filtered_graph_2031 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2031<- nodes_df_2031 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2031 <- visNetwork(nodes_df_2031, edges_df_2031, submain = list(text = \"Network Graph ofMar del Este CJSC in 2031 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE) \nvis_2031\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nfiltered_graph_2032 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2032, to == 1)\n\nunique_ids_2032 <- unique(c(filtered_graph_2032 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2032 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2032 <- filtered_graph_2032 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2032) %>%\n  as_tbl_graph()\n\nedges_df_2032 <- filtered_graph_2032 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2032 <- filtered_graph_2032 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2032<- nodes_df_2032 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2032 <- visNetwork(nodes_df_2032, edges_df_2032, submain = list(text = \"Network Graph ofMar del Este CJSC in 2032 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE) \nvis_2032\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nfiltered_graph_2033 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2033, to == 1)\n\nunique_ids_2033 <- unique(c(filtered_graph_2033 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2033 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2033 <- filtered_graph_2033 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2033) %>%\n  as_tbl_graph()\n\nedges_df_2033 <- filtered_graph_2033 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2033 <- filtered_graph_2033 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2033<- nodes_df_2033 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2033 <- visNetwork(nodes_df_2033, edges_df_2033, submain = list(text = \"Network Graph ofMar del Este CJSC in 2033 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE) \nvis_2033\n\n\n\n\n\n\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nfiltered_graph_2034 <- mc2_graph %>%\n  activate(edges) %>%\n  filter(Year == 2034, to == 1)\n\nunique_ids_2034 <- unique(c(filtered_graph_2034 %>%\n                         activate(edges) %>%\n                         pull(from),\n                       filtered_graph_2034 %>%\n                         activate(edges) %>%\n                         pull(to)))\n\nfiltered_graph_2034 <- filtered_graph_2034 %>%\n  activate(nodes) %>%\n  filter(row_number() %in% unique_ids_2034) %>%\n  as_tbl_graph()\n\nedges_df_2034 <- filtered_graph_2034 %>%\n  activate(edges) %>%\n  as_tibble()\n\nnodes_df_2034 <- filtered_graph_2034 %>%\n  activate(nodes) %>%\n  as_tibble() %>%\n  rename(label = id) %>%\n  mutate(id=row_number()) %>%\n  select(everything()) %>%\n  relocate(id, .before = label)\n\nnodes_df_2034<- nodes_df_2034 %>%\n  rename(group = node_type) \n\n# Plot the network graph with labeled nodes using visNetwork\nvis_2034 <- visNetwork(nodes_df_2034, edges_df_2034, submain = list(text = \"Network Graph ofMar del Este CJSC in 2034 \",\n                          style = \"font-family:Comic Sans MS;color:#000000;font-size:15px;text-align:center;\")) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n  ) %>%\n  visLegend() %>%\n  visInteraction(zoomView = TRUE, dragNodes = TRUE, dragView = TRUE, navigationButtons = TRUE) \nvis_2034"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html",
    "title": "Take-Home_Ex01",
    "section": "",
    "text": "This exercise aims to discover the demographic, financial characteristics and hidden patterns of the City of Engagement, using static and interactive statistical graphics methods. The data will be processed using appropriate tidyverse packages and visualization will be designed using ggplot2 and its extensions."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#install-and-launching-r-packages",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#install-and-launching-r-packages",
    "title": "Take-Home_Ex01",
    "section": "3.1 Install and launching R packages",
    "text": "3.1 Install and launching R packages\nThe code chunk below uses p_load() of pacman package to check if packages are installed in the computer. If they are, then they will be launched into R. The R packages installed are:\n\nplotly: R library for plotting interactive statistical graphs.\nggstatsplot: Used for creating graphics with details from statistical tests.\ngganimate: an ggplot extension for creating animated statistical graphs.\ngifski: converts video frames to GIF animations using pngquant’s fancy features for efficient cross-frame palettes and temporal dithering. It produces animated GIFs that use thousands of colors per frame.\nknitr: Used for dynamic report generation\npatchwork: Used to combine plots\nggdist: Used for visualization distribution and uncertainty\nggthemes: Provide additional themes for ggplot2\nggrepel: A package in R used for avoiding overplotting of text labels\ngt:For creating and styling publication-quality tables in R\nrstatix: Used for statistical analysis and data visualization\nggridges: For creating ridge plots\nviridis: An R package that provides a set of color palettes for data visualization\nggiraph: For making ‘ggplot’ graphics interactive\nreshape2: Provides functions for transforming and reshaping data between “wide” and “long” formats\nscales: Provides a set of functions for formatting and labeling data for visualization\ntidyverse: A family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.\n\n\npacman::p_load(plotly, ggstatsplot, knitr, patchwork, ggdist, ggthemes,ggrepel, tidyverse,gt,rstatix,ggpmisc,ggridges,gganimate,viridis,ggiraph,reshape2,scales, performance,ggalt,ggpubr,crosstalk, ungeviz, ggdist, colorspace)"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#importing-the-data",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#importing-the-data",
    "title": "Take-Home_Ex01",
    "section": "3.2 Importing the Data",
    "text": "3.2 Importing the Data\n\nparticipants <- read_csv(\"data/Participants.csv\")\nfinancial <- read_csv(\"data/FinancialJournal.csv\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#data-wrangling",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#data-wrangling",
    "title": "Take-Home_Ex01",
    "section": "3.3 Data Wrangling",
    "text": "3.3 Data Wrangling\n\n3.3.1 Check for missing values in each column in the participants and financial data\n\n# Check for missing values in each column in participants data\ncolSums(is.na(participants))\n\n participantId  householdSize       haveKids            age educationLevel \n             0              0              0              0              0 \n interestGroup      joviality \n             0              0 \n\n# Check for missing values in each column\ncolSums(is.na(financial))\n\nparticipantId     timestamp      category        amount \n            0             0             0             0 \n\n\n\n\n3.3.2 Data Issues\nUsing glimpse(), we can look at the data types of the datasets.\n\nglimpse(participants)\n\nRows: 1,011\nColumns: 7\n$ participantId  <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…\n$ householdSize  <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…\n$ haveKids       <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…\n$ age            <dbl> 36, 25, 35, 21, 43, 32, 26, 27, 20, 35, 48, 27, 34, 18,…\n$ educationLevel <chr> \"HighSchoolOrCollege\", \"HighSchoolOrCollege\", \"HighScho…\n$ interestGroup  <chr> \"H\", \"B\", \"A\", \"I\", \"H\", \"D\", \"I\", \"A\", \"G\", \"D\", \"D\", …\n$ joviality      <dbl> 0.001626703, 0.328086500, 0.393469590, 0.138063446, 0.8…\n\n\n\nglimpse(financial)\n\nRows: 1,513,636\nColumns: 4\n$ participantId <dbl> 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6,…\n$ timestamp     <dttm> 2022-03-01, 2022-03-01, 2022-03-01, 2022-03-01, 2022-03…\n$ category      <chr> \"Wage\", \"Shelter\", \"Education\", \"Wage\", \"Shelter\", \"Educ…\n$ amount        <dbl> 2472.50756, -554.98862, -38.00538, 2046.56221, -554.9886…\n\n\nISSUE 1: WRONG DATA FORMAT\nparticipantId is in <dbl> format. It needs to be converted to <chr>.\n\nparticipants$participantId <- as.character(participants$participantId)\n#str(participants)--> to check if data type has been changed\n\nfinancial$participantId <- as.character(financial$participantId)\n#str(financial) --> to check if data type has been changed\n\nISSUE 2: CHANGE TIMESTAMP TO MONTH_YEAR FORMAT\nExtract the month and year using lubridate.\n\nfinancial$month_year <- floor_date(as.POSIXct(financial$timestamp), unit = \"month\")\nfinancial$month_year <- format(financial$month_year, format = \"%m/%Y\")\n\n# Convert month_year to date format\nfinancial$month_year <- as.Date(paste0(\"01/\", financial$month_year), format = \"%d/%m/%Y\")\n\n#head(financial) --> check if new col month_year is created \n\nISSUE 3: DUPLICATES FOUND IN DATA\nCheck for duplicates in both dataset using the following code chunk,\n\n#Check for duplicates in financial table\nsum(duplicated(financial))\n\n[1] 1113\n\n#Check for duplicates in participants table\nsum(duplicated(participants))\n\n[1] 0\n\n#Remove duplicates in financial table\nfinancial_unique <- distinct(financial)\nnrow(financial_unique)\n\n[1] 1512523\n\n\nISSUE 4: DATA IS SEGREGATED BY INDIVDUAL ENTRIES\nGroup the entries by participants taking into consideration month_year and category and summing up the amount.\n\n# Group by participant_id and month_year, subgroup by category, then summarize by amount\nnew_financial <- financial_unique %>%\n  group_by(participantId, month_year, category) %>%\n  summarise(total_amount = sum(amount)) %>%\n  mutate(total_amount = round(total_amount, 2))\n\n# Pivot the table so that the categories appear as columns\nnew_financial_wide <- new_financial %>% \n  pivot_wider(names_from = category, values_from = total_amount)\n\nNext, check if columns have missing value, if yes, replace the missing values with 0\n\n# Check if any columns has missing value \ncolSums(is.na(new_financial_wide))\n\n participantId     month_year      Education           Food     Recreation \n             0              0           7673              0           1199 \n       Shelter           Wage RentAdjustment \n           131              0          10619 \n\n# replace missing values with 0\nnew_financial_wide <- new_financial_wide %>% \n  mutate_all(~replace_na(., 0))\n\nISSUE 5: DATA DOES NOT SHOW FINANCIAL HEALTH AND COST OF LIVING\nFinancial Health = Sum (Wage + Education + Shelter + Recreation + Food + RentAdjustment)\n\nnew_financial_wide$Financial_health <- rowSums(new_financial_wide[, c(\"Wage\", \"Education\",\"Shelter\",\"Recreation\",\"Food\",\"RentAdjustment\" )], na.rm = TRUE)\n\nCost_of_living = Sum(Education + Shelter + Recreation + Food)\n\nnew_financial_wide$Cost_of_living <- rowSums(new_financial_wide[,c(\"Education\",\"Shelter\",\"Recreation\",\"Food\")], na.rm = TRUE)\nnew_financial_wide$Cost_of_living <- new_financial_wide$Cost_of_living * -1\n\nISSUE 6: AGE DATA ARE NOT AGGREGATED\nBin age data by groups of 10.\n\nparticipants <- participants %>%\n  mutate(age_bin = cut(age, \n                       breaks = c(seq(max(age), min(age) - 10, -10), min(age)), \n                       right = FALSE, \n                       include.lowest = TRUE, \n                       labels = NULL))\n\n# Replace the numeric bin labels with age ranges\nparticipants$age_bin <- sub(\"(\\\\d+)-(\\\\d+)\", \"\\\\1-\\\\2\", as.character(participants$age_bin))\nparticipants$age_bin[participants$age_bin == paste0(max(participants$age_bin), \"-\")] <- paste0(\"<= \", max(as.numeric(levels(participants$age_bin)))-1)\n\n# Display the first 10 rows of the new data frame with age_bin column\n#head(participants, 10)\n\nISSUE 7: PARTICIPANTS DATA AND FINANCIAL DATA ARE SEPARATED\nCombine the two tables together by participantId\n\ncombined_table <- merge(participants, new_financial_wide, by = \"participantId\")\nDT::datatable(combined_table, class= \"compact\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#demographic-analysis",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#demographic-analysis",
    "title": "Take-Home_Ex01",
    "section": "4.1 Demographic Analysis",
    "text": "4.1 Demographic Analysis\n\n4.1.1 Distribution of Income and Age\n\nDistribution of Income\nWe will first take a look at the Income Distribution using histogram and boxplot.\nBased on the boxplot plotted, we can observe that the minimum income is $1600, which means that all the participants are considering under the working population and we can analyse them as a whole.\nFurthermore, we can observe from the shape of the wage distribution that there is income inequality in the city. It has a right-skewed distribution, i.e. mean wage > median wage, where there is very few high earners at the top and majority falls under the middle and bottom.\n\n\nShow the code\n#computing summary statistics of mean, median and lower and upper whiskers in boxplot\nwage_mean <- round(mean(combined_table$Wage))\nwage_median <- round(median(combined_table$Wage))\nymax <- as.numeric(round((IQR(combined_table$Wage)*1.5) +\n                quantile(combined_table$Wage,0.75)))\nymin <- as.integer(min(combined_table$Wage))\n\n#plotting histogram\nh_wage <- ggplot(data = combined_table, aes(x = Wage)) + \n  geom_histogram(color=\"black\", fill=\"azure4\", binwidth = 500) + \n  scale_x_continuous(limits = c(0,25000), labels = scales::comma) +\n  labs(x = \"Wage\", y = \"Number of participants\") +\n  geom_vline(aes(xintercept = wage_mean), col=\"darkblue\", linewidth=0.75) +\n  annotate(\"text\", x=5900, y=1700, label=\"Mean wage:\", \n           size=3, color=\"darkblue\") +\n  annotate(\"text\", x=5600, y=1550, label=format(wage_mean, big.mark = \",\"),\n           size=3, color=\"darkblue\") +\n  geom_vline(aes(xintercept = wage_median), col=\"lightpink4\", linewidth=0.75) +\n  annotate(\"text\", x=1900, y=1700, label=\"Median wage\", \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=1900, y=1600, label=format(wage_median, big.mark = \",\"),\n           size=3, color=\"lightpink4\") +\n  theme(axis.text.x = element_text(size=8))\n\n#plotting boxplot\nb_wage <- ggplot(data = combined_table, aes(y = Wage)) + \n  geom_boxplot(outlier.colour=\"firebrick\", outlier.shape=16,\n               outlier.size=0.6, notch=FALSE, width = 0.25) + \n  coord_flip() + labs(y = \"\", x = \"\") + \n  scale_y_continuous(limits = c(0,25000), labels = scales::comma) +\n  theme(axis.text = element_blank(), axis.ticks = element_blank()) + \n  stat_boxplot(geom=\"errorbar\", width=0.25) + \n  annotate(\"text\", x=0.20, y=ymax, label=format(ymax, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=0.20, y=ymin, label=format(ymin, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=-0.25, y=5000, label=format(wage_median, big.mark = \",\"),\n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=-0.25, y=2500, label=\"Median wage =\",\n           size=3, color=\"lightpink4\")\n\n# combine the 2 plots \n\nwage_distri <- b_wage / h_wage + plot_layout(heights = c(1, 2)) \n\nwage_distri + plot_annotation(title = \"Distribution of Wage\", \n                               subtitle = str_wrap(\"There is a right-skewed distribution i.e. mean wage > median wage. There is also a large number of outliers (wage >$9,110).\", width =60),\n                               theme = theme(\n                                 plot.title = element_text(size = 18),\n                                 plot.subtitle = element_text(size = 12)))\n\n\n\n\n\nTo confirm that the wage distribution is indeed not normally distributed, we will perform the normality assumption test. But before performing the normality assumption test, we will first create the meanwage_table as shown in the code chunk below,\n\n# Create mean wage table \nmeanwage_table <- combined_table %>%\n  group_by(participantId) %>%\n  summarize(mean_wage = mean(Wage))\n#head(meanwage_table)\n\nNext, we will use the Q-Q Plot to visualize if normal distribution exist.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\nqq <- ggplot(meanwage_table,\n       aes(sample=mean_wage))+\n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"Normal Q-Q Plot of Income\")\n\nsw_t <- meanwage_table %>%\n  shapiro_test(mean_wage) %>%\n  gt() #make it to gt format to give a nice table\n\ntmp <- tempfile(fileext = '.png')\ngtsave(sw_t, tmp)\ntable_png <- png::readPNG(tmp,native=TRUE) #sw_t cant be recognised by patchwork so change it to png\n\nqq + table_png\n\n\n\n\n\nLooking at Normal Quartile Plot (Q-Q plot), we can see that the points deviate significantly from the straight diagonal line. The results of the Shaprio-test above also suggest that there is sufficient statistical evidence to reject the null hypothesis at 95% confidence. Thus, the set of data is indeed not normally distributed, showing that the city has income inequality.\n\n\nDistribution of Age\nSimilarly, we will use histogram and boxplot to show the age distribution.\nThe boxplot below shows that the minimum age is 18 and the maximum age is 60, which is most likely the retirement age. The histogram shows that the age is normally distributed,where the mean age equals the median age of 39. Thus, it appears that the city of engagement does not need to worry about aging population, which in turn meant that they do not need to invest in improving birth rate.\nHowever, based on the pie chart, we can see that though the starting age is 18, only 5% of the working population is below the age of 21. This is probably because most are still studying at that age and are not actively working.\n\n\nShow the code\nage_count <- combined_table %>%\n  group_by(age_bin) %>%\n  summarize(\n    count = n_distinct(participantId)) %>% \n  mutate(prop_count = as.numeric(count) / n_distinct(as.numeric(combined_table$participantId)),\n         age_pie_pct = round(prop_count * 100)) %>% \n  mutate(ypos_p = rev(cumsum(rev(age_pie_pct))),\n         pos_p = age_pie_pct/2 + lead(ypos_p, 1, default = 0),\n         pos_p = if_else(is.na(pos_p), age_pie_pct/2, pos_p))\n\npie_age <- ggplot(age_count, aes(x = \"\" , y = age_pie_pct, fill = fct_inorder(age_bin))) +\n  geom_col(width = 1, color = 1) +\n  coord_polar(theta = \"y\") +\n  scale_fill_brewer(palette = \"YlGnBu\") +\n  geom_label_repel(data = age_count,\n                   aes(y = pos_p, label = paste0(age_pie_pct, \"%\")),\n                   size = 4.5, nudge_x = 1, color = c(1, 1, 1, 1, 1), show.legend = FALSE) +\n  guides(fill = guide_legend(title = \"Age Bin\")) +\n  labs(title = \"Proportion of participants in each Age Bin\") +\n  theme(legend.position = \"bottom\",\n        plot.title = element_text(face = \"bold\")) +\n  theme_minimal() \n\n\n\n\nShow the code\n#computing summary statistics of mean, median and lower and upper whiskers in boxplot for AGE\nage_mean <- round(mean(combined_table$age))\nage_median <- round(median(combined_table$age))\nymax <- max(combined_table$age)\nymin <- as.integer(min(combined_table$age))\n\n#plotting histogram for AGE\nh_age <- ggplot(data = combined_table, aes(x = age)) + \n  geom_histogram(color=\"black\", fill=\"azure4\", binwidth = 4) + \n  scale_x_continuous(limits = c(0,70), labels = scales::comma) +\n  labs(x = \"Age\", y = \"Number of participants\") +\n  geom_vline(aes(xintercept = age_mean), col=\"black\", linewidth=0.75) +\n  annotate(\"text\", x=48, y=1700, label=\"Mean age:\", \n           size=3, color=\"black\") +\n  annotate(\"text\", x=48, y=1600, label=format(age_mean, big.mark = \",\"),\n           size=3, color=\"black\") +\n  geom_vline(aes(xintercept = age_median), col=\"black\", linewidth=0.75) +\n  annotate(\"text\", x=30, y=1750, label=\"Median age:\", \n           size=3, color=\"black\") +\n  annotate(\"text\", x=30, y=1650, label=format(age_median, big.mark = \",\"),\n           size=3, color=\"black\") +\n  theme(axis.text.x = element_text(size=8))\n\n#plotting boxplot for AGE\nb_age <- ggplot(data = combined_table, aes(y = age)) + \n  geom_boxplot(outlier.colour=\"firebrick\", outlier.shape=16,\n               outlier.size=1, notch=FALSE, width =0.2) + \n  coord_flip() + labs(y = \"\", x = \"\") + \n  scale_y_continuous(limits = c(0,70), labels = scales::comma) +\n  theme(axis.text = element_blank(), axis.ticks = element_blank()) + \n  stat_boxplot(geom=\"errorbar\", width=0.2) + \n  annotate(\"text\", x=0.15, y=ymax, label=format(ymax, big.mark = \",\"), \n           size=3, color=\"lightpink4\") +\n  annotate(\"text\", x=0.15, y=ymin, label=format(ymin, big.mark = \",\"), \n           size=3, color=\"lightpink4\") \n  #annotate(\"text\", x=-0.25, y=50, label=format(age_median, big.mark = \",\"),\n           #size=3, color=\"lightpink4\") \n  #annotate(\"text\", x=-0.25, y=25, label=\"Median age =\",\n           #size=3, color=\"lightpink4\")\n\nage_distri <- b_age / h_age + plot_layout(heights = c(1, 2)) \n\n# age_distri + plot_annotation(title = \"Distribution of Age\", \n#                                subtitle = \"There is a normal distribution i.e. mean age = median age\",\n#                                theme = theme(\n#                                  plot.title = element_text(size = 18),\n#                                  plot.subtitle = element_text(size = 12)))\n\n\n\n\nShow the code\n#combine the age_distri plot dervied earlier with the pie_age plot\nage_distri_pie <- (age_distri | pie_age) + plot_layout(widths = c(3,3))\n\nage_distri_pie + plot_annotation(title = \"Distribution of Age\", \n                               theme = theme(\n                                 plot.title = element_text(size = 16)))\n\n\n\n\n\n\n\n\n4.1.2 Income by Age\nLet’s find out if income is affected by age.\nTo compare the income level across ages, we will test the following null hypothesis:\nH0: the mean wage across different age groups are the same\nH1: the mean wage across different age groups are different\nTo start the confirmatory data analysis, we first perform the normality assumption test for the distribution of income and age. Normality assumption test for income has been performed previously.\nPlot the qqplot for income and age.\n\n\nShow the code\n#| echo: false\n#| fig-width: 3\n#| fig-height: 3\n\n# Create age table \nunique_participants <- unique(subset(combined_table, select = c(\"participantId\", \"age\")))\nhead(unique_participants)\n\n\n   participantId age\n1              0  36\n13             1  25\n25            10  48\n37           100  29\n49          1000  56\n61          1001  49\n\n\nShow the code\nqq_age <- ggplot(unique_participants,\n       aes(sample=age))+\n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"Normal Q-Q Plot of Age\")\n\nsw_t_age <- unique_participants %>%\n  shapiro_test(age) %>%\n  gt() #make it to gt format to give a nice table\n\ntmp_age <- tempfile(fileext = '.png')\ngtsave(sw_t_age, tmp_age)\ntable_png_age <- png::readPNG(tmp_age,native=TRUE) #sw_t cant be recognised by patchwork so change it to png\n\n(qq_age + table_png_age) / (qq + table_png)\n\n\n\n\n\nBased on the Shapiro test, both the p-value are < alpha value of 0.05, thus there is sufficient statistical evidence to conclude that the distribution of income and age are not normally distributed. Thus we will perform the non-parametric test, Oneway ANOVA Test.\n\n\nShow the code\nggbetweenstats(\n  data = combined_table,\n  x = age_bin, \n  y = Wage,\n  type = \"np\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"ns\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE,\n  ylim = c(0, 25000)\n) +\nggtitle(\"Oneway ANNOVA - Income across different age\")\n\n\n\n\n\nThe Kruskal-Wallis Test p-value is lower than the alpha values, thus there is sufficient statistical evidence to reject the null hypothesis and infer that the mean income across age is not the same.\nWe can observe that there are few pairs of age_bin with p-value > 0.05 such as [40,50) and [50,60]. This suggests that the differences between the medians of the pair are not statistically significant.\nWe can also observe that there is a higher wage median for those age 30-40. After the age of 40, it seems that the increase in age is not consistent with the increase in wage. The 2 highest wage level are from the opposite ends of the age spectrum. Though these are outliers, it suggests that age is not the limiting factor for high wage tier. It does not necessary mean that an individual has to be older to earn a higher income.\n\n\n4.1.3 Financial Health Observation\n\nCumulative Financial Health\nCreate a table to plot the cumulative financial health to see if there are cumulative savings in the city.\n\n# Create a data frame\ndf_totalfh <- combined_table %>%\n  group_by(month_year) %>%\n  summarise(total_fh = sum(Financial_health))\n\n#head(df_totalfh)\n\n\n\nShow the code\n# calculate cumulative financial health\ndf_totalfh <- df_totalfh %>% \n  mutate(cumulative_fh = cumsum(total_fh))\n\nhead(df_totalfh)\n\n\n# A tibble: 6 × 3\n  month_year total_fh cumulative_fh\n  <date>        <dbl>         <dbl>\n1 2022-03-01 4832812.      4832812.\n2 2022-04-01 2204851.      7037663.\n3 2022-05-01 2403220.      9440883.\n4 2022-06-01 2421291.     11862173.\n5 2022-07-01 2272492.     14134666.\n6 2022-08-01 2574129.     16708794.\n\n\nShow the code\n# Calculate y-axis breaks and labels\ny_breaks <- pretty_breaks(n = 3)(range(df_totalfh$cumulative_fh))\ny_labels <- dollar_format(prefix = \"$\")(y_breaks)\n\n# plot graph\nggplot(data = df_totalfh, aes(x = month_year, y = cumulative_fh)) +\n  geom_line() +\n  labs(x = \"Month/Year\", y = \"Cumulative Financial Health\", title = \"Cumulative Financial Health Over Time\") +\n  stat_summary(geom = \"line\", fun = \"cumsum\", linetype = \"dashed\") +\n  scale_y_continuous(breaks = y_breaks, labels = y_labels) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  theme(plot.title = element_text(face = \"bold\"),\n        plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), \"cm\"))\n\n\n\n\n\nFrom the figure above, we can see that the city has cumulative savings across the months.\nDiving deeper into the financial health of the participants, we will plot the boxplot of the Financial Health vs Mean Financial Health. Based on the plot below, we can see that the mean of the financial health is at the highest in March 2022 at around $4800 and decreased significantly in April 2022. Between April 2022 to Feb 2023, financial health was maintained between $2,500 to $3,000.\n\n\nShow the code\np_fh <- ggplot(data = combined_table, aes(x = month_year, y = Financial_health, \n                                      tooltip = month_year)) +\n  geom_boxplot() +\n  geom_point(stat = \"summary\", fun.y = \"mean\", colour = \"red\", size = 1) +\n  geom_line(stat = \"summary\", fun.y = \"mean\", colour = \"red\", size = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(title = \"Financial Health Over Time\",\n       y = \"Financial Health\",\n       x = \"Month/Year\") +\n  theme(plot.title = element_text(hjust = 0.2, size = 12, face = 'bold'),\n        plot.margin = margin(20, 20, 20, 20),\n        legend.position = \"bottom\",\n        axis.text = element_text(size = 8, face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1),\n        axis.title.x = element_text(hjust = 0.5, size = 12, face = \"bold\"),\n        axis.title.y = element_text(hjust = 0.5, size = 12, face = \"bold\")) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b-%Y\")\n\nggplotly(p_fh, tooltip = c(\"x\", \"y\", \"tooltip\"))\n\n\n\n\n\n\nTo find out if financial health is affected by wage or cost of living, we use the correlogram to see the correlation between financial health and wage, cost of living and the various expense category. Based on the correlation table and the significant test of correlation, we can see that financial health and wage has a strong positive correlation of 0.98 , while cost of living has low negative correlation of -0.14.\nBased on the correlogram below, we can also observe that Recreation and Shelter have a high correlation with Cost of living.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c( \"Wage\", \"Financial_health\", \"Cost_of_living\", \"Food\", \"Shelter\", \"Recreation\", \"Education\", \"RentAdjustment\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Financial Health Correlation Table\")\n\n\n\n\n\n\nWage CorrelationCost of Living Correlation\n\n\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Wage,\n  y = Financial_health,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\n\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Cost_of_living,\n  y = Financial_health,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\n\n\nTo further explore each expense category over time, we will plot the different expense category over time.\n\n\nShow the code\n# group the expenses by month year\nexpenses_grouped <- combined_table %>%\n  group_by(month_year) %>%\n  summarize(total_recreation = mean(Recreation),\n            total_food = mean(Food),\n            total_shelter = mean(Shelter),\n            total_education = mean(Education))\n\n# plot the data using ggplot2\np_expense <- ggplot(expenses_grouped, aes(x = month_year)) + \n  geom_line(aes(y = total_recreation, color = \"Recreation\")) +\n  geom_line(aes(y = total_food, color = \"Food\")) +\n  geom_line(aes(y = total_shelter, color = \"Shelter\")) +\n  geom_line(aes(y = total_education, color = \"Education\")) +\n  labs(x = \"Month/Year\", y = \"Mean Expenses($)\") +\n  scale_y_continuous(limits = c(-1000, 0), \n                      breaks = seq(-1000, 0, 2*100),\n                      labels = dollar_format(prefix = \"$\")) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  ggtitle(\"Expenses Over time\") +\n  scale_color_manual(values = c(\"Recreation\" = \"red\", \n                                \"Food\" = \"blue\", \n                                \"Shelter\" = \"green\", \n                                \"Education\" = \"purple\")) +\n  theme(plot.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5)) \n\n\nAlso, we shall plot the wage over time to compare it with the expenses over time plot.\n\n\nShow the code\n# group the wage by month year\nwage_grouped <- combined_table %>%\n  group_by(month_year) %>%\n  summarize(mean_wage_bymonth = mean(Wage))\n\n# plot the data using ggplot2\np_meanwage <- ggplot(wage_grouped, aes(x = month_year)) + \n  geom_line(aes(y = mean_wage_bymonth)) +\n  labs(x = \"Month/Year\", y = \"Mean Wage($)\") +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m/%Y\") +\n  ggtitle(\"Expenses by Month/Year\") +\n  theme(plot.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))\n\n\nFor easier comparison, we shall combine the 2 plots together for better visualization.\n\nexpenses_wage <- p_expense + p_meanwage + plot_layout(heights = c(80, 50)) \nexpenses_wage\n\n\n\n\nLooking at the expenses over time plot above, it showed that education, food and shelter remained stable over time, which meant these costs are most likely fixed despite any wage fluctuations. Recreation expenses, on the hand, is high in March and decreases significantly from March 2022 to April 2022 and plateaus to a stable rate thereafter.\nLooking at the wage over time plot, we can see that in March, the mean income is at its peak in March 2022 and dips significantly in April 2022. April 2022 onward, the income remains relatively stable and starts to increase slightly in August 2022, but in Jan 2023 it start to decrease further. The fluctuations in the financial health and income is directly proportionate. And we can also see that, recreation expenses increases when there is an increase in income but remain low when income is low.\nSince this is an agricultural city, participants’ pay could be likely to be affected by the seasons and harvest.\n\n\nWage vs Cost of Living overtime\nLooking at the wage vs cost of living, we can see that on average, most citizens can cope with their cost of living as their mean wage (blue bars) is higher than the mean cost of living (red bars). Most citizens should still have savings monthly.\n\n# Creating a table with Wage and Cost of Living by month_year\n\n# Group the data by month and find the corresponding means\ndf_monthly <- combined_table %>%\n  group_by(month_year) %>%\n  summarise(mean_income = mean(Wage),\n            mean_cost_of_living = mean(Cost_of_living))\n# Melt the data frame to create a long format\ndf_monthly_melt <- melt(df_monthly, id.vars = \"month_year\", variable.name = \"variable\", value.name = \"value\")\n\n\n\nShow the code\n# Plot using ggplot2\nggplot(df_monthly_melt, aes(x = month_year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 25), alpha = 0.7) +\n  scale_fill_manual(name = \"Legend\", values = c(\"mean_income\" = \"blue\", \"mean_cost_of_living\" = \"red\")) +\n  labs(x = \"Month\", y = \"Mean\", title = \"Monthly Mean Income and Cost of Living\") +\n  scale_x_date(guide = guide_axis(angle = 45)) +\n  theme(axis.text.x = element_text(hjust = 0.4, vjust = 0.5, size = 5)) \n\n\n\n\n\n\n\n\n4.1.4 Observation on Education Level\n\nEducation affects financial health and birth rate\nTo see if education affects financial health and birth rate, we will create the boxplot as shown below.\n\n\nShow the code\n# Create a factor with the education levels in the desired order\nedu_levels <- c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")\ncombined_table$educationLevel <- factor(combined_table$educationLevel, levels = edu_levels)\n\n# Create a box plot with separate panels for individuals with and without kids\np_fh_kids <- ggplot(combined_table, aes(x = educationLevel, y = Financial_health, fill = haveKids)) +\n  geom_boxplot() +\n  stat_summary(aes(group = haveKids, color = haveKids), fun = mean, geom = \"line\", size = 0.5) + # add mean lines\n  stat_boxplot(geom='errorbar', width=0.1, coef=1.5, size=0.5) + # add error bars\n  scale_fill_manual(name = \"haveKids\", values = c(\"FALSE\" = \"grey\", \"TRUE\" = \"orange\")) +\n  labs(title = \"Boxplot of Financial Health and Education by Kids\", x = \"Education\", y = \"Financial Health\") +\n  facet_wrap(~haveKids, ncol = 2) +\n  theme_bw() +\n  theme(plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)) \n\n# Display the plot\nggplotly(p_fh_kids)\n\n\n\n\n\n\nWe observe here that education is positively correlated to wage and financial health of the citizens. The higher the education level, the higher the financial health. Also, we can see that citizen with kids tend to have better financial health overall. Thus, showing that good education is necessary for higher wage.\nTo further confirm that wage is affected by education level, we will test the following null hypothesis:\nH0: the mean wage across different education levels are the same\nH1: the mean wage across different education levels are different\nAs based on previous normality assumption test done for wage, we know that wage is not normally distributed. Thus, to test the null hypothesis, we will perform the non-parametric test, Oneway ANOVA Test.\n\n\nShow the code\nggbetweenstats(\n  data = combined_table,\n  x = educationLevel, \n  y = Wage,\n  type = \"np\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"ns\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE,\n  ylim = c(0, 25000),\n  breaks = seq(0, 25000, 5000)\n) +\nggtitle(\"Oneway ANNOVA - Income across different educationLevel\")\n\n\n\n\n\nSince the p-value < critical value of 0.05, there is statistical evidence to reject the null hypothesis. We can thus conclude that education indeed does affect one’s wage and overall the median wage is higher for higher education level, which is consistent with our findings earlier."
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#observation-on-joviality",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#observation-on-joviality",
    "title": "Take-Home_Ex01",
    "section": "4.2 Observation on Joviality",
    "text": "4.2 Observation on Joviality\nTo find out the factors that could possibly affect joviality, we plot the below correlogram. However, looking at the plot below, we can see that none of the factors have correlation more than 0.5. Joviality has a negative correlation relationship with wage, expense, and savings.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c(\"joviality\", \"Wage\", \"Financial_health\", \"Cost_of_living\", \"age\", \"householdSize\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Joviality Correlation Table\")\n\n\n\n\n\n\n4.2.1 Joviality is affected by Financial health\nEven though correlation between joviality is weak (-0.35), we can observe the smooth red curve is relatively different across different income levels. It appears joviality has a strong correlation for lower income levels as compaeed to the rich. when broken down in health levels, it appears that joviality has the lowest correlation for middle income, the R2= 0.006.\nHowever, we also observed that there are poor people who have the highest joviality of 0.90 whereas for the income earners (in red), all of them have a joviality score below 0.64. Thus, we can conclude that being rich does not necessarily make citizens happy.\n\n\nShow the code\n# Create the plot\np_j <- ggplot(combined_table, aes(x = Financial_health, y = joviality, color = Wage)) +\n  geom_point() + # Scatter plot\n  geom_smooth(method = \"loess\", se = FALSE, colour = \"red\") + # Add smoother\n  scale_y_continuous(limits = c(0, 1)) + # Set Y-axis limits to 0-1\n  scale_color_gradient(low = \"blue\", high = \"red\") # Set color scale from blue to red\n\nggplotly(p_j)\n\n\n\n\n\n\n\n\nShow the code\nlibrary(ggpmisc)\n# Compute the 25th and 75th percentiles of Financial_health\nq <- quantile(combined_table$Financial_health, probs = c(0.25, 0.75))\n\n# Create a new column \"income_level\" based on Financial_health percentiles\ncombined_table$income_level <- ifelse(combined_table$Financial_health < q[1], \"Low\",\n                                      ifelse(combined_table$Financial_health > q[2], \"High\", \"Middle\"))\n\n# Specify the order of the income levels\ncombined_table$income_level <- factor(combined_table$income_level,\n                                      levels = c(\"Low\", \"Middle\", \"High\"))\n\n# Create the plot with facets and regression line equation\nggplot(combined_table, aes(x = Financial_health, y = joviality)) +\n  geom_point() + # Scatter plot\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"red\") + # Add smoother\n  scale_y_continuous(limits = c(0, 1)) + # Set Y-axis limits to 0-1\n  facet_wrap(~ income_level) + # Create facets by income level\n  stat_poly_eq(formula = y ~ x, aes(label = paste(\"R^2 = \", round(..r.squared.., 3))),\n               parse = TRUE, label.x = \"right\", label.y = 0.9, \n               eq.with.lhs = FALSE, size = 3) + # Show R-squared only, adjust label position and decrease font size\n  theme(plot.margin = unit(c(1, 1, 1, 5), \"lines\")) # Adjust right margin to make room for equation\n\n\n\n\n\n\n\n4.2.2 Joviality is affected by Cost of Living\nTo test the significance of correlation between joviality and cost of living, the following code chunk is used, and we notice that the slight positive correlation for 0.45.\n\n\nShow the code\nggscatterstats(\n  data = combined_table,\n  x = Cost_of_living,\n  y = joviality,\n  marginal = FALSE,\n  )\n\n\n\n\n\n\nJoviality vs expense_category\nWe can see that food expenses has the highest correlation at 0.49. Thus, the city planners and managers can consider allocating a portion of the grant to food expenses.\n\n\nShow the code\n# Select columns by name for the correlation matrix\ncols <- c(\"joviality\", \"Food\", \"Education\", \"Shelter\", \"Recreation\")\n\n# Plot the ggcorrmat\nggstatsplot::ggcorrmat(\n  data = combined_table, \n  cor.vars = cols, hc.order = TRUE, p.mat=p.mat,\n  title = \"Joviality Correlation Table\")\n\n\n\n\n\n\n\nShow the code\n# Select only the columns of interest from combined_table\ndata_reg <- select(combined_table, Shelter, Food, Education, Recreation, joviality)\n\ndata_reg <- data_reg %>%\n  mutate_at(vars(Shelter, Food, Education, Recreation), abs)\n\n# Melt data into long format\ndata_reg <- reshape2::melt(data_reg, id.vars = \"joviality\")\n\n#Create plot with multiple regression lines\n\nggplot(data_reg, aes(x = value, y = joviality, color = variable)) +\n  geom_point(size = 0.25) +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = FALSE, aes(group = variable)) +\n  xlab(\"Expenses_type\") +\n  ylab(\"Joviality\")"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#observation-on-interest-groups",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#observation-on-interest-groups",
    "title": "Take-Home_Ex01",
    "section": "4.3 Observation on Interest Groups",
    "text": "4.3 Observation on Interest Groups\nWe can plot the histogram below to observe the distribution of the different interest interest group. As seen from below, there is roughly the same proportion of participants in each group.\n\n\nShow the code\ncombined_table_grp <- combined_table %>% \n  group_by(participantId) %>%\n  summarise(interestGroup = first(interestGroup), age_bin = first(age_bin)) # assuming interestGroup and age_bin are constant for each participantID\n\nggplot(data = combined_table_grp, aes(x = interestGroup)) + \n  stat_count(color=\"black\", fill=\"azure4\") + \n  labs(x = \"Interest Groups\", y = \"Number of participants\") +\n  ggtitle(\"Distribution of interest groups\") +\n  geom_text(stat = \"count\", aes(label=..count..), vjust=-0.5) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\nFurthermore, we can use the heatmap to have overall glimpse of the interest groups by age_bin to see if it affects the type of interest participants are in.\nFrom the heatmap below, we can see that there is a high proportion of age_bin [30,40) that are in Interest Group H.\n\n\nShow the code\n#Group the data by interest group and age bin, and count the number of participants\n\ndf_heatmap <- combined_table_grp %>% \n  group_by(interestGroup, age_bin) %>% \n  summarize(n = n()) %>% \n  ungroup()\n\n# Create a heatmap\nggplot(data = df_heatmap, aes(x = interestGroup, y = age_bin, fill = n)) +\n  geom_tile() +\n  scale_fill_gradientn(colors = c(\"lightblue\", \"red\"), na.value = \"white\") +\n  labs(x = \"Interest Group\", y = \"Age Bin\", fill = \"Number of Participants\") +\n  ggtitle(\"Heatmap of Participants by Interest Group and Age\") +\n  theme(plot.title = element_text(hjust = 0.5))"
  },
  {
    "objectID": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#visualizing-uncertainty",
    "href": "Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.knit.html#visualizing-uncertainty",
    "title": "Take-Home_Ex01",
    "section": "4.4 Visualizing uncertainty",
    "text": "4.4 Visualizing uncertainty\n\n4.4.1 Visualizing uncertainty of point estimates\nIt can be tempting to interpret point estimates like median as the true precise representation of the true data value. However, it should be noted that there are uncertainties surrounding these point estimates. Thus we want to show the target quantile confidence levels (95% or 99%) that the true (unknown) estimate would like within the interval, given evidence provided by observed data.\nAs can been seen from the age_bin plot below, some age_bin have higher uncertainties such as age_bin [20,30) and [50,60]. This could be due to the presence of large no of outliers, and probably at the stage of the deciding their career path. On the other hand, age_bin such as [18,20) has less uncertainties,which may indicate lower presence of outliers.\nLikewise, for the educationLevel plot below, low level education has less uncertainties, while the higher educationLevel, the higher the uncertainties get.\n\nAge_bineducationLevel\n\n\n\n\nShow the code\n#Base ggplot\nggplot(data = combined_table,\n  aes(x = age_bin,\n      y = Wage)) +\n\n#Using stat_pointinterval to plot the points and intervals\n  stat_pointinterval(\n    aes(interval_color = stat(level)),\n    .width = c(0.95, 0.99),\n    .point = median,\n    .interval = qi,\n    point_color = \"darkred\",\n    show.legend = FALSE) +\n\n#Defining the color of the intervals\n  scale_color_manual(\n    values = c(\"blue2\", \"darkblue\"),\n    aesthetics = \"interval_color\") +\n\n#Title, subtitle, and caption\n  labs(title = 'Visualising uncertainty in median estimates of wage by age_bin',\n  subtitle = 'Quantiles intervals (95% and 99%) of wage by age_bin',\n  x = \"age_bin\",\n  y = \"Wage\") +\n\n  theme_hc() +\n\n  theme(plot.title = element_text(face = \"bold\", size = 18),\n        plot.subtitle = element_text(size = 14),\n        axis.text.x = element_text(angle = 30, hjust = 1))\n\n\n\n\n\n\n\n\n\nShow the code\n#Base ggplot\nggplot(\n  data = combined_table,\n  aes(x = educationLevel,\n      y = Wage)) +\n\n#Using stat_pointinterval to plot the points and intervals\n  stat_pointinterval(\n    aes(interval_color = stat(level)),\n    .width = c(0.95, 0.99),\n    .point = median,\n    .interval = qi,\n    point_color = \"darkred\",\n    show.legend = FALSE) +\n\n#Defining the color of the intervals\n  scale_color_manual(\n    values = c(\"blue2\", \"darkblue\"),\n    aesthetics = \"interval_color\") +\n\n#Title, subtitle, and caption\n  labs(title = 'Visualising uncertainty in median estimates of wage by educationLevel',\n  subtitle = 'Quantiles intervals (95% and 99%) of wage by educationLevel',\n  x = \"educationLevel\",\n  y = \"Wage\") +\n\n  theme_hc() +\n\n  theme(plot.title = element_text(face = \"bold\", size = 18),\n        plot.subtitle = element_text(size = 14),\n        axis.text.x = element_text(angle = 30, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n4.4.2 Visualizing Uncertainty with Hypothetical Outcome Plots (HOPs)\nHPOs can help to illustrate the uncertainty and variability of the data and model predictions, and highlight the potential impact of different variables or factors on the outcomes of interest.\n\nAge_bineducationLevel\n\n\n\n\nShow the code\nlibrary(ungeviz)\n\nggplot(data = combined_table,\n        (aes(x = factor(age_bin), y = Wage))) +\n   geom_point(position = position_jitter(\n     width = 0.05, height = 0.3),\n     size = 0.4, color = \"#0072B2\", alpha = 1/2) +\n   geom_hpline(data = sampler(25, group = age_bin), height = 0.6, color = \"#D55E00\") +\n   theme_bw() +\n  transition_states(.draw, 1, 3)\n\n\n\n\n\n\n\n\n\nShow the code\nggplot(data = combined_table,\n        aes(x = factor(educationLevel), y = Wage)) +\n   geom_point(position = position_jitter(\n     width = 0.05, height = 0.3),\n     size = 0.4, color = \"#0072B2\", alpha = 1/2) +\n   geom_hpline(data = sampler(25, group = educationLevel), height = 0.6, color = \"#D55E00\") +\n   theme_bw() +\n   transition_states(.draw, 1, 3)"
  }
]